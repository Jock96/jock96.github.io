/*! For license information please see main.a2a8ecf5.js.LICENSE.txt */
(()=>{var e={463:(e,t,n)=>{"use strict";var r=n(791),i=n(296);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},h={};function p(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function C(e,t,n,r){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!u.call(h,e)||!u.call(f,e)&&(g.test(e)?h[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);m[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),E=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),R=Symbol.for("react.provider"),L=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var N=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var k=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=k&&e[k]||e["@@iterator"])?e:null}var x,F=Object.assign;function j(e){if(void 0===x)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);x=t&&t[1]||""}return"\n"+x+e}var V=!1;function U(e,t){if(!e||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=s);break}}}finally{V=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function G(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case b:return"Fragment";case E:return"Portal";case w:return"Profiler";case M:return"StrictMode";case I:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case L:return(e.displayName||"Context")+".Consumer";case R:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return z(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===M?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function B(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&C(e,"checked",t,!1)}function Z(e,t){Y(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function X(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function ae(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function ge(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function pe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=pe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function Ce(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,be=null,Me=null;function we(e){if(e=Ci(e)){if("function"!==typeof Ee)throw Error(a(280));var t=e.stateNode;t&&(t=Si(t),Ee(e.stateNode,e.type,t))}}function Re(e){be?Me?Me.push(e):Me=[e]:be=e}function Le(){if(be){var e=be,t=Me;if(Me=be=null,we(e),t)for(e=0;e<t.length;e++)we(t[e])}}function Te(e,t){return e(t)}function Ie(){}var Pe=!1;function Oe(e,t,n){if(Pe)return e(t,n);Pe=!0;try{return Te(e,t,n)}finally{Pe=!1,(null!==be||null!==Me)&&(Ie(),Le())}}function Ae(e,t){var n=e.stateNode;if(null===n)return null;var r=Si(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Ne=!1;if(d)try{var ke={};Object.defineProperty(ke,"passive",{get:function(){Ne=!0}}),window.addEventListener("test",ke,ke),window.removeEventListener("test",ke,ke)}catch(de){Ne=!1}function De(e,t,n,r,i,a,o,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var xe=!1,Fe=null,je=!1,Ve=null,Ue={onError:function(e){xe=!0,Fe=e}};function Ge(e,t,n,r,i,a,o,s,l){xe=!1,Fe=null,De.apply(Ue,arguments)}function ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(ze(e)!==e)throw Error(a(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return qe(i),e;if(o===r)return qe(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?Be(e):null}function Be(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Be(e);if(null!==t)return t;e=e.sibling}return null}var Qe=i.unstable_scheduleCallback,Ke=i.unstable_cancelCallback,Je=i.unstable_shouldYield,$e=i.unstable_requestPaint,Ye=i.unstable_now,Ze=i.unstable_getCurrentPriorityLevel,Xe=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function gt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~i;0!==s?r=ut(s):0!==(a&=o)&&(r=ut(a))}else 0!==(o=n&~i)?r=ut(o):0!==a&&(r=ut(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Ct=0;function _t(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var St,Et,bt,Mt,wt,Rt=!1,Lt=[],Tt=null,It=null,Pt=null,Ot=new Map,At=new Map,Nt=[],kt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":At.delete(t.pointerId)}}function xt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=Ci(t))&&Et(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=yi(e.target);if(null!==t){var n=ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void wt(e.priority,(function(){bt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=Ci(n))&&Et(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);_e=r,n.target.dispatchEvent(r),_e=null,t.shift()}return!0}function Vt(e,t,n){jt(e)&&n.delete(t)}function Ut(){Rt=!1,null!==Tt&&jt(Tt)&&(Tt=null),null!==It&&jt(It)&&(It=null),null!==Pt&&jt(Pt)&&(Pt=null),Ot.forEach(Vt),At.forEach(Vt)}function Gt(e,t){e.blockedOn===t&&(e.blockedOn=null,Rt||(Rt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function zt(e){function t(t){return Gt(t,e)}if(0<Lt.length){Gt(Lt[0],e);for(var n=1;n<Lt.length;n++){var r=Lt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&Gt(Tt,e),null!==It&&Gt(It,e),null!==Pt&&Gt(Pt,e),Ot.forEach(t),At.forEach(t),n=0;n<Nt.length;n++)(r=Nt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Nt.length&&null===(n=Nt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Nt.shift()}var Ht=_.ReactCurrentBatchConfig,qt=!0;function Wt(e,t,n,r){var i=Ct,a=Ht.transition;Ht.transition=null;try{Ct=1,Qt(e,t,n,r)}finally{Ct=i,Ht.transition=a}}function Bt(e,t,n,r){var i=Ct,a=Ht.transition;Ht.transition=null;try{Ct=4,Qt(e,t,n,r)}finally{Ct=i,Ht.transition=a}}function Qt(e,t,n,r){if(qt){var i=Jt(e,t,n,r);if(null===i)qr(e,t,r,Kt,n),Dt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Tt=xt(Tt,e,t,n,r,i),!0;case"dragenter":return It=xt(It,e,t,n,r,i),!0;case"mouseover":return Pt=xt(Pt,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Ot.set(a,xt(Ot.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,At.set(a,xt(At.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Dt(e,r),4&t&&-1<kt.indexOf(e)){for(;null!==i;){var a=Ci(i);if(null!==a&&St(a),null===(a=Jt(e,t,n,r))&&qr(e,t,r,Kt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Kt=null;function Jt(e,t,n,r){if(Kt=null,null!==(e=yi(e=Se(r))))if(null===(t=ze(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Xe:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Yt=null,Zt=null,Xt=null;function en(){if(Xt)return Xt;var e,t,n=Zt,r=n.length,i="value"in Yt?Yt.value:Yt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return Xt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=an(cn),un=F({},cn,{view:0,detail:0}),gn=an(un),fn=F({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),hn=an(fn),pn=an(F({},fn,{dataTransfer:0})),mn=an(F({},un,{relatedTarget:0})),vn=an(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Cn=an(yn),_n=an(F({},cn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=bn[e])&&!!t[e]}function wn(){return Mn}var Rn=F({},un,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ln=an(Rn),Tn=an(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=an(F({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wn})),Pn=an(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),On=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),An=an(On),Nn=[9,13,27,32],kn=d&&"CompositionEvent"in window,Dn=null;d&&"documentMode"in document&&(Dn=document.documentMode);var xn=d&&"TextEvent"in window&&!Dn,Fn=d&&(!kn||Dn&&8<Dn&&11>=Dn),jn=String.fromCharCode(32),Vn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Nn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Wn(e,t,n,r){Re(r),0<(t=Br(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Bn=null,Qn=null;function Kn(e){jr(e,0)}function Jn(e){if(Q(_i(e)))return e}function $n(e,t){if("change"===e)return t}var Yn=!1;if(d){var Zn;if(d){var Xn="oninput"in document;if(!Xn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Xn="function"===typeof er.oninput}Zn=Xn}else Zn=!1;Yn=Zn&&(!document.documentMode||9<document.documentMode)}function tr(){Bn&&(Bn.detachEvent("onpropertychange",nr),Qn=Bn=null)}function nr(e){if("value"===e.propertyName&&Jn(Qn)){var t=[];Wn(t,Qn,e,Se(e)),Oe(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Qn=n,(Bn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Qn)}function ar(e,t){if("click"===e)return Jn(t)}function or(e,t){if("input"===e||"change"===e)return Jn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!u.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function gr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hr(e){var t=gr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=dr(n,a);var o=dr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pr=d&&"documentMode"in document&&11>=document.documentMode,mr=null,vr=null,yr=null,Cr=!1;function _r(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Cr||null==mr||mr!==K(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Br(vr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function Sr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Er={animationend:Sr("Animation","AnimationEnd"),animationiteration:Sr("Animation","AnimationIteration"),animationstart:Sr("Animation","AnimationStart"),transitionend:Sr("Transition","TransitionEnd")},br={},Mr={};function wr(e){if(br[e])return br[e];if(!Er[e])return e;var t,n=Er[e];for(t in n)if(n.hasOwnProperty(t)&&t in Mr)return br[e]=n[t];return e}d&&(Mr=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);var Rr=wr("animationend"),Lr=wr("animationiteration"),Tr=wr("animationstart"),Ir=wr("transitionend"),Pr=new Map,Or="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ar(e,t){Pr.set(e,t),l(t,[e])}for(var Nr=0;Nr<Or.length;Nr++){var kr=Or[Nr];Ar(kr.toLowerCase(),"on"+(kr[0].toUpperCase()+kr.slice(1)))}Ar(Rr,"onAnimationEnd"),Ar(Lr,"onAnimationIteration"),Ar(Tr,"onAnimationStart"),Ar("dblclick","onDoubleClick"),Ar("focusin","onFocus"),Ar("focusout","onBlur"),Ar(Ir,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,s,l,c){if(Ge.apply(this,arguments),xe){if(!xe)throw Error(a(198));var d=Fe;xe=!1,Fe=null,je||(je=!0,Ve=d)}}(r,t,void 0,e),e.currentTarget=null}function jr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&i.isPropagationStopped())break e;Fr(i,s,c),a=l}else for(o=0;o<r.length;o++){if(l=(s=r[o]).instance,c=s.currentTarget,s=s.listener,l!==a&&i.isPropagationStopped())break e;Fr(i,s,c),a=l}}}if(je)throw e=Ve,je=!1,Ve=null,e}function Vr(e,t){var n=t[pi];void 0===n&&(n=t[pi]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var Gr="_reactListening"+Math.random().toString(36).slice(2);function zr(e){if(!e[Gr]){e[Gr]=!0,o.forEach((function(t){"selectionchange"!==t&&(xr.has(t)||Ur(t,!1,e),Ur(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Gr]||(t[Gr]=!0,Ur("selectionchange",!1,t))}}function Hr(e,t,n,r){switch($t(t)){case 1:var i=Wt;break;case 4:i=Bt;break;default:i=Qt}n=i.bind(null,t,n,e),i=void 0,!Ne||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=yi(s)))return;if(5===(l=o.tag)||6===l){r=a=o;continue e}s=s.parentNode}}r=r.return}Oe((function(){var r=a,i=Se(n),o=[];e:{var s=Pr.get(e);if(void 0!==s){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Ln;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case Rr:case Lr:case Tr:l=vn;break;case Ir:l=Pn;break;case"scroll":l=gn;break;case"wheel":l=An;break;case"copy":case"cut":case"paste":l=Cn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var d=0!==(4&t),u=!d&&"scroll"===e,g=d?null!==s?s+"Capture":null:s;d=[];for(var f,h=r;null!==h;){var p=(f=h).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==g&&(null!=(p=Ae(h,g))&&d.push(Wr(h,p,f)))),u)break;h=h.return}0<d.length&&(s=new l(s,c,null,n,i),o.push({event:s,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===_e||!(c=n.relatedTarget||n.fromElement)||!yi(c)&&!c[hi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?yi(c):null)&&(c!==(u=ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(d=hn,p="onMouseLeave",g="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(d=Tn,p="onPointerLeave",g="onPointerEnter",h="pointer"),u=null==l?s:_i(l),f=null==c?s:_i(c),(s=new d(p,h+"leave",l,n,i)).target=u,s.relatedTarget=f,p=null,yi(i)===r&&((d=new d(g,h+"enter",c,n,i)).target=f,d.relatedTarget=u,p=d),u=p,l&&c)e:{for(g=c,h=0,f=d=l;f;f=Qr(f))h++;for(f=0,p=g;p;p=Qr(p))f++;for(;0<h-f;)d=Qr(d),h--;for(;0<f-h;)g=Qr(g),f--;for(;h--;){if(d===g||null!==g&&d===g.alternate)break e;d=Qr(d),g=Qr(g)}d=null}else d=null;null!==l&&Kr(o,s,l,d,!1),null!==c&&null!==u&&Kr(o,u,c,d,!0)}if("select"===(l=(s=r?_i(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var m=$n;else if(qn(s))if(Yn)m=or;else{m=ir;var v=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ar);switch(m&&(m=m(e,r))?Wn(o,m,n,i):(v&&v(e,s,r),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=r?_i(r):window,e){case"focusin":(qn(v)||"true"===v.contentEditable)&&(mr=v,vr=r,yr=null);break;case"focusout":yr=vr=mr=null;break;case"mousedown":Cr=!0;break;case"contextmenu":case"mouseup":case"dragend":Cr=!1,_r(o,n,i);break;case"selectionchange":if(pr)break;case"keydown":case"keyup":_r(o,n,i)}var y;if(kn)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else zn?Un(e,n)&&(C="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(C="onCompositionStart");C&&(Fn&&"ko"!==n.locale&&(zn||"onCompositionStart"!==C?"onCompositionEnd"===C&&zn&&(y=en()):(Zt="value"in(Yt=i)?Yt.value:Yt.textContent,zn=!0)),0<(v=Br(r,C)).length&&(C=new _n(C,e,null,n,i),o.push({event:C,listeners:v}),y?C.data=y:null!==(y=Gn(n))&&(C.data=y))),(y=xn?function(e,t){switch(e){case"compositionend":return Gn(t);case"keypress":return 32!==t.which?null:(Vn=!0,jn);case"textInput":return(e=t.data)===jn&&Vn?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!kn&&Un(e,t)?(e=en(),Xt=Zt=Yt=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Br(r,"onBeforeInput")).length&&(i=new _n("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=y))}jr(o,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Br(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Ae(e,n))&&r.unshift(Wr(e,a,i)),null!=(a=Ae(e,t))&&r.push(Wr(e,a,i))),e=e.return}return r}function Qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,i?null!=(l=Ae(n,a))&&o.unshift(Wr(n,l,s)):i||null!=(l=Ae(n,a))&&o.push(Wr(n,l,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Jr=/\r\n?/g,$r=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace(Jr,"\n").replace($r,"")}function Zr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(a(425))}function Xr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void zt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);zt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function di(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ui=Math.random().toString(36).slice(2),gi="__reactFiber$"+ui,fi="__reactProps$"+ui,hi="__reactContainer$"+ui,pi="__reactEvents$"+ui,mi="__reactListeners$"+ui,vi="__reactHandles$"+ui;function yi(e){var t=e[gi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[hi]||n[gi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=di(e);null!==e;){if(n=e[gi])return n;e=di(e)}return t}n=(e=n).parentNode}return null}function Ci(e){return!(e=e[gi]||e[hi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _i(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function Si(e){return e[fi]||null}var Ei=[],bi=-1;function Mi(e){return{current:e}}function wi(e){0>bi||(e.current=Ei[bi],Ei[bi]=null,bi--)}function Ri(e,t){bi++,Ei[bi]=e.current,e.current=t}var Li={},Ti=Mi(Li),Ii=Mi(!1),Pi=Li;function Oi(e,t){var n=e.type.contextTypes;if(!n)return Li;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ai(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ni(){wi(Ii),wi(Ti)}function ki(e,t,n){if(Ti.current!==Li)throw Error(a(168));Ri(Ti,t),Ri(Ii,n)}function Di(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,H(e)||"Unknown",i));return F({},n,r)}function xi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Li,Pi=Ti.current,Ri(Ti,e),Ri(Ii,Ii.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Di(e,t,Pi),r.__reactInternalMemoizedMergedChildContext=e,wi(Ii),wi(Ti),Ri(Ti,e)):wi(Ii),Ri(Ii,n)}var ji=null,Vi=!1,Ui=!1;function Gi(e){null===ji?ji=[e]:ji.push(e)}function zi(){if(!Ui&&null!==ji){Ui=!0;var e=0,t=Ct;try{var n=ji;for(Ct=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}ji=null,Vi=!1}catch(i){throw null!==ji&&(ji=ji.slice(e+1)),Qe(Xe,zi),i}finally{Ct=t,Ui=!1}}return null}var Hi=[],qi=0,Wi=null,Bi=0,Qi=[],Ki=0,Ji=null,$i=1,Yi="";function Zi(e,t){Hi[qi++]=Bi,Hi[qi++]=Wi,Wi=e,Bi=t}function Xi(e,t,n){Qi[Ki++]=$i,Qi[Ki++]=Yi,Qi[Ki++]=Ji,Ji=e;var r=$i;e=Yi;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var a=32-ot(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,$i=1<<32-ot(t)+i|n<<i|r,Yi=a+e}else $i=1<<a|n<<i|r,Yi=e}function ea(e){null!==e.return&&(Zi(e,1),Xi(e,1,0))}function ta(e){for(;e===Wi;)Wi=Hi[--qi],Hi[qi]=null,Bi=Hi[--qi],Hi[qi]=null;for(;e===Ji;)Ji=Qi[--Ki],Qi[Ki]=null,Yi=Qi[--Ki],Qi[Ki]=null,$i=Qi[--Ki],Qi[Ki]=null}var na=null,ra=null,ia=!1,aa=null;function oa(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function sa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ji?{id:$i,overflow:Yi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ia){var t=ra;if(t){var n=t;if(!sa(e,t)){if(la(e))throw Error(a(418));t=ci(n.nextSibling);var r=na;t&&sa(e,t)?oa(r,n):(e.flags=-4097&e.flags|2,ia=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,na=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ua(e){if(e!==na)return!1;if(!ia)return da(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ra)){if(la(e))throw ga(),Error(a(418));for(;t;)oa(e,t),t=ci(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?ci(e.stateNode.nextSibling):null;return!0}function ga(){for(var e=ra;e;)e=ci(e.nextSibling)}function fa(){ra=na=null,ia=!1}function ha(e){null===aa?aa=[e]:aa.push(e)}var pa=_.ReactCurrentBatchConfig;function ma(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var va=Mi(null),ya=null,Ca=null,_a=null;function Sa(){_a=Ca=ya=null}function Ea(e){var t=va.current;wi(va),e._currentValue=t}function ba(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ma(e,t){ya=e,_a=Ca=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_s=!0),e.firstContext=null)}function wa(e){var t=e._currentValue;if(_a!==e)if(e={context:e,memoizedValue:t,next:null},null===Ca){if(null===ya)throw Error(a(308));Ca=e,ya.dependencies={lanes:0,firstContext:e}}else Ca=Ca.next=e;return t}var Ra=null;function La(e){null===Ra?Ra=[e]:Ra.push(e)}function Ta(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,La(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ia(e,r)}function Ia(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Pa=!1;function Oa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Aa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Na(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ka(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Il)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ia(e,n)}return null===(i=r.interleaved)?(t.next=t,La(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ia(e,n)}function Da(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function xa(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fa(e,t,n,r){var i=e.updateQueue;Pa=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?a=c:o.next=c,o=l;var d=e.alternate;null!==d&&((s=(d=d.updateQueue).lastBaseUpdate)!==o&&(null===s?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(null!==a){var u=i.baseState;for(o=0,d=c=l=null,s=a;;){var g=s.lane,f=s.eventTime;if((r&g)===g){null!==d&&(d=d.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=e,p=s;switch(g=t,f=n,p.tag){case 1:if("function"===typeof(h=p.payload)){u=h.call(f,u,g);break e}u=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(g="function"===typeof(h=p.payload)?h.call(f,u,g):h)||void 0===g)break e;u=F({},u,g);break e;case 2:Pa=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(g=i.effects)?i.effects=[s]:g.push(s))}else f={eventTime:f,lane:g,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(c=d=f,l=u):d=d.next=f,o|=g;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(g=s).next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}if(null===d&&(l=u),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Fl|=o,e.lanes=o,e.memoizedState=u}}function ja(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var Va=(new r.Component).refs;function Ua(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Ga={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),a=Na(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=ka(e,a,i))&&(rc(t,e,i,r),Da(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),a=Na(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=ka(e,a,i))&&(rc(t,e,i,r),Da(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),i=Na(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=ka(e,i,r))&&(rc(t,e,r,n),Da(t,e,r))}};function za(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,a))}function Ha(e,t,n){var r=!1,i=Li,a=t.contextType;return"object"===typeof a&&null!==a?a=wa(a):(i=Ai(t)?Pi:Ti.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Oi(e,i):Li),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ga,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function qa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ga.enqueueReplaceState(t,t.state,null)}function Wa(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Va,Oa(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=wa(a):(a=Ai(t)?Pi:Ti.current,i.context=Oi(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(Ua(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Ga.enqueueReplaceState(i,i.state,null),Fa(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Ba(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;t===Va&&(t=i.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Qa(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ka(e){return(0,e._init)(e._payload)}function Ja(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=kc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=jc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===b?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===A&&Ka(a)===t.type)?((r=i(t,n.props)).ref=Ba(e,t,n),r.return=e,r):((r=Dc(n.type,n.key,n.props,null,e.mode,r)).ref=Ba(e,t,n),r.return=e,r)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Vc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function u(e,t,n,r,a){return null===t||7!==t.tag?((t=xc(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function g(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=jc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case S:return(n=Dc(t.type,t.key,t.props,null,e.mode,n)).ref=Ba(e,null,t),n.return=e,n;case E:return(t=Vc(t,e.mode,n)).return=e,t;case A:return g(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=xc(t,e.mode,n,null)).return=e,t;Qa(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case S:return n.key===i?c(e,t,n,r):null;case E:return n.key===i?d(e,t,n,r):null;case A:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||D(n))return null!==i?null:u(e,t,n,r,null);Qa(e,n)}return null}function h(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case S:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case E:return d(t,e=e.get(null===r.key?n:r.key)||null,r,i);case A:return h(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||D(r))return u(t,e=e.get(n)||null,r,i,null);Qa(t,r)}return null}function p(i,a,s,l){for(var c=null,d=null,u=a,p=a=0,m=null;null!==u&&p<s.length;p++){u.index>p?(m=u,u=null):m=u.sibling;var v=f(i,u,s[p],l);if(null===v){null===u&&(u=m);break}e&&u&&null===v.alternate&&t(i,u),a=o(v,a,p),null===d?c=v:d.sibling=v,d=v,u=m}if(p===s.length)return n(i,u),ia&&Zi(i,p),c;if(null===u){for(;p<s.length;p++)null!==(u=g(i,s[p],l))&&(a=o(u,a,p),null===d?c=u:d.sibling=u,d=u);return ia&&Zi(i,p),c}for(u=r(i,u);p<s.length;p++)null!==(m=h(u,i,p,s[p],l))&&(e&&null!==m.alternate&&u.delete(null===m.key?p:m.key),a=o(m,a,p),null===d?c=m:d.sibling=m,d=m);return e&&u.forEach((function(e){return t(i,e)})),ia&&Zi(i,p),c}function m(i,s,l,c){var d=D(l);if("function"!==typeof d)throw Error(a(150));if(null==(l=d.call(l)))throw Error(a(151));for(var u=d=null,p=s,m=s=0,v=null,y=l.next();null!==p&&!y.done;m++,y=l.next()){p.index>m?(v=p,p=null):v=p.sibling;var C=f(i,p,y.value,c);if(null===C){null===p&&(p=v);break}e&&p&&null===C.alternate&&t(i,p),s=o(C,s,m),null===u?d=C:u.sibling=C,u=C,p=v}if(y.done)return n(i,p),ia&&Zi(i,m),d;if(null===p){for(;!y.done;m++,y=l.next())null!==(y=g(i,y.value,c))&&(s=o(y,s,m),null===u?d=y:u.sibling=y,u=y);return ia&&Zi(i,m),d}for(p=r(i,p);!y.done;m++,y=l.next())null!==(y=h(p,i,m,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?m:y.key),s=o(y,s,m),null===u?d=y:u.sibling=y,u=y);return e&&p.forEach((function(e){return t(i,e)})),ia&&Zi(i,m),d}return function e(r,a,o,l){if("object"===typeof o&&null!==o&&o.type===b&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case S:e:{for(var c=o.key,d=a;null!==d;){if(d.key===c){if((c=o.type)===b){if(7===d.tag){n(r,d.sibling),(a=i(d,o.props.children)).return=r,r=a;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===A&&Ka(c)===d.type){n(r,d.sibling),(a=i(d,o.props)).ref=Ba(r,d,o),a.return=r,r=a;break e}n(r,d);break}t(r,d),d=d.sibling}o.type===b?((a=xc(o.props.children,r.mode,l,o.key)).return=r,r=a):((l=Dc(o.type,o.key,o.props,null,r.mode,l)).ref=Ba(r,a,o),l.return=r,r=l)}return s(r);case E:e:{for(d=o.key;null!==a;){if(a.key===d){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(r,a.sibling),(a=i(a,o.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Vc(o,r.mode,l)).return=r,r=a}return s(r);case A:return e(r,a,(d=o._init)(o._payload),l)}if(te(o))return p(r,a,o,l);if(D(o))return m(r,a,o,l);Qa(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,o)).return=r,r=a):(n(r,a),(a=jc(o,r.mode,l)).return=r,r=a),s(r)):n(r,a)}}var $a=Ja(!0),Ya=Ja(!1),Za={},Xa=Mi(Za),eo=Mi(Za),to=Mi(Za);function no(e){if(e===Za)throw Error(a(174));return e}function ro(e,t){switch(Ri(to,t),Ri(eo,e),Ri(Xa,Za),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}wi(Xa),Ri(Xa,t)}function io(){wi(Xa),wi(eo),wi(to)}function ao(e){no(to.current);var t=no(Xa.current),n=le(t,e.type);t!==n&&(Ri(eo,e),Ri(Xa,n))}function oo(e){eo.current===e&&(wi(Xa),wi(eo))}var so=Mi(0);function lo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function uo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var go=_.ReactCurrentDispatcher,fo=_.ReactCurrentBatchConfig,ho=0,po=null,mo=null,vo=null,yo=!1,Co=!1,_o=0,So=0;function Eo(){throw Error(a(321))}function bo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function Mo(e,t,n,r,i,o){if(ho=o,po=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,go.current=null===e||null===e.memoizedState?ss:ls,e=n(r,i),Co){o=0;do{if(Co=!1,_o=0,25<=o)throw Error(a(301));o+=1,vo=mo=null,t.updateQueue=null,go.current=cs,e=n(r,i)}while(Co)}if(go.current=os,t=null!==mo&&null!==mo.next,ho=0,vo=mo=po=null,yo=!1,t)throw Error(a(300));return e}function wo(){var e=0!==_o;return _o=0,e}function Ro(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===vo?po.memoizedState=vo=e:vo=vo.next=e,vo}function Lo(){if(null===mo){var e=po.alternate;e=null!==e?e.memoizedState:null}else e=mo.next;var t=null===vo?po.memoizedState:vo.next;if(null!==t)vo=t,mo=e;else{if(null===e)throw Error(a(310));e={memoizedState:(mo=e).memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},null===vo?po.memoizedState=vo=e:vo=vo.next=e}return vo}function To(e,t){return"function"===typeof t?t(e):t}function Io(e){var t=Lo(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=mo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=s=null,c=null,d=o;do{var u=d.lane;if((ho&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var g={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=g,s=r):c=c.next=g,po.lanes|=u,Fl|=u}d=d.next}while(null!==d&&d!==o);null===c?s=r:c.next=l,sr(r,t.memoizedState)||(_s=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,po.lanes|=o,Fl|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Po(e){var t=Lo(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);sr(o,t.memoizedState)||(_s=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Oo(){}function Ao(e,t){var n=po,r=Lo(),i=t(),o=!sr(r.memoizedState,i);if(o&&(r.memoizedState=i,_s=!0),r=r.queue,qo(Do.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==vo&&1&vo.memoizedState.tag){if(n.flags|=2048,Vo(9,ko.bind(null,n,r,i,t),void 0,null),null===Pl)throw Error(a(349));0!==(30&ho)||No(n,t,i)}return i}function No(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=po.updateQueue)?(t={lastEffect:null,stores:null},po.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ko(e,t,n,r){t.value=n,t.getSnapshot=r,xo(t)&&Fo(e)}function Do(e,t,n){return n((function(){xo(t)&&Fo(e)}))}function xo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Fo(e){var t=Ia(e,1);null!==t&&rc(t,e,1,-1)}function jo(e){var t=Ro();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,po,e),[t.memoizedState,e]}function Vo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=po.updateQueue)?(t={lastEffect:null,stores:null},po.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Uo(){return Lo().memoizedState}function Go(e,t,n,r){var i=Ro();po.flags|=e,i.memoizedState=Vo(1|t,n,void 0,void 0===r?null:r)}function zo(e,t,n,r){var i=Lo();r=void 0===r?null:r;var a=void 0;if(null!==mo){var o=mo.memoizedState;if(a=o.destroy,null!==r&&bo(r,o.deps))return void(i.memoizedState=Vo(t,n,a,r))}po.flags|=e,i.memoizedState=Vo(1|t,n,a,r)}function Ho(e,t){return Go(8390656,8,e,t)}function qo(e,t){return zo(2048,8,e,t)}function Wo(e,t){return zo(4,2,e,t)}function Bo(e,t){return zo(4,4,e,t)}function Qo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ko(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,zo(4,4,Qo.bind(null,t,e),n)}function Jo(){}function $o(e,t){var n=Lo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&bo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Yo(e,t){var n=Lo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&bo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Zo(e,t,n){return 0===(21&ho)?(e.baseState&&(e.baseState=!1,_s=!0),e.memoizedState=n):(sr(n,t)||(n=pt(),po.lanes|=n,Fl|=n,e.baseState=!0),t)}function Xo(e,t){var n=Ct;Ct=0!==n&&4>n?n:4,e(!0);var r=fo.transition;fo.transition={};try{e(!1),t()}finally{Ct=n,fo.transition=r}}function es(){return Lo().memoizedState}function ts(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))is(t,n);else if(null!==(n=Ta(e,t,n,r))){rc(n,e,r,tc()),as(n,t,r)}}function ns(e,t,n){var r=nc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))is(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,o)){var l=t.interleaved;return null===l?(i.next=i,La(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Ta(e,t,i,r))&&(rc(n,e,r,i=tc()),as(n,t,r))}}function rs(e){var t=e.alternate;return e===po||null!==t&&t===po}function is(e,t){Co=yo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function as(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var os={readContext:wa,useCallback:Eo,useContext:Eo,useEffect:Eo,useImperativeHandle:Eo,useInsertionEffect:Eo,useLayoutEffect:Eo,useMemo:Eo,useReducer:Eo,useRef:Eo,useState:Eo,useDebugValue:Eo,useDeferredValue:Eo,useTransition:Eo,useMutableSource:Eo,useSyncExternalStore:Eo,useId:Eo,unstable_isNewReconciler:!1},ss={readContext:wa,useCallback:function(e,t){return Ro().memoizedState=[e,void 0===t?null:t],e},useContext:wa,useEffect:Ho,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Go(4194308,4,Qo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Go(4194308,4,e,t)},useInsertionEffect:function(e,t){return Go(4,2,e,t)},useMemo:function(e,t){var n=Ro();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ro();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,po,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ro().memoizedState=e},useState:jo,useDebugValue:Jo,useDeferredValue:function(e){return Ro().memoizedState=e},useTransition:function(){var e=jo(!1),t=e[0];return e=Xo.bind(null,e[1]),Ro().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=po,i=Ro();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Pl)throw Error(a(349));0!==(30&ho)||No(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Ho(Do.bind(null,r,o,e),[e]),r.flags|=2048,Vo(9,ko.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Ro(),t=Pl.identifierPrefix;if(ia){var n=Yi;t=":"+t+"R"+(n=($i&~(1<<32-ot($i)-1)).toString(32)+n),0<(n=_o++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=So++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ls={readContext:wa,useCallback:$o,useContext:wa,useEffect:qo,useImperativeHandle:Ko,useInsertionEffect:Wo,useLayoutEffect:Bo,useMemo:Yo,useReducer:Io,useRef:Uo,useState:function(){return Io(To)},useDebugValue:Jo,useDeferredValue:function(e){return Zo(Lo(),mo.memoizedState,e)},useTransition:function(){return[Io(To)[0],Lo().memoizedState]},useMutableSource:Oo,useSyncExternalStore:Ao,useId:es,unstable_isNewReconciler:!1},cs={readContext:wa,useCallback:$o,useContext:wa,useEffect:qo,useImperativeHandle:Ko,useInsertionEffect:Wo,useLayoutEffect:Bo,useMemo:Yo,useReducer:Po,useRef:Uo,useState:function(){return Po(To)},useDebugValue:Jo,useDeferredValue:function(e){var t=Lo();return null===mo?t.memoizedState=e:Zo(t,mo.memoizedState,e)},useTransition:function(){return[Po(To)[0],Lo().memoizedState]},useMutableSource:Oo,useSyncExternalStore:Ao,useId:es,unstable_isNewReconciler:!1};function ds(e,t){try{var n="",r=t;do{n+=G(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function gs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var fs="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,n){(n=Na(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,Bl=r),gs(0,t)},n}function ps(e,t,n){(n=Na(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){gs(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){gs(0,t),"function"!==typeof r&&(null===Ql?Ql=new Set([this]):Ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fs;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Rc.bind(null,e,t,n),t.then(e,e))}function vs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Na(-1,1)).tag=2,ka(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var Cs=_.ReactCurrentOwner,_s=!1;function Ss(e,t,n,r){t.child=null===e?Ya(t,null,n,r):$a(t,e.child,n,r)}function Es(e,t,n,r,i){n=n.render;var a=t.ref;return Ma(t,i),r=Mo(e,t,n,r,a,i),n=wo(),null===e||_s?(ia&&n&&ea(t),t.flags|=1,Ss(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ws(e,t,i))}function bs(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Nc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ms(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return Ws(e,t,i)}return t.flags|=1,(e=kc(a,r)).ref=t.ref,e.return=t,t.child=e}function Ms(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(lr(a,r)&&e.ref===t.ref){if(_s=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,Ws(e,t,i);0!==(131072&e.flags)&&(_s=!0)}}return Ls(e,t,n,r,i)}function ws(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ri(kl,Nl),Nl|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ri(kl,Nl),Nl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ri(kl,Nl),Nl|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ri(kl,Nl),Nl|=r;return Ss(e,t,i,n),t.child}function Rs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ls(e,t,n,r,i){var a=Ai(n)?Pi:Ti.current;return a=Oi(t,a),Ma(t,i),n=Mo(e,t,n,r,a,i),r=wo(),null===e||_s?(ia&&r&&ea(t),t.flags|=1,Ss(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ws(e,t,i))}function Ts(e,t,n,r,i){if(Ai(n)){var a=!0;xi(t)}else a=!1;if(Ma(t,i),null===t.stateNode)qs(e,t),Ha(t,n,r),Wa(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=wa(c):c=Oi(t,c=Ai(n)?Pi:Ti.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate;u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||l!==c)&&qa(t,o,r,c),Pa=!1;var g=t.memoizedState;o.state=g,Fa(t,r,o,i),l=t.memoizedState,s!==r||g!==l||Ii.current||Pa?("function"===typeof d&&(Ua(t,n,d,r),l=t.memoizedState),(s=Pa||za(t,n,s,r,g,l,c))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Aa(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ma(t.type,s),o.props=c,u=t.pendingProps,g=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=wa(l):l=Oi(t,l=Ai(n)?Pi:Ti.current);var f=n.getDerivedStateFromProps;(d="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==u||g!==l)&&qa(t,o,r,l),Pa=!1,g=t.memoizedState,o.state=g,Fa(t,r,o,i);var h=t.memoizedState;s!==u||g!==h||Ii.current||Pa?("function"===typeof f&&(Ua(t,n,f,r),h=t.memoizedState),(c=Pa||za(t,n,c,r,g,h,l)||!1)?(d||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,h,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,h,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=h),o.props=r,o.state=h,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),r=!1)}return Is(e,t,n,r,a,i)}function Is(e,t,n,r,i,a){Rs(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Fi(t,n,!1),Ws(e,t,a);r=t.stateNode,Cs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=$a(t,e.child,null,a),t.child=$a(t,null,s,a)):Ss(e,t,s,a),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function Ps(e){var t=e.stateNode;t.pendingContext?ki(0,t.pendingContext,t.pendingContext!==t.context):t.context&&ki(0,t.context,!1),ro(e,t.containerInfo)}function Os(e,t,n,r,i){return fa(),ha(i),t.flags|=256,Ss(e,t,n,r),t.child}var As,Ns,ks,Ds,xs={dehydrated:null,treeContext:null,retryLane:0};function Fs(e){return{baseLanes:e,cachePool:null,transitions:null}}function js(e,t,n){var r,i=t.pendingProps,o=so.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ri(so,1&o),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,s?(i=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Fc(l,i,0,null),e=xc(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Fs(n),t.memoizedState=xs,e):Vs(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,s){if(n)return 256&t.flags?(t.flags&=-257,Us(e,t,s,r=us(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Fc({mode:"visible",children:r.children},i,0,null),(o=xc(o,i,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&$a(t,e.child,null,s),t.child.memoizedState=Fs(s),t.memoizedState=xs,o);if(0===(1&t.mode))return Us(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Us(e,t,s,r=us(o=Error(a(419)),r,void 0))}if(l=0!==(s&e.childLanes),_s||l){if(null!==(r=Pl)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Ia(e,i),rc(r,e,i,-1))}return mc(),Us(e,t,s,r=us(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Tc.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,ra=ci(i.nextSibling),na=t,ia=!0,aa=null,null!==e&&(Qi[Ki++]=$i,Qi[Ki++]=Yi,Qi[Ki++]=Ji,$i=e.id,Yi=e.overflow,Ji=t),t=Vs(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(s){s=i.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=kc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=kc(r,s):(s=xc(s,l,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,l=null===(l=e.child.memoizedState)?Fs(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=xs,i}return e=(s=e.child).sibling,i=kc(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Vs(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Us(e,t,n,r){return null!==r&&ha(r),$a(t,e.child,null,n),(e=Vs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Gs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ba(e.return,t,n)}function zs(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Hs(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Ss(e,t,r.children,n),0!==(2&(r=so.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Gs(e,n,t);else if(19===e.tag)Gs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ri(so,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===lo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),zs(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===lo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}zs(t,!0,n,null,a);break;case"together":zs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ws(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=kc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=kc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Bs(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ks(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qs(t),null;case 1:case 17:return Ai(t.type)&&Ni(),Qs(t),null;case 3:return r=t.stateNode,io(),wi(Ii),wi(Ti),uo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ua(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(sc(aa),aa=null))),Ns(e,t),Qs(t),null;case 5:oo(t);var i=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)ks(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Qs(t),null}if(e=no(Xa.current),ua(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[gi]=t,r[fi]=o,e=0!==(1&t.mode),n){case"dialog":Vr("cancel",r),Vr("close",r);break;case"iframe":case"object":case"embed":Vr("load",r);break;case"video":case"audio":for(i=0;i<Dr.length;i++)Vr(Dr[i],r);break;case"source":Vr("error",r);break;case"img":case"image":case"link":Vr("error",r),Vr("load",r);break;case"details":Vr("toggle",r);break;case"input":$(r,o),Vr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Vr("invalid",r);break;case"textarea":ie(r,o),Vr("invalid",r)}for(var l in ye(n,o),i=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Zr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Zr(r.textContent,c,e),i=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Vr("scroll",r)}switch(n){case"input":B(r),X(r,o,!0);break;case"textarea":B(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Xr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[gi]=t,e[fi]=r,As(e,t,!1,!1),t.stateNode=e;e:{switch(l=Ce(n,r),n){case"dialog":Vr("cancel",e),Vr("close",e),i=r;break;case"iframe":case"object":case"embed":Vr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Dr.length;i++)Vr(Dr[i],e);i=r;break;case"source":Vr("error",e),i=r;break;case"img":case"image":case"link":Vr("error",e),Vr("load",e),i=r;break;case"details":Vr("toggle",e),i=r;break;case"input":$(e,r),i=J(e,r),Vr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),Vr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Vr("invalid",e)}for(o in ye(n,i),c=i)if(c.hasOwnProperty(o)){var d=c[o];"style"===o?me(e,d):"dangerouslySetInnerHTML"===o?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===o?"string"===typeof d?("textarea"!==n||""!==d)&&ge(e,d):"number"===typeof d&&ge(e,""+d):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=d&&"onScroll"===o&&Vr("scroll",e):null!=d&&C(e,o,d,l))}switch(n){case"input":B(e),X(e,r,!1);break;case"textarea":B(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Xr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Qs(t),null;case 6:if(e&&null!=t.stateNode)Ds(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=no(to.current),no(Xa.current),ua(t)){if(r=t.stateNode,n=t.memoizedProps,r[gi]=t,(o=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Zr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[gi]=t,t.stateNode=r}return Qs(t),null;case 13:if(wi(so),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))ga(),fa(),t.flags|=98560,o=!1;else if(o=ua(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[gi]=t}else fa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Qs(t),o=!1}else null!==aa&&(sc(aa),aa=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Dl&&(Dl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Qs(t),null);case 4:return io(),Ns(e,t),null===e&&zr(t.stateNode.containerInfo),Qs(t),null;case 10:return Ea(t.type._context),Qs(t),null;case 19:if(wi(so),null===(o=t.memoizedState))return Qs(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Bs(o,!1);else{if(0!==Dl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=lo(e))){for(t.flags|=128,Bs(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ri(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&Ye()>Hl&&(t.flags|=128,r=!0,Bs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=lo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Bs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ia)return Qs(t),null}else 2*Ye()-o.renderingStartTime>Hl&&1073741824!==n&&(t.flags|=128,r=!0,Bs(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ye(),t.sibling=null,n=so.current,Ri(so,r?1&n|2:1&n),t):(Qs(t),null);case 22:case 23:return gc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Nl)&&(Qs(t),6&t.subtreeFlags&&(t.flags|=8192)):Qs(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Js(e,t){switch(ta(t),t.tag){case 1:return Ai(t.type)&&Ni(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return io(),wi(Ii),wi(Ti),uo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(wi(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return wi(so),null;case 4:return io(),null;case 10:return Ea(t.type._context),null;case 22:case 23:return gc(),null;default:return null}}As=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ns=function(){},ks=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,no(Xa.current);var a,o=null;switch(n){case"input":i=J(e,i),r=J(e,r),o=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Xr)}for(d in ye(n,r),n=null,i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&null!=i[d])if("style"===d){var l=i[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(s.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var c=r[d];if(l=null!=i?i[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(o||(o=[]),o.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(s.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Vr("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}},Ds=function(e,t,n,r){n!==r&&(t.flags|=4)};var $s=!1,Ys=!1,Zs="function"===typeof WeakSet?WeakSet:Set,Xs=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){wc(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){wc(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&tl(t,n,a)}i=i.next}while(i!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[gi],delete t[fi],delete t[pi],delete t[mi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Xr));else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function dl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(dl(e,t,n),e=e.sibling;null!==e;)dl(e,t,n),e=e.sibling}var ul=null,gl=!1;function fl(e,t,n){for(n=n.child;null!==n;)hl(e,t,n),n=n.sibling}function hl(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:Ys||el(n,t);case 6:var r=ul,i=gl;ul=null,fl(e,t,n),gl=i,null!==(ul=r)&&(gl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(gl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),zt(e)):li(ul,n.stateNode));break;case 4:r=ul,i=gl,ul=n.stateNode.containerInfo,gl=!0,fl(e,t,n),ul=r,gl=i;break;case 0:case 11:case 14:case 15:if(!Ys&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&tl(n,t,o),i=i.next}while(i!==r)}fl(e,t,n);break;case 1:if(!Ys&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){wc(n,t,s)}fl(e,t,n);break;case 21:fl(e,t,n);break;case 22:1&n.mode?(Ys=(r=Ys)||null!==n.memoizedState,fl(e,t,n),Ys=r):fl(e,t,n);break;default:fl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Zs),t.forEach((function(t){var r=Ic.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,gl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,gl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));hl(o,s,i),ul=null,gl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(d){wc(i,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&r){try{rl(3,e,e.return),il(3,e)}catch(m){wc(e,e.return,m)}try{rl(5,e,e.return)}catch(m){wc(e,e.return,m)}}break;case 1:ml(t,e),yl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(ml(t,e),yl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var i=e.stateNode;try{ge(i,"")}catch(m){wc(e,e.return,m)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&Y(i,o),Ce(l,s);var d=Ce(l,o);for(s=0;s<c.length;s+=2){var u=c[s],g=c[s+1];"style"===u?me(i,g):"dangerouslySetInnerHTML"===u?ue(i,g):"children"===u?ge(i,g):C(i,u,g,d)}switch(l){case"input":Z(i,o);break;case"textarea":ae(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;null!=h?ne(i,!!o.multiple,h,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(m){wc(e,e.return,m)}}break;case 6:if(ml(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(m){wc(e,e.return,m)}}break;case 3:if(ml(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(m){wc(e,e.return,m)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(zl=Ye())),4&r&&pl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Ys=(d=Ys)||u,ml(t,e),Ys=d):ml(t,e),yl(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Xs=e,u=e.child;null!==u;){for(g=Xs=u;null!==Xs;){switch(h=(f=Xs).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:el(f,f.return);var p=f.stateNode;if("function"===typeof p.componentWillUnmount){r=f,n=f.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){wc(r,n,m)}}break;case 5:el(f,f.return);break;case 22:if(null!==f.memoizedState){El(g);continue}}null!==h?(h.return=f,Xs=h):El(g)}u=u.sibling}e:for(u=null,g=e;;){if(5===g.tag){if(null===u){u=g;try{i=g.stateNode,d?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=g.stateNode,s=void 0!==(c=g.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",s))}catch(m){wc(e,e.return,m)}}}else if(6===g.tag){if(null===u)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(m){wc(e,e.return,m)}}else if((22!==g.tag&&23!==g.tag||null===g.memoizedState||g===e)&&null!==g.child){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;null===g.sibling;){if(null===g.return||g.return===e)break e;u===g&&(u=null),g=g.return}u===g&&(u=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:ml(t,e),yl(e),4&r&&pl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(ge(i,""),r.flags&=-33),dl(e,ll(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;cl(e,ll(e),o);break;default:throw Error(a(161))}}catch(s){wc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Cl(e,t,n){Xs=e,_l(e,t,n)}function _l(e,t,n){for(var r=0!==(1&e.mode);null!==Xs;){var i=Xs,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||$s;if(!o){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Ys;s=$s;var c=Ys;if($s=o,(Ys=l)&&!c)for(Xs=i;null!==Xs;)l=(o=Xs).child,22===o.tag&&null!==o.memoizedState?bl(i):null!==l?(l.return=o,Xs=l):bl(i);for(;null!==a;)Xs=a,_l(a,t,n),a=a.sibling;Xs=i,$s=s,Ys=c}Sl(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Xs=a):Sl(e)}}function Sl(e){for(;null!==Xs;){var t=Xs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ys||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ys)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ma(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&ja(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}ja(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var g=u.dehydrated;null!==g&&zt(g)}}}break;default:throw Error(a(163))}Ys||512&t.flags&&al(t)}catch(f){wc(t,t.return,f)}}if(t===e){Xs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xs=n;break}Xs=t.return}}function El(e){for(;null!==Xs;){var t=Xs;if(t===e){Xs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xs=n;break}Xs=t.return}}function bl(e){for(;null!==Xs;){var t=Xs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){wc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){wc(t,i,l)}}var a=t.return;try{al(t)}catch(l){wc(t,a,l)}break;case 5:var o=t.return;try{al(t)}catch(l){wc(t,o,l)}}}catch(l){wc(t,t.return,l)}if(t===e){Xs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Xs=s;break}Xs=t.return}}var Ml,wl=Math.ceil,Rl=_.ReactCurrentDispatcher,Ll=_.ReactCurrentOwner,Tl=_.ReactCurrentBatchConfig,Il=0,Pl=null,Ol=null,Al=0,Nl=0,kl=Mi(0),Dl=0,xl=null,Fl=0,jl=0,Vl=0,Ul=null,Gl=null,zl=0,Hl=1/0,ql=null,Wl=!1,Bl=null,Ql=null,Kl=!1,Jl=null,$l=0,Yl=0,Zl=null,Xl=-1,ec=0;function tc(){return 0!==(6&Il)?Ye():-1!==Xl?Xl:Xl=Ye()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Il)&&0!==Al?Al&-Al:null!==pa.transition?(0===ec&&(ec=pt()),ec):0!==(e=Ct)?e:e=void 0===(e=window.event)?16:$t(e.type)}function rc(e,t,n,r){if(50<Yl)throw Yl=0,Zl=null,Error(a(185));vt(e,n,r),0!==(2&Il)&&e===Pl||(e===Pl&&(0===(2&Il)&&(jl|=n),4===Dl&&lc(e,Al)),ic(e,r),1===n&&0===Il&&0===(1&t.mode)&&(Hl=Ye()+500,Vi&&zi()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ot(a),s=1<<o,l=i[o];-1===l?0!==(s&n)&&0===(s&r)||(i[o]=ft(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=gt(e,e===Pl?Al:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Vi=!0,Gi(e)}(cc.bind(null,e)):Gi(cc.bind(null,e)),oi((function(){0===(6&Il)&&zi()})),n=null;else{switch(_t(r)){case 1:n=Xe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Pc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Xl=-1,ec=0,0!==(6&Il))throw Error(a(327));var n=e.callbackNode;if(bc()&&e.callbackNode!==n)return null;var r=gt(e,e===Pl?Al:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var i=Il;Il|=2;var o=pc();for(Pl===e&&Al===t||(ql=null,Hl=Ye()+500,fc(e,t));;)try{Cc();break}catch(l){hc(e,l)}Sa(),Rl.current=o,Il=i,null!==Ol?t=0:(Pl=null,Al=0,t=Dl)}if(0!==t){if(2===t&&(0!==(i=ht(e))&&(r=i,t=oc(e,i))),1===t)throw n=xl,fc(e,0),lc(e,r),ic(e,Ye()),n;if(6===t)lc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!sr(a(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vc(e,r))&&(0!==(o=ht(e))&&(r=o,t=oc(e,o))),1===t))throw n=xl,fc(e,0),lc(e,r),ic(e,Ye()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:Ec(e,Gl,ql);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=zl+500-Ye())){if(0!==gt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(Ec.bind(null,e,Gl,ql),t);break}Ec(e,Gl,ql);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>i&&(i=s),r&=~o}if(r=i,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*wl(r/1960))-r)){e.timeoutHandle=ri(Ec.bind(null,e,Gl,ql),r);break}Ec(e,Gl,ql);break;default:throw Error(a(329))}}}return ic(e,Ye()),e.callbackNode===n?ac.bind(null,e):null}function oc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=Gl,Gl=n,null!==t&&sc(t)),e}function sc(e){null===Gl?Gl=e:Gl.push.apply(Gl,e)}function lc(e,t){for(t&=~Vl,t&=~jl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Il))throw Error(a(327));bc();var t=gt(e,0);if(0===(1&t))return ic(e,Ye()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=ht(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=xl,fc(e,0),lc(e,t),ic(e,Ye()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ec(e,Gl,ql),ic(e,Ye()),null}function dc(e,t){var n=Il;Il|=1;try{return e(t)}finally{0===(Il=n)&&(Hl=Ye()+500,Vi&&zi())}}function uc(e){null!==Jl&&0===Jl.tag&&0===(6&Il)&&bc();var t=Il;Il|=1;var n=Tl.transition,r=Ct;try{if(Tl.transition=null,Ct=1,e)return e()}finally{Ct=r,Tl.transition=n,0===(6&(Il=t))&&zi()}}function gc(){Nl=kl.current,wi(kl)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Ol)for(n=Ol.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ni();break;case 3:io(),wi(Ii),wi(Ti),uo();break;case 5:oo(r);break;case 4:io();break;case 13:case 19:wi(so);break;case 10:Ea(r.type._context);break;case 22:case 23:gc()}n=n.return}if(Pl=e,Ol=e=kc(e.current,null),Al=Nl=t,Dl=0,xl=null,Vl=jl=Fl=0,Gl=Ul=null,null!==Ra){for(t=0;t<Ra.length;t++)if(null!==(r=(n=Ra[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}Ra=null}return e}function hc(e,t){for(;;){var n=Ol;try{if(Sa(),go.current=os,yo){for(var r=po.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}yo=!1}if(ho=0,vo=mo=po=null,Co=!1,_o=0,Ll.current=null,null===n||null===n.return){Dl=1,xl=t,Ol=null;break}e:{var o=e,s=n.return,l=n,c=t;if(t=Al,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,g=u.tag;if(0===(1&u.mode)&&(0===g||11===g||15===g)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=vs(s);if(null!==h){h.flags&=-257,ys(h,s,l,0,t),1&h.mode&&ms(o,d,t),c=d;var p=(t=h).updateQueue;if(null===p){var m=new Set;m.add(c),t.updateQueue=m}else p.add(c);break e}if(0===(1&t)){ms(o,d,t),mc();break e}c=Error(a(426))}else if(ia&&1&l.mode){var v=vs(s);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),ys(v,s,l,0,t),ha(ds(c,l));break e}}o=c=ds(c,l),4!==Dl&&(Dl=2),null===Ul?Ul=[o]:Ul.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,xa(o,hs(0,c,t));break e;case 1:l=c;var y=o.type,C=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==C&&"function"===typeof C.componentDidCatch&&(null===Ql||!Ql.has(C)))){o.flags|=65536,t&=-t,o.lanes|=t,xa(o,ps(o,l,t));break e}}o=o.return}while(null!==o)}Sc(n)}catch(_){t=_,Ol===n&&null!==n&&(Ol=n=n.return);continue}break}}function pc(){var e=Rl.current;return Rl.current=os,null===e?os:e}function mc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Pl||0===(268435455&Fl)&&0===(268435455&jl)||lc(Pl,Al)}function vc(e,t){var n=Il;Il|=2;var r=pc();for(Pl===e&&Al===t||(ql=null,fc(e,t));;)try{yc();break}catch(i){hc(e,i)}if(Sa(),Il=n,Rl.current=r,null!==Ol)throw Error(a(261));return Pl=null,Al=0,Dl}function yc(){for(;null!==Ol;)_c(Ol)}function Cc(){for(;null!==Ol&&!Je();)_c(Ol)}function _c(e){var t=Ml(e.alternate,e,Nl);e.memoizedProps=e.pendingProps,null===t?Sc(e):Ol=t,Ll.current=null}function Sc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ks(n,t,Nl)))return void(Ol=n)}else{if(null!==(n=Js(n,t)))return n.flags&=32767,void(Ol=n);if(null===e)return Dl=6,void(Ol=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ol=t);Ol=t=e}while(null!==t);0===Dl&&(Dl=5)}function Ec(e,t,n){var r=Ct,i=Tl.transition;try{Tl.transition=null,Ct=1,function(e,t,n,r){do{bc()}while(null!==Jl);if(0!==(6&Il))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,o),e===Pl&&(Ol=Pl=null,Al=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Pc(tt,(function(){return bc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Tl.transition,Tl.transition=null;var s=Ct;Ct=1;var l=Il;Il|=4,Ll.current=null,function(e,t){if(ei=qt,fr(e=gr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(S){n=null;break e}var s=0,l=-1,c=-1,d=0,u=0,g=e,f=null;t:for(;;){for(var h;g!==n||0!==i&&3!==g.nodeType||(l=s+i),g!==o||0!==r&&3!==g.nodeType||(c=s+r),3===g.nodeType&&(s+=g.nodeValue.length),null!==(h=g.firstChild);)f=g,g=h;for(;;){if(g===e)break t;if(f===n&&++d===i&&(l=s),f===o&&++u===r&&(c=s),null!==(h=g.nextSibling))break;f=(g=f).parentNode}g=h}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},qt=!1,Xs=t;null!==Xs;)if(e=(t=Xs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xs=e;else for(;null!==Xs;){t=Xs;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var m=p.memoizedProps,v=p.memoizedState,y=t.stateNode,C=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:ma(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(a(163))}}catch(S){wc(t,t.return,S)}if(null!==(e=t.sibling)){e.return=t.return,Xs=e;break}Xs=t.return}p=nl,nl=!1}(e,n),vl(n,e),hr(ti),qt=!!ei,ti=ei=null,e.current=n,Cl(n,e,i),$e(),Il=l,Ct=s,Tl.transition=o}else e.current=n;if(Kl&&(Kl=!1,Jl=e,$l=i),o=e.pendingLanes,0===o&&(Ql=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wl)throw Wl=!1,e=Bl,Bl=null,e;0!==(1&$l)&&0!==e.tag&&bc(),o=e.pendingLanes,0!==(1&o)?e===Zl?Yl++:(Yl=0,Zl=e):Yl=0,zi()}(e,t,n,r)}finally{Tl.transition=i,Ct=r}return null}function bc(){if(null!==Jl){var e=_t($l),t=Tl.transition,n=Ct;try{if(Tl.transition=null,Ct=16>e?16:e,null===Jl)var r=!1;else{if(e=Jl,Jl=null,$l=0,0!==(6&Il))throw Error(a(331));var i=Il;for(Il|=4,Xs=e.current;null!==Xs;){var o=Xs,s=o.child;if(0!==(16&Xs.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Xs=d;null!==Xs;){var u=Xs;switch(u.tag){case 0:case 11:case 15:rl(8,u,o)}var g=u.child;if(null!==g)g.return=u,Xs=g;else for(;null!==Xs;){var f=(u=Xs).sibling,h=u.return;if(ol(u),u===d){Xs=null;break}if(null!==f){f.return=h,Xs=f;break}Xs=h}}}var p=o.alternate;if(null!==p){var m=p.child;if(null!==m){p.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Xs=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Xs=s;else e:for(;null!==Xs;){if(0!==(2048&(o=Xs).flags))switch(o.tag){case 0:case 11:case 15:rl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Xs=y;break e}Xs=o.return}}var C=e.current;for(Xs=C;null!==Xs;){var _=(s=Xs).child;if(0!==(2064&s.subtreeFlags)&&null!==_)_.return=s,Xs=_;else e:for(s=C;null!==Xs;){if(0!==(2048&(l=Xs).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(E){wc(l,l.return,E)}if(l===s){Xs=null;break e}var S=l.sibling;if(null!==S){S.return=l.return,Xs=S;break e}Xs=l.return}}if(Il=i,zi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(E){}r=!0}return r}finally{Ct=n,Tl.transition=t}}return!1}function Mc(e,t,n){e=ka(e,t=hs(0,t=ds(n,t),1),1),t=tc(),null!==e&&(vt(e,1,t),ic(e,t))}function wc(e,t,n){if(3===e.tag)Mc(e,e,n);else for(;null!==t;){if(3===t.tag){Mc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ql||!Ql.has(r))){t=ka(t,e=ps(t,e=ds(n,e),1),1),e=tc(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function Rc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Pl===e&&(Al&n)===n&&(4===Dl||3===Dl&&(130023424&Al)===Al&&500>Ye()-zl?fc(e,0):Vl|=n),ic(e,t)}function Lc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=tc();null!==(e=Ia(e,t))&&(vt(e,t,n),ic(e,n))}function Tc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Lc(e,n)}function Ic(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Lc(e,n)}function Pc(e,t){return Qe(e,t)}function Oc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,r){return new Oc(e,t,n,r)}function Nc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function kc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dc(e,t,n,r,i,o){var s=2;if(r=e,"function"===typeof e)Nc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case b:return xc(n.children,i,o,t);case M:s=8,i|=8;break;case w:return(e=Ac(12,n,t,2|i)).elementType=w,e.lanes=o,e;case I:return(e=Ac(13,n,t,i)).elementType=I,e.lanes=o,e;case P:return(e=Ac(19,n,t,i)).elementType=P,e.lanes=o,e;case N:return Fc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case R:s=10;break e;case L:s=9;break e;case T:s=11;break e;case O:s=14;break e;case A:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ac(s,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function xc(e,t,n,r){return(e=Ac(7,e,r,t)).lanes=n,e}function Fc(e,t,n,r){return(e=Ac(22,e,r,t)).elementType=N,e.lanes=n,e.stateNode={isHidden:!1},e}function jc(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Vc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Gc(e,t,n,r,i,a,o,s,l){return e=new Uc(e,t,n,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Ac(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oa(a),e}function zc(e){if(!e)return Li;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ai(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Ai(n))return Di(e,n,t)}return t}function Hc(e,t,n,r,i,a,o,s,l){return(e=Gc(n,r,!0,e,0,a,0,s,l)).context=zc(null),n=e.current,(a=Na(r=tc(),i=nc(n))).callback=void 0!==t&&null!==t?t:null,ka(n,a,i),e.current.lanes=i,vt(e,i,r),ic(e,r),e}function qc(e,t,n,r){var i=t.current,a=tc(),o=nc(i);return n=zc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Na(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=ka(i,t,o))&&(rc(e,i,o,a),Da(e,i,o)),o}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Bc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Qc(e,t){Bc(e,t),(e=e.alternate)&&Bc(e,t)}Ml=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ii.current)_s=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return _s=!1,function(e,t,n){switch(t.tag){case 3:Ps(t),fa();break;case 5:ao(t);break;case 1:Ai(t.type)&&xi(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ri(va,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ri(so,1&so.current),t.flags|=128,null):0!==(n&t.child.childLanes)?js(e,t,n):(Ri(so,1&so.current),null!==(e=Ws(e,t,n))?e.sibling:null);Ri(so,1&so.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Hs(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ri(so,so.current),r)break;return null;case 22:case 23:return t.lanes=0,ws(e,t,n)}return Ws(e,t,n)}(e,t,n);_s=0!==(131072&e.flags)}else _s=!1,ia&&0!==(1048576&t.flags)&&Xi(t,Bi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;qs(e,t),e=t.pendingProps;var i=Oi(t,Ti.current);Ma(t,n),i=Mo(null,t,r,e,i,n);var o=wo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ai(r)?(o=!0,xi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Oa(t),i.updater=Ga,t.stateNode=i,i._reactInternals=t,Wa(t,r,e,n),t=Is(null,t,r,!0,o,n)):(t.tag=0,ia&&o&&ea(t),Ss(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(qs(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Nc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===O)return 14}return 2}(r),e=ma(r,e),i){case 0:t=Ls(null,t,r,e,n);break e;case 1:t=Ts(null,t,r,e,n);break e;case 11:t=Es(null,t,r,e,n);break e;case 14:t=bs(null,t,r,ma(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ls(e,t,r,i=t.elementType===r?i:ma(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ts(e,t,r,i=t.elementType===r?i:ma(r,i),n);case 3:e:{if(Ps(t),null===e)throw Error(a(387));r=t.pendingProps,i=(o=t.memoizedState).element,Aa(e,t),Fa(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Os(e,t,r,n,i=ds(Error(a(423)),t));break e}if(r!==i){t=Os(e,t,r,n,i=ds(Error(a(424)),t));break e}for(ra=ci(t.stateNode.containerInfo.firstChild),na=t,ia=!0,aa=null,n=Ya(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fa(),r===i){t=Ws(e,t,n);break e}Ss(e,t,r,n)}t=t.child}return t;case 5:return ao(t),null===e&&ca(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==o&&ni(r,o)&&(t.flags|=32),Rs(e,t),Ss(e,t,s,n),t.child;case 6:return null===e&&ca(t),null;case 13:return js(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=$a(t,null,r,n):Ss(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Es(e,t,r,i=t.elementType===r?i:ma(r,i),n);case 7:return Ss(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ss(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Ri(va,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===i.children&&!Ii.current){t=Ws(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Na(-1,n&-n)).tag=2;var d=o.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),ba(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),ba(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}Ss(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ma(t,n),r=r(i=wa(i)),t.flags|=1,Ss(e,t,r,n),t.child;case 14:return i=ma(r=t.type,t.pendingProps),bs(e,t,r,i=ma(r.type,i),n);case 15:return Ms(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ma(r,i),qs(e,t),t.tag=1,Ai(r)?(e=!0,xi(t)):e=!1,Ma(t,n),Ha(t,r,i),Wa(t,r,i,n),Is(null,t,r,!0,e,n);case 19:return Hs(e,t,n);case 22:return ws(e,t,n)}throw Error(a(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Jc(e){this._internalRoot=e}function $c(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function ed(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof i){var s=i;i=function(){var e=Wc(o);s.call(e)}}qc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=Wc(o);a.call(e)}}var o=Hc(t,r,e,0,null,!1,0,"",Xc);return e._reactRootContainer=o,e[hi]=o.current,zr(8===e.nodeType?e.parentNode:e),uc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=Wc(l);s.call(e)}}var l=Gc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[hi]=l.current,zr(8===e.nodeType?e.parentNode:e),uc((function(){qc(t,l,n,r)})),l}(n,t,e,i,r);return Wc(o)}$c.prototype.render=Jc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));qc(e,t,null,null)},$c.prototype.unmount=Jc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){qc(null,e,null,null)})),t[hi]=null}},$c.prototype.unstable_scheduleHydration=function(e){if(e){var t=Mt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Nt.length&&0!==t&&t<Nt[n].priority;n++);Nt.splice(n,0,e),0===n&&Ft(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(yt(t,1|n),ic(t,Ye()),0===(6&Il)&&(Hl=Ye()+500,zi()))}break;case 13:uc((function(){var t=Ia(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),Qc(e,1)}},Et=function(e){if(13===e.tag){var t=Ia(e,134217728);if(null!==t)rc(t,e,134217728,tc());Qc(e,134217728)}},bt=function(e){if(13===e.tag){var t=nc(e),n=Ia(e,t);if(null!==n)rc(n,e,t,tc());Qc(e,t)}},Mt=function(){return Ct},wt=function(e,t){var n=Ct;try{return Ct=e,t()}finally{Ct=n}},Ee=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Si(r);if(!i)throw Error(a(90));Q(r),Z(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=dc,Ie=uc;var td={usingClientEntryPoint:!1,Events:[Ci,_i,Si,Re,Le,dc]},nd={findFiberByHostInstance:yi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rd={bundleType:nd.bundleType,version:nd.version,rendererPackageName:nd.rendererPackageName,rendererConfig:nd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:nd.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var id=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!id.isDisabled&&id.supportsFiber)try{it=id.inject(rd),at=id}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=td,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(a(299));var n=!1,r="",i=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Gc(e,1,!1,null,0,n,0,r,i),e[hi]=t.current,zr(8===e.nodeType?e.parentNode:e),new Jc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Zc(t))throw Error(a(200));return ed(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",s=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Hc(t,null,e,1,null!=n?n:null,i,0,o,s),e[hi]=t.current,zr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new $c(t)},t.render=function(e,t,n){if(!Zc(t))throw Error(a(200));return ed(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc((function(){ed(null,null,e,!1,(function(){e._reactRootContainer=null,e[hi]=null}))})),!0)},t.unstable_batchedUpdates=dc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return ed(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},250:(e,t,n)=>{"use strict";var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:(e,t,n)=>{"use strict";var r=n(791),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:d,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},117:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),f=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}function y(){}function C(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var _=C.prototype=new y;_.constructor=C,p(_,v.prototype),_.isPureReactComponent=!0;var S=Array.isArray,E=Object.prototype.hasOwnProperty,b={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function w(e,t,r){var i,a={},o=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)E.call(t,i)&&!M.hasOwnProperty(i)&&(a[i]=t[i]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:s,props:a,_owner:b.current}}function R(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var L=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,i,a,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===a?"."+T(l,0):a,S(o)?(i="",null!=e&&(i=e.replace(L,"$&/")+"/"),I(o,t,i,"",(function(e){return e}))):null!=o&&(R(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(L,"$&/")+"/")+e)),t.push(o)),1;if(l=0,a=""===a?".":a+":",S(e))for(var c=0;c<e.length;c++){var d=a+T(s=e[c],c);l+=I(s,t,i,d,o)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(s=e.next()).done;)l+=I(s=s.value,t,i,d=a+T(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,n){if(null==e)return e;var r=[],i=0;return I(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function O(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A={current:null},N={transition:null},k={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:N,ReactCurrentOwner:b};t.Children={map:P,forEach:function(e,t,n){P(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!R(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=o,t.PureComponent=C,t.StrictMode=a,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=p({},e.props),a=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=b.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)E.call(t,c)&&!M.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];i.children=l}return{$$typeof:n,type:e.type,key:a,ref:o,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=w,t.createFactory=function(e){var t=w.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=R,t.lazy=function(e){return{$$typeof:g,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=N.transition;N.transition={};try{e()}finally{N.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return A.current.useCallback(e,t)},t.useContext=function(e){return A.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return A.current.useDeferredValue(e)},t.useEffect=function(e,t){return A.current.useEffect(e,t)},t.useId=function(){return A.current.useId()},t.useImperativeHandle=function(e,t,n){return A.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return A.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return A.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return A.current.useMemo(e,t)},t.useReducer=function(e,t,n){return A.current.useReducer(e,t,n)},t.useRef=function(e){return A.current.useRef(e)},t.useState=function(e){return A.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return A.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return A.current.useTransition()},t.version="18.2.0"},791:(e,t,n)=>{"use strict";e.exports=n(117)},184:(e,t,n)=>{"use strict";e.exports=n(374)},813:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var s=2*(r+1)-1,l=e[s],c=s+1,d=e[c];if(0>a(l,n))c<i&&0>a(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<i&&0>a(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],d=[],u=1,g=null,f=3,h=!1,p=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,C="undefined"!==typeof setImmediate?setImmediate:null;function _(e){for(var t=r(d);null!==t;){if(null===t.callback)i(d);else{if(!(t.startTime<=e))break;i(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function S(e){if(m=!1,_(e),!p)if(null!==r(c))p=!0,N(E);else{var t=r(d);null!==t&&k(S,t.startTime-e)}}function E(e,n){p=!1,m&&(m=!1,y(R),R=-1),h=!0;var a=f;try{for(_(n),g=r(c);null!==g&&(!(g.expirationTime>n)||e&&!I());){var o=g.callback;if("function"===typeof o){g.callback=null,f=g.priorityLevel;var s=o(g.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?g.callback=s:g===r(c)&&i(c),_(n)}else i(c);g=r(c)}if(null!==g)var l=!0;else{var u=r(d);null!==u&&k(S,u.startTime-n),l=!1}return l}finally{g=null,f=a,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var b,M=!1,w=null,R=-1,L=5,T=-1;function I(){return!(t.unstable_now()-T<L)}function P(){if(null!==w){var e=t.unstable_now();T=e;var n=!0;try{n=w(!0,e)}finally{n?b():(M=!1,w=null)}}else M=!1}if("function"===typeof C)b=function(){C(P)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,A=O.port2;O.port1.onmessage=P,b=function(){A.postMessage(null)}}else b=function(){v(P,0)};function N(e){w=e,M||(M=!0,b())}function k(e,n){R=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,N(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:u++,callback:i,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(e.sortIndex=a,n(d,e),null===r(c)&&e===r(d)&&(m?(y(R),R=-1):m=!0,k(S,a-o))):(e.sortIndex=s,n(c,e),p||h||(p=!0,N(E))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},296:(e,t,n)=>{"use strict";e.exports=n(813)},637:(e,t,n)=>{"use strict";var r=n(791);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},a=r.useSyncExternalStore,o=r.useRef,s=r.useEffect,l=r.useMemo,c=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,d){var u=o(null);if(null===u.current){var g={hasValue:!1,value:null};u.current=g}else g=u.current;u=l((function(){function e(e){if(!s){if(s=!0,a=e,e=r(e),void 0!==d&&g.hasValue){var t=g.value;if(d(t,e))return o=t}return o=e}if(t=o,i(a,e))return t;var n=r(e);return void 0!==d&&d(t,n)?t:(a=e,o=n)}var a,o,s=!1,l=void 0===n?null:n;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]}),[t,n,r,d]);var f=a(e,u[0],u[1]);return s((function(){g.hasValue=!0,g.value=f}),[f]),c(f),f}},995:(e,t,n)=>{"use strict";e.exports=n(637)},454:function(e,t){(function(){var n;n=(()=>{var e={6143:function(e,t){!function(e){"use strict";e.createStatelessFSM=(e,t,n,r)=>{const i={context:n,prevValue:null,get value(){return e.value},set value(t){e.value=t},states:t,transition(e){null==r||r.log("FSM: received event",e);const t=this.states[this.value][e];if(!t)return null==r||r.warn("FSM: there is no state for transition on ".concat(this.value," state")),!1;try{const e="unknown"===t?a(this.states.unknown,this.context):t;return e===this.value?(null==r||r.log("FSM: there are not state changes"),!1):(null==r||r.log("FSM: transition from ".concat(this.value," to ").concat(e)),this.prevValue=this.value,this.value=e,this.value)}catch(e){return null==r||r.error("FSM: transition failed, rollback to ".concat(this.value," state")),!1}}},a=(e,t)=>{if(null==r||r.log("FSM: handling unknown state"),!e)throw Error("Transitions from unknown state are not provided");let n=null;for(const i in e){const a=e[i];if(null==a?void 0:a(t)){null==r||r.log("FSM: the state ".concat(i," matches conditions")),n=i;break}}if(!n){const e="FSM: cannot make transition from unknown state";throw null==r||r.error(e),Error(e)}return n};return i},Object.defineProperty(e,"__esModule",{value:!0})}(t)},6185:function(e,t){!function(e){"use strict";class t{constructor(e){this.content=e,this.observers=new Set}notify(){for(const e of this.observers)e(this.content)}watch(e){this.observers.add(e)}unwatch(e){this.observers.delete(e)}clear(){this.observers.clear()}get value(){return this.content}set value(e){this.content=e,this.notify()}}e.obs=e=>new t(e),Object.defineProperty(e,"__esModule",{value:!0})}(t)},1206:function(e){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=n(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var i=e.getVersionPrecision(t),a=e.getVersionPrecision(n),o=Math.max(i,a),s=0,l=e.map([t,n],(function(t){var n=o-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(s=o-Math.min(i,a)),o-=1;o>=s;){if(l[0][o]>l[1][o])return 1;if(l[0][o]===l[1][o]){if(o===s)return 0;o-=1}else if(l[0][o]<l[1][o])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var i=e[n];if(t(i,n))return i}},e.assign=function(e){for(var t,n,r=e,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];if(Object.assign)return Object.assign.apply(Object,[e].concat(a));var s=function(){var e=a[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=a.length;t<n;t+=1)s();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(91))&&r.__esModule?r:{default:r},a=n(18);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){}var t,n;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,n=[{key:"BROWSER_MAP",get:function(){return a.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return a.ENGINE_MAP}},{key:"OS_MAP",get:function(){return a.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return a.PLATFORMS_MAP}}],null&&o(t.prototype,null),n&&o(t,n),e}();t.default=s,e.exports=t.default},91:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=l(n(92)),i=l(n(93)),a=l(n(94)),o=l(n(95)),s=l(n(17));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,i={},a=0;if(Object.keys(e).forEach((function(t){var o=e[t];"string"==typeof o?(i[t]=o,a+=1):"object"==typeof o&&(n[t]=o,r+=1)})),r>0){var o=Object.keys(n),l=s.default.find(o,(function(e){return t.isOS(e)}));if(l){var c=this.satisfies(n[l]);if(void 0!==c)return c}var d=s.default.find(o,(function(e){return t.isPlatform(e)}));if(d){var u=this.satisfies(n[d]);if(void 0!==u)return u}}if(a>0){var g=Object.keys(i),f=s.default.find(g,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(i[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),i=s.default.getBrowserTypeByAlias(r);return t&&i&&(r=i.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(s.default.compareVersions(i,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=c,e.exports=t.default},92:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},a=/version\/(\d+(\.?_?\d+)+)/i,o=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=o,e.exports=t.default},93:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},a=n(18),o=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:a.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=i.default.getWindowsVersionName(t);return{name:a.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:a.OS_MAP.iOS},n=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=i.default.getMacOSVersionName(t),r={name:a.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:a.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=i.default.getAndroidVersionName(t),r={name:a.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:a.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:a.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:a.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:a.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.PlayStation4,version:t}}}];t.default=o,e.exports=t.default},94:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},a=n(18),o=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:a.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:a.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:a.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.tv}}}];t.default=o,e.exports=t.default},95:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},a=n(18),o=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:a.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:a.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:a.ENGINE_MAP.Trident},n=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:a.ENGINE_MAP.Presto},n=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:a.ENGINE_MAP.Gecko},n=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:a.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:a.ENGINE_MAP.WebKit},n=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=o,e.exports=t.default}})},9091:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(209),i=n(7998),a=n(1150),o=n(4106),s=n(2957),l=n(141),c=n(125),d=n(245),u="The operator status update failed by timeout.",g="You try to perform multiple ACD operations at the same time. This can lead to an unexpected behavior of your application.",f="You probably use the same credentials in the different browsers or multiple browser\u2019s windows. This error can also occur when you make a request, reload the page and receive response after the page reloads.",h="Wrong ACD status name {0}";class p{static get newUUID(){return(new r.default).toString()+"_"+p._connectionId}static setConnectionId(e){this._connectionId=e}static removeConnectionId(){this._connectionId=void 0}static setStatus(e){return new Promise(((t,n)=>{p._checkBeforeRun(i.OperatorACDStatuses[e],n);const r=p.newUUID;d.default.callRemoteFunction(o.RemoteFunction.setOperatorACDStatus,e,r),this._acdRequests.push({resolve:t,reject:n,timer:window.setTimeout((()=>{p._acdRequests=p._acdRequests.filter((e=>e.uuid!==r)),n(u)}),58e3),uuid:r,status:e})}))}static getStatus(){return new Promise(((e,t)=>{p._checkBeforeRun(void 0,t);const n=p.newUUID;d.default.callRemoteFunction(o.RemoteFunction.getOperatorACDStatus,n),this._acdRequests.push({resolve:e,reject:t,timer:window.setTimeout((()=>{p._acdRequests=p._acdRequests.filter((e=>e.uuid!==n)),t(u)}),58e3),uuid:n})}))}static onError(e,t,n){const{actor:r,actorIdx:i}=p._getActorByUUID(e);r&&(clearTimeout(r.timer),r.reject(new Error(s.Utils.strFormat(h,r.status||"get operation"))),p._acdRequests.splice(0,i+1))}static onStatusUpdated(e,t,n){p._checkConnectionId(t);const{actor:r,actorIdx:i}=p._getActorByUUID(t);if(r){if(clearTimeout(r.timer),0!==i)for(let t=0;t<i;t++)clearTimeout(p._acdRequests[t].timer),p._acdRequests[t].reject(new Error(s.Utils.strFormat("The {0} status is set in your code after {1}. The {0} status is ignored.",r.status||"get operation",e)));void 0===r.status||r.status===e?r.resolve(e):r.reject(new Error(s.Utils.strFormat("The {0} status is not acceptable for the current operator state. The operator is {1} now. Please, check the ACD module documentation for details.",r.status,e))),p._acdRequests.splice(0,i+1)}c.Client.getInstance().dispatchEvent({name:l.Events.ACDStatusUpdated,id:p._getConnectonIdFromUUID(t),status:e,description:n})}static _checkBeforeRun(e,t){p._connectionId||t(new Error("You can't set an operator status before login.")),p._acdRequests.length>0&&(a.LogManager.get().writeMessage(a.LogCategory.CLIENT,"ACD",a.LogLevel.WARNING,g),c.Client.getInstance().dispatchEvent({name:l.Events.ACDError,code:5,message:g})),void 0===e||Object.values(i.OperatorACDStatuses).includes(e)||t(new Error(s.Utils.strFormat(h,e)))}static _getActorByUUID(e){let t=-1;return{actor:this._acdRequests.find(((n,r)=>{if(n.uuid===e)return t=r,!0})),actorIdx:t}}static _getConnectonIdFromUUID(e){const t=e.split("_");return 1===t.length||"gw"===t[1]?p._connectionId:t[1]}static _checkConnectionId(e){var t;const n=e.split("_");1!==n.length&&n[1]===(null===(t=p._connectionId)||void 0===t?void 0:t.split("_")[0])||(c.Client.getInstance().dispatchEvent({name:l.Events.ACDError,code:6,message:f}),a.LogManager.get().writeMessage(a.LogCategory.CLIENT,"ACD",a.LogLevel.WARNING,f))}}t.default=p,p._acdRequests=[]},2089:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(209),i=n(7998),a=n(1150),o=n(4106),s=n(2957),l=n(141),c=n(125),d=n(245),u="The operator status update failed by timeout.",g="You try to perform multiple ACD operations at the same time. This can lead to an unexpected behavior of your application.",f="You probably use the same credentials in the different browsers or multiple browser\u2019s windows. This error can also occur when you make a request, reload the page and receive response after the page reloads.",h="Wrong ACD status name {0}";class p{static get newUUID(){return(new r.default).toString()+"_"+p._connectionId}static setConnectionId(e){this._connectionId=e}static removeConnectionId(){this._connectionId=void 0}static setStatus(e){return new Promise(((t,n)=>{p._checkBeforeRun(i.OperatorACDStatuses[e],n);const r=p.newUUID;d.default.callRemoteFunction(o.RemoteFunction.setOperatorMessagingStatus,e,r),this._acdRequests.push({resolve:t,reject:n,timer:window.setTimeout((()=>{p._acdRequests=p._acdRequests.filter((e=>e.uuid!==r)),n(u)}),58e3),uuid:r,status:e})}))}static getStatus(){return new Promise(((e,t)=>{p._checkBeforeRun(void 0,t);const n=p.newUUID;d.default.callRemoteFunction(o.RemoteFunction.getOperatorMessagingStatus,n),this._acdRequests.push({resolve:e,reject:t,timer:window.setTimeout((()=>{p._acdRequests=p._acdRequests.filter((e=>e.uuid!==n)),t(u)}),58e3),uuid:n})}))}static onError(e,t,n){const{actor:r,actorIdx:i}=p._getActorByUUID(e);r&&(clearTimeout(r.timer),r.reject(new Error(s.Utils.strFormat(h,r.status||"get operation"))),p._acdRequests.splice(0,i+1))}static onStatusUpdated(e,t,n){p._checkConnectionId(t);const{actor:r,actorIdx:i}=p._getActorByUUID(t);if(r){if(clearTimeout(r.timer),0!==i)for(let t=0;t<i;t++)clearTimeout(p._acdRequests[t].timer),p._acdRequests[t].reject(new Error(s.Utils.strFormat("The {0} status is set in your code after {1}. The {0} status is ignored.",r.status||"get operation",e)));void 0===r.status||r.status===e?r.resolve(e):r.reject(new Error(s.Utils.strFormat("The {0} status is not acceptable for the current operator state. The operator is {1} now. Please, check the ACD module documentation for details.",r.status,e))),p._acdRequests.splice(0,i+1)}c.Client.getInstance().dispatchEvent({name:l.Events.SQMessagingStatusUpdated,id:p._getConnectonIdFromUUID(t),status:e,description:n})}static _checkBeforeRun(e,t){p._connectionId||t(new Error("You can't set an operator status before login.")),p._acdRequests.length>0&&(a.LogManager.get().writeMessage(a.LogCategory.CLIENT,"ACD",a.LogLevel.WARNING,g),c.Client.getInstance().dispatchEvent({name:l.Events.SQError,code:5,message:g})),void 0===e||Object.values(i.OperatorACDStatuses).includes(e)||t(new Error(s.Utils.strFormat(h,e)))}static _getActorByUUID(e){let t=-1;return{actor:this._acdRequests.find(((n,r)=>{if(n.uuid===e)return t=r,!0})),actorIdx:t}}static _getConnectonIdFromUUID(e){const t=e.split("_");return 1===t.length||"gw"===t[1]?p._connectionId:t[1]}static _checkConnectionId(e){var t;const n=e.split("_");1!==n.length&&n[1]===(null===(t=p._connectionId)||void 0===t?void 0:t.split("_")[0])||(c.Client.getInstance().dispatchEvent({name:l.Events.SQError,code:6,message:f}),a.LogManager.get().writeMessage(a.LogCategory.CLIENT,"ACD",a.LogLevel.WARNING,f))}}t.default=p,p._acdRequests=[]},3947:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.Authenticator=t.AuthenticatorState=void 0;const i=n(1150),a=n(84),o=n(4106),s=n(575),l=n(125),c=n(9091),d=n(4758),u=n(2089),g=n(245);var f;!function(e){e[e.IDLE=0]="IDLE",e[e.IN_PROGRESS=1]="IN_PROGRESS"}(f=t.AuthenticatorState||(t.AuthenticatorState={}));class h{constructor(){this.FAIL_CODE_SECOND_STAGE=301,this.FAIL_CODE_ONE_TIME_KEY=302,this._displayName=null,this._username=null,this._authorized=!1,this.currentState=f.IDLE,this.logger=i.LogManager.get().createLogger(i.LogCategory.SIGNALING,this._traceName()),g.default.setRPCHandler(s.RemoteEvent.loginFailed,((e,t)=>{this.onLoginFailed(e,t)})),g.default.setRPCHandler(s.RemoteEvent.loginSuccessful,((e,t)=>{this.onLoginSuccesful(e,t)})),g.default.setRPCHandler(s.RemoteEvent.refreshOauthTokenFailed,(e=>{this.handler.onRefreshTokenFailed(e)})),g.default.setRPCHandler(s.RemoteEvent.refreshOauthTokenSuccessful,(e=>{this.handler.onRefreshTokenSuccess(e.OAuth)})),g.default.addHandler(this)}static get(){return void 0===this.inst&&(this.inst=new h),this.inst}setHandler(e){this.handler=e}onLoginFailed(e,t){switch(this.currentState=f.IDLE,e){case this.FAIL_CODE_ONE_TIME_KEY:this.handler.onOneTimeKeyGenerated(t);break;case this.FAIL_CODE_SECOND_STAGE:this.handler.onSecondStageInitiated();break;default:this.handler.onLoginFailed(e)}}onLoginSuccesful(e,t){this.currentState=f.IDLE,this._authorized=!0,a.PCFactory.get().iceConfig=t.iceConfig,c.default.setConnectionId(t.connectionId),u.default.setConnectionId(t.connectionId),l.Client.getInstance().setConnectionData(null,t.connectionId),this._displayName=e,this.handler.onLoginSuccessful(e,t.OAuth)}get displayName(){return this._displayName}basicLogin(e,t,n){if(this.currentState!=f.IDLE)return void this.logger.error("Login operation already in progress");this._username=e,this.currentState=f.IN_PROGRESS;let r=t;if("md5"===n.credentialType){const n=e.split("@")[0];r=d.Md5.hashStr("".concat(n,":voximplant.com:").concat(t)).toString()}g.default.callRemoteFunction(o.RemoteFunction.login,e,r,n)}tokenLogin(e,t){this.currentState==f.IDLE?(this._username=e,this.currentState=f.IN_PROGRESS,g.default.callRemoteFunction(o.RemoteFunction.login,e,"",t)):this.logger.error("Login operation already in progress")}tokenRefresh(e,t,n){n?g.default.callRemoteFunction(o.RemoteFunction.refreshOauthToken,e,{refreshToken:t,deviceToken:n}):g.default.callRemoteFunction(o.RemoteFunction.refreshOauthToken,e,t)}loginUsingOneTimeKey(e,t,n){this.logger.info("loginWithOneTimeKey running for "+e),this.currentState==f.IDLE?(this._username=e,this.currentState=f.IN_PROGRESS,g.default.callRemoteFunction(o.RemoteFunction.loginUsingOneTimeKey,e,t,n)):this.logger.error("Login operation already in progress. loginWithOneTimeKey was canceled")}loginStage2(e,t,n){this.logger.info("loginWithCode running for "+e),this.currentState==f.IDLE?(this._username=e,this.currentState=f.IN_PROGRESS,g.default.callRemoteFunction(o.RemoteFunction.loginStage2,e,t,n)):this.logger.error("Login operation already in progress. loginWithCode was canceled.")}generateOneTimeKey(e){this.logger.info("requestOneTimeLoginKey running for "+e),this.currentState==f.IDLE?(this.currentState=f.IN_PROGRESS,g.default.callRemoteFunction(o.RemoteFunction.loginGenerateOneTimeKey,e)):this.logger.error("Login operation already in progress. requestOneTimeLoginKey was canceled.")}username(){return this._username}authorized(){return this._authorized}onSignalingConnected(){}onSignalingConnectionFailed(e){}onSignalingClosed(){this.currentState=f.IDLE,this._authorized=!1,this._displayName=null,this._username=null}onMediaConnectionFailed(){this.currentState=f.IDLE}ziAuthorized(e){this._authorized=e}_traceName(){return"Authenticator"}}r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"setHandler",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"onLoginFailed",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"onLoginSuccesful",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"basicLogin",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"tokenLogin",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"tokenRefresh",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"loginUsingOneTimeKey",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"loginStage2",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"generateOneTimeKey",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"username",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"authorized",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"onSignalingConnected",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"onSignalingConnectionFailed",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"onSignalingClosed",null),r([i.LogManager.d_trace(i.LogCategory.AUTHENTICATOR)],h.prototype,"onMediaConnectionFailed",null),t.Authenticator=h},3869:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1150),i=n(9165),a=n(6518),o=n(9551),s=n(9023),l=n(125),c=n(1206);var d;!function(e){let t,n;function d(e,t,n){let r=e;return"object"!=typeof r&&(r={}),r[t]={ideal:n},r}function u(e,t){return new o.SignalingDTMFSender(t)}function g(){return new Promise((e=>{e(!1)}))}function f(e){let t=!1,n=!1;return e.audioEnabled&&(t=!0,e.audioInputId&&(t=d(t,"deviceId",e.audioInputId))),e.videoEnabled&&(n=!0,e.videoSettings&&(n=e.videoSettings),e.videoInputId&&(n=d(n,"deviceId",e.videoInputId))),{peerIdentity:null,audio:t,video:n}}function h(){n=navigator.mozGetUserMedia?t.Firefox:navigator.webkitGetUserMedia?t.Webkit:t.Safari}!function(e){e[e.Firefox=1]="Firefox",e[e.Webkit=2]="Webkit",e[e.Edge=3]="Edge",e[e.Safari=4]="Safari"}(t||(t={})),c.getParser(window.navigator.userAgent),e.isIphone=function(){return!(!l.Client.getInstance().config().experiments||!l.Client.getInstance().config().experiments.emulate_ios)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)},e.isIpad=function(){return!(!l.Client.getInstance().config().experiments||!l.Client.getInstance().config().experiments.emulate_ios)||navigator.userAgent.match(/iPad/i)||navigator.maxTouchPoints>0&&n===t.Safari},e.isScreenSharingSupported=function(){return n===t.Firefox||n===t.Webkit||n===t.Safari&&0===navigator.maxTouchPoints},e.getWSVendor=function(){switch(n||h(),n){case t.Firefox:return"firefox";case t.Webkit:return"chrome";case t.Safari:return"safari";default:return""}},e.init=function(){switch(n||h(),n&&r.LogManager.get().writeMessage(r.LogCategory.RTC,"Core",r.LogLevel.INFO,"Detected browser "+t[n]),e.getDTMFSender=u,e.screenSharingSupported=g,n){case t.Firefox:e.attachMedia=i.FF.attachStream,e.detachMedia=i.FF.detachStream,e.getScreenMedia=i.FF.getScreenMedia,e.getRTCStats=i.FF.getRTCStats,e.screenSharingSupported=i.FF.screenSharingSupported,e.getDTMFSender=i.FF.getDTMFSender;break;case t.Webkit:e.attachMedia=a.Webkit.attachStream,e.detachMedia=a.Webkit.detachStream,e.getScreenMedia=a.Webkit.getScreenMedia,e.getRTCStats=a.Webkit.getRTCStats,e.screenSharingSupported=a.Webkit.screenSharingSupported,e.getDTMFSender=a.Webkit.getDTMFSender;break;case t.Safari:e.attachMedia=s.Safari.attachStream,e.detachMedia=s.Safari.detachStream,e.getScreenMedia=s.Safari.getScreenMedia,e.getRTCStats=s.Safari.getRTCStats,e.screenSharingSupported=s.Safari.screenSharingSupported,e.getDTMFSender=s.Safari.getDTMFSender;break;default:r.LogManager.get().writeMessage(r.LogCategory.RTC,"Core",r.LogLevel.INFO,"Unsupported browser "+navigator.userAgent)}e.composeConstraints=f}}(d||(d={})),t.default=d},9165:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FF=void 0;const r=n(9551),i=n(1150);class a{static attachStream(e){let t=e.element;void 0===t.srcObject?t.mozSrcObject=e.stream:t.srcObject=e.stream}static detachStream(e){let t=e.element;void 0===t.srcObject?t.mozSrcObject=null:t.srcObject=null,t.src=""}static screenSharingSupported(){return new Promise(((e,t)=>{"https:"==window.location.protocol?e(!0):e(!1)}))}static getScreenMedia(){const e={audio:!1,video:{mediaSource:"window"}};return i.LogManager.get().writeMessage(i.LogCategory.USERMEDIA,"[constraints]",i.LogLevel.TRACE,JSON.stringify(e)),navigator.mediaDevices.getUserMedia(e)}static getRTCStats(e){return new Promise(((t,n)=>{e.getStats(null).then((e=>{let n=[];e.forEach((e=>{"inbound-rtp"!=e.type&&"outbound-rtp"!=e.type||n.push(e)})),t({raw:n,formatted:a.prepareRTCStats(e)})})).catch(n)}))}static prepareRTCStats(e){let t=[];return e.forEach((e=>{"outbound-rtp"===e.type||e.isRemote?t.push(Object.assign(e,{framesPerSecond:e.framesPerSecond?e.framesPerSecond:e.framerateMean,encoderBitrate:e.bitrateMean})):t.push(e)})),t}static getDTMFSender(e,t){const n=/Firefox\/([0-9\.]+)(?:\s|$)/,i=navigator.userAgent;if(n.test(i)&&+n.exec(i)[1].split(".")[0]>=53){const t=e.getSenders().map((e=>{if(e.track&&"audio"===e.track.kind&&e.dtmf)return e.dtmf}));if(t.length>0)return t[0]}return new r.SignalingDTMFSender(t)}_traceName(){return"FF"}}t.FF=a},9023:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Safari=void 0;const r=n(9551),i=n(1150);class a{static attachStream(e){try{e.element.srcObject=e.stream}catch(t){i.LogManager.get().writeMessage(i.LogCategory.USERMEDIA,"Safari: ",i.LogLevel.WARNING,"attachStream() has failed: ".concat(JSON.stringify(t),". MediaRenderer.element is ").concat(null==e?void 0:e.element," and MediaRenderer.stream is ").concat(null==e?void 0:e.stream))}}static detachStream(e){e.pauseElement(),e.element.src=""}static getDTMFSender(e,t){return new r.SignalingDTMFSender(t)}static getScreenMedia(){return navigator.mediaDevices.getDisplayMedia({audio:!1,video:!0})}static screenSharingSupported(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia?Promise.resolve(!0):Promise.resolve(!1)}static getRTCStats(e){return new Promise(((t,n)=>{let r=[];e.getStats(null).then((e=>{e.forEach((e=>{if("ssrc"==e.type){let t={};t.id=e.id,t.type=e.type,t.timestamp=e.timestamp,r.push(t)}})),t({raw:r,formatted:a.prepareRTCStats(e)})})).catch(n)}))}static prepareRTCStats(e){let t=[];return e.forEach((e=>{"track"!==e.type||e.kind?"outbound-rtp"===e.type||"inbound-rtp"===e.type?t.push(Object.assign(e,{trackId:e.mediaTrackId})):t.push(e):t.push(Object.assign(e,{kind:e.id.includes("audio")?"audio":e.id.includes("video")?"video":void 0}))})),t}_traceName(){return"Safari"}}t.Safari=a},9551:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignalingDTMFSender=void 0;const r=n(4106),i=n(245);t.SignalingDTMFSender=class{constructor(e){this._id=e}insertDTMF(e,t,n){(""+e).split("").forEach((e=>this.sendKey(e)))}sendKey(e){let t;t="*"==e?10:"#"==e?11:parseInt(e),(t>=0||t<=11)&&i.default.callRemoteFunction(r.RemoteFunction.sendDTMF,this._id,t)}_traceName(){return"SignalingDTMFSender"}}},6518:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Webkit=void 0;const r=n(9551),i=n(125),a=n(1150);class o{static attachStream(e){let t=e.element;try{t.srcObject=e.stream;const n=i.Client.getInstance()._defaultSinkId;null!=n&&"function"==typeof t.setSinkId&&t.setSinkId(n)}catch(e){a.LogManager.get().writeMessage(a.LogCategory.USERMEDIA,"Webkit: ",a.LogLevel.WARNING,JSON.stringify(e))}}static detachStream(e){e.element.srcObject=null,e.pauseElement(),e.element.src=""}static getDTMFSender(e,t){if(!e.createDTMFSender)return new r.SignalingDTMFSender(t);{let t=[];if(e.getLocalStreams().forEach((e=>{e.getAudioTracks().forEach((e=>{t.push(e)}))})),t.length)return e.createDTMFSender(t[0])}}static screenSharingSupported(){return-1!==navigator.userAgent.indexOf("Android")?Promise.resolve(!1):new Promise(((e,t)=>{if(navigator.getDisplayMedia)e(!0);else if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)e(!0);else{const t=r=>{r.origin===window.location.origin&&"VoximplantWebsdkExtensionLoaded"===r.data&&(window.removeEventListener("message",t),clearTimeout(n),e(!0))};window.addEventListener("message",t),window.postMessage("VoximplantWebsdkCheckExtension","*");const n=setTimeout((()=>{window.removeEventListener("message",t),e(!1)}),800)}}))}static getScreenMedia(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return navigator.getDisplayMedia?navigator.getDisplayMedia({video:!0,audio:e}):navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia?navigator.mediaDevices.getDisplayMedia({video:!0,audio:e}):new Promise(((t,n)=>{window.postMessage("voximplantWebsdkGetSourceId","*");const r=i=>{if(i.data&&i.origin===window.location.origin&&i.data.result){if("err"===i.data.result)return n(new Error(i.data.reason));if("ok"===i.data.result&&void 0!==i.data.sourceId){window.removeEventListener("message",r);const o={audio:e,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:screen.width>1920?screen.width:1920,maxHeight:screen.height>1080?screen.height:1080,chromeMediaSourceId:i.data.sourceId},optional:[{googTemporalLayeredScreencast:!0}]}};a.LogManager.get().writeMessage(a.LogCategory.USERMEDIA,"[constraints]",a.LogLevel.INFO,JSON.stringify(o)),navigator.mediaDevices.getUserMedia(o).then((e=>{t(e)}),(e=>{n(e)}))}}};window.addEventListener("message",r)}))}static getRTCStats(e){return new Promise(((t,n)=>{let r=[];e.getStats(null).then((e=>{e.forEach((e=>{"outbound-rtp"!=e.type&&"inbound-rtp"!=e.type||r.push(e)})),t({raw:r,formatted:o.prepareRTCStats(e)})})).catch(n)}))}static prepareRTCStats(e){let t=[];return e.forEach((e=>{"inbound-rtp"===e.type&&e.isRemote?t.push(Object.assign(e,{type:"remote-inbound-rtp"})):"outbound-rtp"===e.type&&e.isRemote?t.push(Object.assign(e,{type:"remote-outbound-rtp"})):t.push(e)})),t}_traceName(){return"Webkit"}}t.Webkit=o},4610:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractCall=t.CallMode=t.CallState=void 0;const i=n(3576),a=n(2282),o=n(1150),s=n(4106),l=n(3385),c=n(9411),d=n(245);var u;!function(e){e[e.ALERTING="ALERTING"]="ALERTING",e[e.PROGRESSING="PROGRESSING"]="PROGRESSING",e[e.CONNECTED="CONNECTED"]="CONNECTED",e[e.UPDATING="UPDATING"]="UPDATING",e[e.STOPPING="STOPPING"]="STOPPING",e[e.ENDED="ENDED"]="ENDED"}(u=t.CallState||(t.CallState={})),function(e){e[e.P2P=0]="P2P",e[e.SERVER=1]="SERVER"}(t.CallMode||(t.CallMode={}));class g extends i.EventTarget{constructor(e){super(),this.remoteMuteState=!0,this.logger=o.LogManager.get().createLogger(o.LogCategory.CALL,"Call ".concat(e))}id(){return this.settings?this.settings.id:"new"}number(){return this.settings.number}displayName(){return this.settings.displayName}getCallDuration(){return Date.now()-this.startTime}headers(){return this.settings.extraHeaders}state(){return this.settings.state}checkCallMode(e){return this.settings.mode==e}hangup(e){if(this.logger.info("hangup()"),this.settings.state==u.CONNECTED||this.settings.state==u.UPDATING||this.settings.state==u.PROGRESSING)d.default.callRemoteFunction(s.RemoteFunction.disconnectCall,this.settings.id,c.AbstractCallManager.cleanHeaders(e));else{if(this.settings.state!=u.ALERTING)throw new Error("WRONG_CALL_STATE");d.default.callRemoteFunction(s.RemoteFunction.rejectCall,this.settings.id,!0,c.AbstractCallManager.cleanHeaders(e))}}mutePlayback(){this.logger.info("mutePlayback()"),this.remoteMuteState=!1,this.getEndpoints().forEach((e=>{e.mediaRenderers.forEach((e=>{e.setVolume(0)}))}))}unmutePlayback(){this.logger.info("unmutePlayback()"),this.remoteMuteState=!0,this.getEndpoints().forEach((e=>{e.mediaRenderers.forEach((e=>{e.setVolume(1)}))}))}restoreRMute(){this.settings.active&&this.getEndpoints().forEach((e=>{e.mediaRenderers.forEach((e=>{e.setVolume(this.remoteMuteState?1:0)}))}))}sendInfo(e,t,n){this.logger.info("sendInfo(".concat(e,", ").concat(JSON.stringify(t),")"));let r,i,a=e.indexOf("/");-1==a?(r="application",i=e):(r=e.substring(0,a),i=e.substring(a+1)),d.default.callRemoteFunction(s.RemoteFunction.sendSIPInfo,this.settings.id,r,i,t,c.AbstractCallManager.cleanHeaders(n))}sendMessage(e){this.logger.info("sendMessage()"),this.sendInfo(l.Constants.ZINGAYA_IM_MIME_TYPE,e,{})}addEventListener(e,t){super.addEventListener(e,t)}on(e,t,n){super.on(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}off(e,t){super.off(e,t)}dispatchEvent(e){this.settings.state!==u.UPDATING||e.name!==a.CallEvents.Updated&&e.name!==a.CallEvents.UpdateFailed||this._setState(u.CONNECTED),super.dispatchEvent(e)}onConnected(e,t){if(this.signalingConnected)return!!this.checkState([u.PROGRESSING,u.ALERTING],"onConnected")&&(this._setState(u.CONNECTED),this.startTime=Date.now(),this.dispatchEvent({name:"Connected",call:this,headers:e}),!0)}onFailed(e,t,n){return this.dispatchEvent({name:"Failed",call:this,headers:n,code:e,reason:t}),this._setState(u.ENDED),!0}_setState(e){const t={call:this,old:this.settings.state,new:e,name:a.CallEvents.StateUpdated};return this.settings.state=e,this.dispatchEvent(t),e}checkState(e,t){if(e)if("string"!=typeof e){let n=!1,r=e;for(let e=0;e<r.length;e++)r[e]==this.settings.state&&(n=!0);if(!n)return this.logger.warning("Received "+t+" in invalid state "+this.settings.state),!1}else if(this.settings.state!=e)return this.logger.warning("Received "+t+" in invalid state "+this.settings.state),!1;return!0}}r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"number",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"displayName",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"headers",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"checkCallMode",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"hangup",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"mutePlayback",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"unmutePlayback",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"restoreRMute",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"sendInfo",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"sendMessage",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"addEventListener",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"on",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"removeEventListener",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"off",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"dispatchEvent",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"onConnected",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"onFailed",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"_setState",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],g.prototype,"checkState",null),t.AbstractCall=g},9411:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractCallManager=void 0;const i=n(3385),a=n(1150),o=n(125),s=n(575),l=n(245),c=n(4610),d=n(2282),u=n(141);class g{constructor(){this.protocolVersion="3",this._h264first=!1,this.iceServers={},this.wsConfMap=new WeakMap,this.confEpManagerMap=new WeakMap,this.endpointManagers=new WeakMap,this._calls={},l.default.addHandler(this),l.default.setRPCHandler(s.RemoteEvent.onICEConfig,((e,t)=>{this.onICEResult(e,!0,t)})),l.default.setRPCHandler(s.RemoteEvent.onICEConfigFailed,(e=>{this.onICEResult(e,!1)})),l.default.setRPCHandler(s.RemoteEvent.handleRejectReinvite,((e,t,n)=>{this.handleRejectReinvite(e,t,n)})),l.default.setRPCHandler(s.RemoteEvent.handleConnectionDisconnected,((e,t,n)=>{this.handleConnectionDisconnected(e,t,n)})),l.default.setRPCHandler(s.RemoteEvent.handleConnectionFailed,((e,t,n,r)=>{this.handleConnectionFailed(e,t,n,r)})),l.default.setRPCHandler(s.RemoteEvent.handleSIPInfo,((e,t,n,r,i)=>{this.handleSIPInfo(e,t,n,r,i)})),l.default.setRPCHandler(s.RemoteEvent.handleSipEvent,(e=>{this.handleSipEvent(e)}))}removeCall(e){delete this._calls[e]}get numCalls(){return this._numCalls}static cleanHeaders(e){let t={};for(let n in e)"X-"!=n.substring(0,2)&&n!=i.Constants.CALL_DATA_HEADER||(t[n]=e[n]);return t}static addCustomDataToHeaders(e){return void 0!==e.customData&&(void 0===e.extraHeaders&&(e.extraHeaders={}),e.extraHeaders["VI-CallData"]=e.customData),e}async handleConnectionFailed(e,t,n,r){let i=this.findCall(e,"handleConnectionFailed");i&&"object"==typeof i&&(await this.removeCall(e),o.Client.getInstance().stopProgressTone(),i.onFailed(t,n,r))}getEndpointManager(e){return this.endpointManagers.get(e)}onICEResult(e,t,n){if(t){let t=n;if(window.__VIIceServer__&&n){const e=/(stun:|turn:)(.*)*:(\d*)(\?transport=)?(tcp|udp)?/gm,r="$1"+window.__VIIceServer__+":$3$4$5";t=n.map((t=>(Array.isArray(t.urls)?t.urls=t.urls.map((t=>t.replace(e,r))):t.urls=t.urls.replace(e,r),t)))}this.iceServers[e]=t,this.logger.info("ice servers ".concat(this.iceServers[e]));const r=this.findCall(e,"onICEResult");r&&(r.peerConnection.setConfiguration?r.peerConnection.setConfiguration(Object.assign(Object.assign({},r.peerConnection.getConfiguration()),{iceServers:t})):this.logger.info("Failed to set ICE config due to RTCPeerConnection doesn't have the setConfiguration method"))}}checkMaximumCallCount(){if(Object.keys(this._calls).length>199)throw new Error("The max calls number limit has been reached.")}handleConnectionDisconnected(e,t,n){let r=this.findCall(e,"handleConnectionDisconnected");r&&(o.Client.getInstance().stopProgressTone(),r.onDisconnected(t,n).then((()=>this.removeCall(e))).catch((t=>{this.logger.error("Can't remove the call ".concat(e,": ").concat(t.message))})))}handleSIPInfo(e,t,n,r,i){let a=this.findCall(e,"handleSIPInfo");a&&a.onInfo(a,t,n,r,i)}handleSipEvent(e){}onSignalingConnected(){}onSignalingClosed(){for(let e in this._calls)this._calls.hasOwnProperty(e)&&(this._calls[e].hangup(),this._calls[e].onFailed(409,"Connection Closed",{}));this._calls={}}onSignalingConnectionFailed(e){}onMediaConnectionFailed(){}handleRejectReinvite(e,t,n){let r=this.findCall(e,"handleReinvite");r&&(r.peerConnection.revertEnablingVideo(),r.dispatchEvent({code:20,call:r}))}async hangupAllCalls(){const e=Object.values(this._calls).map((e=>new Promise((t=>{const n=setTimeout((()=>{this.logger.info("The timeout of disconnected event for the call ".concat(e.id()," has reached.")),this.removeCall(e.id()),e.settings.state=c.CallState.ENDED,t()}),1500);e.on(d.CallEvents.Disconnected,(()=>{clearTimeout(n),t()}),{once:!0}),e.hangup();const r=this.endpointManagers.get(e);null==r||r.getEndpoints().forEach((e=>r.destructEndpoint(e.id)))}))));await Promise.all(e)}patchAudioMixConf(e,t){var n;if(e.settings.isConference&&t){this.logger.info("patchAudioMixConf(): workaround for mixed audio conferences");const t=null===(n=e.peerConnection.getTransceivers())||void 0===n?void 0:n[0].receiver.track;if(t){e.settings.mixedAudioTrackID=t.id;const n=(()=>{const e=document.createElement("audio");return e.autoplay=!0,e.id=t.id,e.style.display="none",e.srcObject=new MediaStream([t]),e})();document.body.appendChild(n),n.play().catch((e=>{this.logger.warning("Can't start audio track: ".concat(t.id,". ").concat(e.message)),o.Client.getInstance().dispatchEvent({name:u.Events.PlaybackError,element:n,error:e})}))}}}}r([a.LogManager.d_trace(a.LogCategory.CALLMANAGER)],g.prototype,"handleConnectionFailed",null),r([a.LogManager.d_trace(a.LogCategory.CALLMANAGER)],g.prototype,"onICEResult",null),r([a.LogManager.d_trace(a.LogCategory.CALLMANAGER)],g.prototype,"handleConnectionDisconnected",null),r([a.LogManager.d_trace(a.LogCategory.CALLEXSERVER)],g.prototype,"handleSIPInfo",null),r([a.LogManager.d_trace(a.LogCategory.CALLMANAGER)],g.prototype,"handleSipEvent",null),r([a.LogManager.d_trace(a.LogCategory.CALLMANAGER)],g.prototype,"onSignalingConnected",null),r([a.LogManager.d_trace(a.LogCategory.CALLMANAGER)],g.prototype,"onSignalingClosed",null),r([a.LogManager.d_trace(a.LogCategory.CALLMANAGER)],g.prototype,"onSignalingConnectionFailed",null),r([a.LogManager.d_trace(a.LogCategory.CALLMANAGER)],g.prototype,"handleRejectReinvite",null),r([a.LogManager.d_trace(a.LogCategory.CALLMANAGER)],g,"addCustomDataToHeaders",null),t.AbstractCallManager=g},3308:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.Call=void 0;const i=n(2282),a=n(3385),o=n(1150),s=n(84),l=n(308),c=n(3869),d=n(4106),u=n(125),g=n(7272),f=n(4610),h=n(2957),p=n(9002),m=n(245),v=n(9699);var y=g.default.AudioDeviceManager,C=g.default.StreamManager;const _=n(8237),S=n(787);class E extends f.AbstractCall{constructor(e,t,n,r){super(e),this._audioSenderTransform=h.Utils.getDefaultStreamTransformer(),this._videoSenderTransform=h.Utils.getDefaultStreamTransformer(),this.signalingConnected=!1,this.settings=r,this.settings.id=e,this.settings.displayName=t,this.settings.mode=f.CallMode.P2P,this.settings.active=!0,this.settings.usedSinkId=null,this.settings.incoming=n,this.settings.state=n?f.CallState.ALERTING:f.CallState.PROGRESSING,u.Client.getInstance().config(),this.settings.audioDirections={sendAudio:!0},this.settings.videoDirections="boolean"==typeof r.video?{sendVideo:r.video,receiveVideo:!0}:r.video,this.settings.hasEarlyMedia=!1,r.audioSenderTransform&&(this._audioSenderTransform=r.audioSenderTransform),r.videoSenderTransform&&(this._videoSenderTransform=r.videoSenderTransform),navigator.mediaDevices.addEventListener("devicechange",this.onDeviceChange.bind(this))}async onDeviceChange(){if(!this)return;const e=y.get(),t=e.getDefaultAudioSettings(),n=[],r=[];(await navigator.mediaDevices.enumerateDevices()).forEach((e=>{let t={id:e.deviceId,name:e.label,group:e.groupId};"audiooutput"===e.kind?r.push(t):"audio"!==e.kind&&"audioinput"!==e.kind||n.push(t)})),this.logger.info("Current audio input devices list: ".concat(JSON.stringify(n))),this.logger.info("Current audio output devices list: ".concat(JSON.stringify(r)));let i=(e,t)=>{var n,r,i;let a=null;return t&&(a=null===(n=e.find((e=>e.id===t)))||void 0===n?void 0:n.id),a||(a=null===(r=e.find((e=>"default"===e.id)))||void 0===r?void 0:r.id),a||(a=null===(i=e[0])||void 0===i?void 0:i.id),a};const a=i(n,t.inputId),o=i(r,t.outputId);this.logger.info("Input device id - ".concat(a," will be active")),this.logger.info("Output device id - ".concat(o," will be active")),await e.setCallAudioSettings(this,{inputId:a,outputId:o}),await e.setDefaultAudioSettings({inputId:a,outputId:o})}get promise(){return this._promise}get peerConnection(){return this._peerConnection}set peerConnection(e){this._peerConnection=e}get stateValue(){return this.settings.state}active(){return this.settings.active}_setActive(e){const t={call:this,old:this.settings.active,new:e,name:i.CallEvents.ActiveUpdated};return this.settings.active=e,this.dispatchEvent(t),this.muteIncomingStreams(e),e}muteIncomingStreams(e){this.getEndpoints().forEach((t=>{t.mediaRenderers.forEach((t=>{t.stream.getTracks().forEach((t=>{t.enabled=e}))}))}))}answer(e,t,n,r){if(this.logger.info("answer(\n        ".concat(JSON.stringify(e),",\n        ").concat(JSON.stringify(t),",\n        ").concat(JSON.stringify(n),",\n        H264first: ").concat(Boolean(r),",\n      )")),void 0!==e&&(void 0!==t&&"object"==typeof t||(t={}),t[a.Constants.CALL_DATA_HEADER]=e),void 0!==n&&(n={sendVideo:u.Client.getInstance().config().videoSupport,receiveVideo:u.Client.getInstance().config().videoSupport}),this.settings.state!=f.CallState.ALERTING)throw new Error("WRONG_CALL_STATE");if(n&&"object"==typeof n){const e={sendVideo:!1,receiveVideo:!0};this._peerConnection.setVideoFlags(Object.assign(Object.assign({},e),n))}this.dispatchEvent({name:"AnswerAccepted",call:this})}decline(e){if(this.logger.info("decline()"),this.settings.state!=f.CallState.ALERTING)throw new Error("WRONG_CALL_STATE");m.default.callRemoteFunction(d.RemoteFunction.rejectCall,this.settings.id,!1,l.CallManager.cleanHeaders(e))}reject(e){if(this.logger.info("reject()"),this.settings.state!=f.CallState.ALERTING)throw new Error("WRONG_CALL_STATE");m.default.callRemoteFunction(d.RemoteFunction.rejectCall,this.settings.id,!0,l.CallManager.cleanHeaders(e))}hangup(e){super.hangup(e),this.logger.info("Call ".concat(this.settings.id," was disconnected by the user")),this._setState(f.CallState.STOPPING),Object.keys(l.CallManager.get().calls).some((e=>e!==this.settings.id))||(this.logger.info("There are no other calls ".concat(JSON.stringify(Object.keys(l.CallManager.get().calls)),", clean local streams")),C.clearUmCache().then((()=>{this.logger.info("Streams from cache were stopped.")})))}sendTone(e){this.logger.info("sendTone(".concat(e,")")),this.settings.active&&this._peerConnection.sendDTMF(e)}isMicrophoneMuted(){const e=this.peerConnection.getMicrophoneState();return this.logger.info("isMicrophoneMuted: ".concat(e)),e}muteMicrophone(){this.logger.info("muteMicrophone()"),this.peerConnection.muteMicrophone(!0)}unmuteMicrophone(){this.logger.info("unmuteMicrophone()"),this.peerConnection.muteMicrophone(!1)}showRemoteVideo(){throw new Error("Deprecated: please use CSS to display each Media Renderer")}setRemoteVideoPosition(e,t){throw new Error("Deprecated: please use CSS to position '#voximplantcontainer' element")}setRemoteVideoSize(e,t){throw new Error("Deprecated: please use CSS to set size of '#voximplantcontainer' element")}setVideoSettings(e,t,n){throw new Error("Deprecated: please use the Hardware interface instead")}getVideoElementId(){throw new Error("Deprecated: please use the Media Renderer interface instead")}onDisconnected(e,t){return new Promise(((n,r)=>{const i=g.default.StreamManager.get()._getScreenSharing(this);if(i&&i.forEach((e=>{g.default.StreamManager.get()._clearScreenSharing(this,e)})),!this.checkState([f.CallState.CONNECTED,f.CallState.ALERTING,f.CallState.PROGRESSING,f.CallState.UPDATING,f.CallState.STOPPING],"onDisconnected"))return r(new Error("Call in the wrong state ".concat(this.state()))),!1;this._setState(f.CallState.ENDED),n(!0),this.dispatchEvent({name:"Disconnected",call:this,headers:e,params:t})}))}onStopRinging(){return!!this.checkState([f.CallState.PROGRESSING,f.CallState.CONNECTED],"onStopRinging")&&(this.dispatchEvent({name:"ProgressToneStop",call:this}),!0)}onRingOut(){return!!this.checkState(f.CallState.PROGRESSING,"onRingOut")&&(this.dispatchEvent({name:"ProgressToneStart",call:this}),!0)}onTransferComplete(){return!!this.checkState(f.CallState.CONNECTED,"onTransferComplete")&&(this.dispatchEvent({name:"TransferComplete",call:this}),!0)}onTransferFailed(){return!!this.checkState(f.CallState.CONNECTED,"onTransferFailed")&&(this.dispatchEvent({name:"TransferFailed",call:this}),!0)}onInfo(e,t,n,r,i){if(e.stateValue==f.CallState.CONNECTED||e.stateValue==f.CallState.PROGRESSING||e.stateValue==f.CallState.ALERTING||e.stateValue==f.CallState.UPDATING){let o=t+"/"+n;if(o==a.Constants.ZINGAYA_IM_MIME_TYPE)this.dispatchEvent({name:"onSendMessage",call:this,text:r});else if(o==a.Constants.P2P_SPD_FRAG_MIME_TYPE){let t=JSON.parse(r);for(let n in t)void 0!==e&&void 0!==e.peerConnection?e.peerConnection.addRemoteCandidate(t[n][1],t[n][0]):this.logger.info("Candidate skipped. Connection not created yet.")}else o===a.Constants.VI_CONF_PARTICIPANT_INFO_ADDED||o===a.Constants.VI_CONF_PARTICIPANT_INFO_REMOVED||o===a.Constants.VI_CONF_PARTICIPANT_INFO_UPDATED||this.dispatchEvent({name:"InfoReceived",call:this,body:r,headers:i,mimeType:o});return!0}this.logger.warning("received handleSIPInfo for call: "+e.id()+" in invalid state: "+e.state())}setActive(e){return this.logger.info("setActive(".concat(e,")")),new Promise(((t,n)=>{e!==this.settings.active?this.settings.state==f.CallState.CONNECTED?(this._setActive(e),this.peerConnection.hold(!e),_.CallPromiseResolver.add(this,{resolve:t,reject:n,dispatchEvent:S.dispatchUpdatedEvent.bind(null,this)})):(S.dispatchUpdatedEvent(this,!1,v.CallFailedUpdateReasons.holdCallInWrongState),n({name:i.CallEvents.UpdateFailed,code:11,call:this})):t(S.dispatchUpdatedEvent(this,!1,v.CallFailedUpdateReasons.sameActiveState(e)))}))}canStartSendingCandidates(){void 0===this._peerConnection&&(this._peerConnection=s.PCFactory.get().peerConnections[this.settings.id]),this._peerConnection.canStartSendingCandidates()}sendVideo(e){if(this.logger.info("sendVideo(".concat(e,")")),"boolean"!=typeof e)return Promise.reject(S.dispatchUpdatedEvent(this,!1,v.CallFailedUpdateReasons.wrongTypeOfArgument(e)));if(!this.active())return Promise.reject(S.dispatchUpdatedEvent(this,!1,v.CallFailedUpdateReasons.mediaOnHold));let t=this.peerConnection?this.peerConnection.getTransceivers().filter((e=>{var t;return"video"===(null===(t=e.sender.track)||void 0===t?void 0:t.kind)})):[];const n=g.default.StreamManager.get()._getScreenSharing(this)||[];return this.peerConnection?e&&n.length?new Promise(((t,r)=>{_.CallPromiseResolver.add(this,{resolve:t,reject:r,dispatchEvent:S.dispatchUpdatedEvent.bind(null,this)}),this.settings.videoDirections.sendVideo||(this.settings.videoDirections.sendVideo=!0);const i=n[0];g.default.StreamManager.get()._clearScreenSharing(this,i).then((()=>g.default.StreamManager.get().getCallStream(this,!0))).then((t=>{let n=t.getVideoTracks();this.peerConnection.replaceSharingToVideo(n[0],"video"),this.settings.videoDirections.sendVideo=e})).catch((e=>{_.CallPromiseResolver.reject(this,e)}))})):!0===this.settings.videoDirections.sendVideo&&e||!1===this.settings.videoDirections.sendVideo&&!e&&!t.length?(this.logger.info("Resolve sendVideo() without enableVideo()"),Promise.resolve({call:this,name:i.CallEvents.Updated,result:!0})):new Promise(((t,n)=>{this.logger.info("Going to call enableVideo(".concat(e,")")),this.settings.videoDirections.sendVideo=e,this.peerConnection.enableVideo(e),_.CallPromiseResolver.add(this,{dispatchEvent:S.dispatchUpdatedEvent.bind(null,this),resolve:t,reject:n})})):Promise.resolve({call:this,name:i.CallEvents.Updated,result:!0})}sendMedia(e,t){return this._setState(f.CallState.UPDATING),null==e&&(e=this.settings.audioDirections.sendAudio),null==t&&(t=this.settings.videoDirections.sendVideo),this.peerConnection.sendMedia(e,t).then((n=>(null!=t&&(this.settings.videoDirections.sendVideo=t),null!=e&&(this.settings.audioDirections.sendAudio=e),n)))}shareScreen(e,t){return void 0===e&&void 0===t||this.logger.warning("The `showLocalView` and `replaceVideo` arguments of the `shareScreen` method are deprecated since v4.6.0. The `shareScreen` method now replaces local and sent video with screen sharing by default, sending video and sharing screen now unavailable.\nTo send both video and screen sharing in a conference, use the `joinAsSharing` method to join as a separate screen sharing member."),this.logger.info("shareScreen()"),this.settings.state!==f.CallState.CONNECTED?Promise.reject(S.dispatchUpdatedEvent(this,!1,"Call is not connected.")):this.active()?new Promise(((e,t)=>{g.default.StreamManager.get()._getScreenSharing(this).length&&(this.logger.warning("Screen sharing already active."),t(new Error("Screen sharing already active."))),c.default.isScreenSharingSupported()?g.default.StreamManager.get()._newScreenSharing(this).then((n=>{if(this.settings.videoDirections.sendVideo){let t=[];n.stream.getTracks().forEach((e=>{"video"===e.kind&&t.push(this.peerConnection.replaceSharingToVideo(e,"sharing"))})),Promise.all(t).then((()=>{this.peerConnection.restoreMute(),e(S.dispatchUpdatedEvent(this,!0))}))}else this.peerConnection.addCustomMedia(n.stream),_.CallPromiseResolver.add(this,{resolve:t=>{this.peerConnection.restoreMute(),g.default.StreamManager.get().isLocalVideoRequested&&g.default.StreamManager.get().updateLocalVideo("sharing"),e(t)},reject:t,dispatchEvent:S.dispatchUpdatedEvent.bind(null,this)})})).catch((e=>{this.logger.warning(e.message),t(e)})):(this.logger.warning("Sorry, this browser does not support screen sharing."),t(new Error("Sorry, this browser does not support screen sharing.")))})):Promise.reject(S.dispatchUpdatedEvent(this,!1,v.CallFailedUpdateReasons.mediaOnHold))}stopSharingScreen(){return this.logger.info("stopSharingScreen()"),this.active()?new Promise(((e,t)=>{const n=g.default.StreamManager.get()._getScreenSharing(this);if(n){let r=n.length;n.forEach((n=>{g.default.StreamManager.get()._clearScreenSharing(this,n).then((()=>{this.settings.videoDirections.sendVideo?(g.default.StreamManager.get().updateCallStream(this),_.CallPromiseResolver.add(this,{resolve:e,reject:t,dispatchEvent:S.dispatchUpdatedEvent.bind(null,this)})):(this.peerConnection.removeCustomMedia(n.stream),_.CallPromiseResolver.add(this,{resolve:t=>{this.settings.videoDirections.sendVideo&&this.settings.simulcast&&this.settings.isConference&&this.peerConnection.getTransceivers().forEach((e=>{if("inactive"!==e.currentDirection&&e.sender.track&&"video"===e.sender.track.kind){const t=h.Utils.buildSimulcastLayers({trackSettings:e.sender.track.getSettings(),trackType:"video",profileName:this.settings.simulcastProfileName});this.peerConnection.setEncodingsParams(e,t)}})),n.stream=void 0,r--,r<=0&&(g.default.StreamManager.get().updateLocalVideo("video"),this.peerConnection.restoreMute(),e(t))},reject:t,dispatchEvent:S.dispatchUpdatedEvent.bind(null,this)}))})).catch((e=>{this.logger.warning(e.message),t(e)}))}))}else this.logger.warning("Sorry, screen sharing not started yet."),t(new Error("Sorry, screen sharing not started yet."))})):Promise.reject(S.dispatchUpdatedEvent(this,!1,v.CallFailedUpdateReasons.mediaOnHold))}getRemoteAudioStreams(){throw new Error("Deprecated: please use the Media Renderer interface of each call instead")}getRemoteVideoStreams(){throw new Error("Deprecated: please use the Media Renderer interface of each call instead")}useAudioOutput(e){throw new Error("Deprecated: please use the Media Renderer interface of each call instead")}getAudioElementId(){throw new Error("Deprecated: please use the Media Renderer interface of each call instead")}runIncomingReInvite(e,t){if(this.settings.state===f.CallState.UPDATING)m.default.callRemoteFunction(d.RemoteFunction.rejectReInvite,this.settings.id,{});else{this._setState(f.CallState.UPDATING);const n=l.CallManager.get().isSDPHasVideo(t);this.peerConnection.handleRemoteOffer(e,t,n).then((()=>{this.peerConnection.restoreMute(),this.peerConnection.restoreVideoSending()}))}}setActiveForce(e){this._setActive(e)}getEndpoints(){return l.CallManager.get().getEndpointManager(this).getEndpoints()}scaleVideoResolutionDownBy(e){const t=[];return this.peerConnection.getTransceivers().forEach((n=>{if(n.currentDirection&&-1!==n.currentDirection.indexOf("send")||n.direction&&-1!==n.direction.indexOf("send")){const r=n.sender.getParameters();-1!=e?r.encodings[0].scaleResolutionDownBy=e:delete r.encodings[0].scaleResolutionDownBy,t.push(n.sender.setParameters(r))}})),Promise.all(t)}get audioSenderTransform(){return this._audioSenderTransform}set audioSenderTransform(e){this._audioSenderTransform=e,this.peerConnection&&this.peerConnection.updateSenderTransformers()}get videoSenderTransform(){return this._videoSenderTransform}set videoSenderTransform(e){this._videoSenderTransform=e,this.peerConnection&&this.peerConnection.updateSenderTransformers()}get audioMediaTrackTransform(){return this._audioMediaTrackTransform}set audioMediaTrackTransform(e){this._audioMediaTrackTransform=e,this.peerConnection&&this.peerConnection.updateSenderTrackTransformers()}get videoMediaTrackTransform(){return this._videoMediaTrackTransform}set videoMediaTrackTransform(e){this._videoMediaTrackTransform=e,this.peerConnection&&this.peerConnection.updateSenderTrackTransformers()}_traceName(){return"Call"}}r([p.debounceDecorator(200)],E.prototype,"onDeviceChange",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"active",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"_setActive",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"answer",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"decline",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"reject",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"hangup",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"sendTone",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"isMicrophoneMuted",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"muteMicrophone",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"unmuteMicrophone",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"showRemoteVideo",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"setRemoteVideoPosition",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"setRemoteVideoSize",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"setVideoSettings",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"getVideoElementId",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"onDisconnected",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"onStopRinging",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"onRingOut",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"onTransferComplete",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"onTransferFailed",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"onInfo",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"setActive",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"canStartSendingCandidates",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"sendVideo",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"shareScreen",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"stopSharingScreen",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"getRemoteAudioStreams",null),r([o.LogManager.d_trace(o.LogCategory.CALL)],E.prototype,"getRemoteVideoStreams",null),r([o.LogManager.d_trace(o.LogCategory.CLIENT)],E.prototype,"useAudioOutput",null),r([o.LogManager.d_trace(o.LogCategory.CLIENT)],E.prototype,"getAudioElementId",null),r([o.LogManager.d_trace(o.LogCategory.CLIENT)],E.prototype,"runIncomingReInvite",null),r([o.LogManager.d_trace(o.LogCategory.CLIENT)],E.prototype,"setActiveForce",null),t.Call=E},6081:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallError=void 0,function(e){e[e.NUMBER_IS_BUSY=486]="NUMBER_IS_BUSY",e[e.TERMINATED=487]="TERMINATED",e[e.INVALID_NUMBER=404]="INVALID_NUMBER",e[e.NUMBER_IS_UNAVAILABLE=480]="NUMBER_IS_UNAVAILABLE",e[e.REJECTED=603]="REJECTED",e[e.INSUFFICIENT_FUNDS=402]="INSUFFICIENT_FUNDS",e[e.ACCESS_DENIED=403]="ACCESS_DENIED",e[e.NOT_CONNECTED_TO_VOXIMPLANT=1003]="NOT_CONNECTED_TO_VOXIMPLANT",e[e.NOT_AUTHORIZED=1004]="NOT_AUTHORIZED",e[e.HTTP_NOT_SECURE=1008]="HTTP_NOT_SECURE"}(t.CallError||(t.CallError={}))},2282:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallEvents=void 0,function(e){e[e.Connected="Connected"]="Connected",e[e.Disconnected="Disconnected"]="Disconnected",e[e.Failed="Failed"]="Failed",e[e.ProgressToneStart="ProgressToneStart"]="ProgressToneStart",e[e.ProgressToneStop="ProgressToneStop"]="ProgressToneStop",e[e.MessageReceived="onSendMessage"]="MessageReceived",e[e.InfoReceived="InfoReceived"]="InfoReceived",e[e.TransferComplete="TransferComplete"]="TransferComplete",e[e.TransferFailed="TransferFailed"]="TransferFailed",e[e.ICETimeout="ICETimeout"]="ICETimeout",e[e.RTCStatsReceived="RTCStatsReceived"]="RTCStatsReceived",e[e.CallStatsReceived="CallStatsReceived"]="CallStatsReceived",e[e.MediaElementCreated="MediaElementCreated"]="MediaElementCreated",e[e.MediaElementRemoved="MediaElementRemoved"]="MediaElementRemoved",e[e.ICECompleted="ICECompleted"]="ICECompleted",e[e.Updated="Updated"]="Updated",e[e.PendingUpdate="PendingUpdate"]="PendingUpdate",e[e.UpdateFailed="UpdateFailed"]="UpdateFailed",e[e.LocalVideoStreamAdded="LocalVideoStreamAdded"]="LocalVideoStreamAdded",e[e.EndpointAdded="EndpointAdded"]="EndpointAdded",e[e.EndpointRemoved="EndpointRemoved"]="EndpointRemoved",e[e.StateUpdated="StateUpdated"]="StateUpdated",e[e.ActiveUpdated="ActiveUpdated"]="ActiveUpdated",e[e.QualityIssueCodecMismatch="QualityIssueCodecMismatch"]="QualityIssueCodecMismatch",e[e.QualityIssueHighMediaLatency="QualityIssueHighMediaLatency"]="QualityIssueHighMediaLatency",e[e.QualityIssueICEDisconnected="QualityIssueICEDisconnected"]="QualityIssueICEDisconnected",e[e.QualityIssueLocalVideoDegradation="QualityIssueLocalVideoDegradation"]="QualityIssueLocalVideoDegradation",e[e.QualityIssueLowBandwidth="QualityIssueLowBandwidth"]="QualityIssueLowBandwidth",e[e.QualityIssueNoAudioSignal="QualityIssueNoAudioSignal"]="QualityIssueNoAudioSignal",e[e.QualityIssuePacketLoss="QualityIssuePacketLoss"]="QualityIssuePacketLoss",e[e.SharingStopped="SharingStopped"]="SharingStopped"}(t.CallEvents||(t.CallEvents={}))},304:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.CallExMedia=void 0;const i=n(3308),a=n(1150),o=n(4106),s=n(3385),l=n(125),c=n(7272),d=n(245),u=n(3421);class g extends i.Call{answer(e,t,n,r){return super.answer(e,t,n,r),void 0!==e&&(void 0!==t&&"object"==typeof t||(t={}),t[s.Constants.CALL_DATA_HEADER]=e),this._answerHeaders=t,l.Client.getInstance().config(),new Promise(((e,t)=>{this._answerPromise=e,this.settings.videoDirections={sendVideo:"object"==typeof n&&n.sendVideo,receiveVideo:!0},r&&(this.rearangeCodecs=u.CodecSorterHelpers.H264Sorter);const i=()=>{c.default.StreamManager.get().getCallStream(this).then((e=>{this._peerConnection.fastAddCustomMedia(e),this._peerConnection.getLocalAnswer().then((e=>{const t={mids:this.peerConnection.getMidKinds()};d.default.callRemoteFunction(o.RemoteFunction.acceptCall,this.id(),this._answerHeaders,e.sdp,t),this._peerConnection._fixFFSoundBug(),this._answerPromise()})).catch((()=>{}))})).catch((e=>t(e)))};this._peerConnection?i():setTimeout(i,600)}))}_traceName(){return"CallExMedia"}}r([a.LogManager.d_trace(a.LogCategory.CALL)],g.prototype,"answer",null),t.CallExMedia=g},8748:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.CallExServer=void 0;const i=n(3308),a=n(308),o=n(1150),s=n(4106),l=n(4610),c=n(245);class d extends i.Call{constructor(e,t,n,r){super(e,t,n,r),this.settings.mode=l.CallMode.SERVER}answer(e,t){super.answer(e,t);const n={mids:this.peerConnection.getMidKinds()};c.default.callRemoteFunction(s.RemoteFunction.acceptCall,this.settings.id,a.CallManager.cleanHeaders(t),n)}_traceName(){return"CallExServer"}}r([o.LogManager.d_trace(o.LogCategory.CALLEXSERVER)],d.prototype,"answer",null),t.CallExServer=d},9699:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallFailedUpdateReasons=void 0,t.CallFailedUpdateReasons={mediaOnHold:"Operation can't be performed due to the call isn't active",holdCallInWrongState:"Trying to make the call inactive in the wrong state",sameActiveState:e=>"Call already "+(e?"active":"inactive"),wrongTypeOfArgument:e=>"An argument for the sendVideo() method must be boolean type. Has received ".concat(e)}},308:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.CallManager=void 0;const i=n(2282),a=n(2957),o=n(3947),s=n(3385),l=n(1150),c=n(84),d=n(125),u=n(6746),g=n(4106),f=n(575),h=n(3421),p=n(8879),m=n(7272);var v=m.default.StreamManager;const y=n(6278),C=n(9411),_=n(304),S=n(8748),E=n(9574),b=n(4610),M=n(9553),w=n(245);class R extends C.AbstractCallManager{constructor(){super(),this.logger=l.LogManager.get().createLogger(l.LogCategory.SIGNALING,this._traceName()),w.default.setRPCHandler(f.RemoteEvent.handleIncomingConnection,((e,t,n,r,i,a)=>{this.handleIncomingConnection(e,t,n,r,i,a)})),w.default.setRPCHandler(f.RemoteEvent.handleConnectionConnected,((e,t,n,r,i)=>{this.handleConnectionConnected(e,t,n,i)})),w.default.setRPCHandler(f.RemoteEvent.handleRingOut,(e=>{this.handleRingOut(e)})),w.default.setRPCHandler(f.RemoteEvent.stopRinging,(e=>{this.stopRinging(e)})),w.default.setRPCHandler(f.RemoteEvent.handleTransferStarted,(e=>{this.handleTransferStarted(e)})),w.default.setRPCHandler(f.RemoteEvent.handleTransferComplete,(e=>{this.handleTransferComplete(e)})),w.default.setRPCHandler(f.RemoteEvent.handleTransferFailed,(e=>{this.handleTransferFailed(e)})),w.default.setRPCHandler(f.RemoteEvent.handleReInvite,((e,t,n,r)=>{this.handleInReinvite(e,t,n,r)})),w.default.setRPCHandler(f.RemoteEvent.handleAcceptReinvite,((e,t,n,r)=>{this.handleReinvite(e,t,n,r)})),w.default.setRPCHandler(f.RemoteEvent.startEarlyMedia,((e,t,n,r)=>{const i=this.findCall(e,"startEarlyMedia");i&&(i.settings.hasEarlyMedia=!0),this.startEarlyMedia(e,t,n,r)}))}static get(){return void 0===this.inst&&(this.inst=new R),this.inst}get calls(){return this._calls}getCallInstance(e,t,n,r){const i="3"==this.protocolVersion?new _.CallExMedia(e,t,n,r):new S.CallExServer(e,t,n,r);return this.endpointManagers.set(i,new E.default(i)),this._calls[e]=i,i}call(e){this.checkMaximumCallCount();let t={number:null,video:{sendVideo:!1,receiveVideo:!0},isAudio:!1,customData:null,extraHeaders:{},wiredLocal:!0,wiredRemote:!0,H264first:this._h264first,VP8first:!1,forceActive:!1,extraParams:{}},n=a.Utils.mixObjectToLeft(t,e);n=R.addCustomDataToHeaders(n);let r=a.Utils.generateUUID();if(this._calls[r])throw this.logger.error("Call "+r+" already exists"),new Error("Internal error");const i=this.getCallInstance(r,o.Authenticator.get().displayName,!1,n);n.H264first&&(i.rearangeCodecs=h.CodecSorterHelpers.H264Sorter);let l=!1;return i.settings.active=!0,Object.keys(this._calls).length>1&&!n.forceActive&&(i.setActiveForce(!1),l=!0),void 0===n.extraHeaders[s.Constants.DIRECT_CALL_HEADER]&&"2"==this.protocolVersion?w.default.callRemoteFunction(g.RemoteFunction.createCall,-1,n.number,n.video,r,null,null,n.extraHeaders,n.extraParams):c.PCFactory.get().setupDirectPC(r,u.PeerConnectionMode.P2P,e.video,l).then((e=>{if(i.peerConnection=c.PCFactory.get().peerConnections[r],this.checkCallStateAndClosePC(i))return;const t={mids:i.peerConnection.getMidKinds()};w.default.callRemoteFunction(g.RemoteFunction.createCall,-1,n.number,!0,r,null,null,n.extraHeaders,"",e.sdp,t)})).catch((e=>{this.handleConnectionFailed(i.id(),403,"Media access denied",{})})),i.sendVideo(n.video.sendVideo||!1).catch((()=>{})),i}callConference(e){var t;this.checkMaximumCallCount();let n={number:null,video:{sendVideo:!1,receiveVideo:!1},customData:null,extraHeaders:{},wiredLocal:!0,wiredRemote:!0,H264first:this._h264first,VP8first:!1,forceActive:!1,extraParams:{},simulcast:!1},r=a.Utils.mixObjectToLeft(n,e);r=R.addCustomDataToHeaders(r);let i=a.Utils.generateUUID();if(this._calls[i])throw this.logger.error("Call "+i+" already exists"),new Error("Internal error");const s=this.getCallInstance(i,o.Authenticator.get().displayName,!1,r);r.H264first&&(s.rearangeCodecs=h.CodecSorterHelpers.H264ConfSorter);let l=!1;s.settings.active=!0,s.settings.isConference=!0,Object.keys(this._calls).length>1&&!r.forceActive&&(s.setActiveForce(!1),l=!0);const d=c.PCFactory.get();if(null===(t=d.iceConfig)||void 0===t?void 0:t.iceServers){const e=d.iceConfig.iceServers.filter((e=>{let{credential:t}=e;return!t}));d.iceConfig.iceServers=e}return d.setupDirectPC(i,u.PeerConnectionMode.CONFERENCE,e.video,l).then((e=>{if(s.peerConnection=c.PCFactory.get().peerConnections[i],this.checkCallStateAndClosePC(s))return;const t={mids:s.peerConnection.getMidKinds()};w.default.callRemoteFunction(g.RemoteFunction.callConference,-1,r.number,!0,i,null,null,r.extraHeaders,"",e.sdp,t)})).catch((e=>{this.handleConnectionFailed(s.id(),403,"Media access denied",{})})),s.sendVideo(r.video.sendVideo||!1),this.confEpManagerMap.set(s,new M.ConferenceEndpointManager(s)),this.wsConfMap.set(s,new y.ConfSignaling(s)),s}getConferenceEndpointManager(e){return this.confEpManagerMap.get(e)}getConfSignaling(e){return this.wsConfMap.get(e)}isSDPHasVideo(e){const t=e.indexOf("m=video");if(-1===t)return!1;const n=e.indexOf("a=sendrecv",t),r=e.indexOf("a=sendonly",t),i=e.indexOf("m=",t);return-1!==n&&(n<i||-1===i)||-1!==r&&(r<i||-1===i)}transferCall(e,t){let n=[e,t];for(let r=0;r<n.length;r++){let e=this._calls[n[r].id()];if(!e)return void this.logger.error("trying to transfer unknown call "+e.id());if(e.stateValue!=b.CallState.CONNECTED)return void this.logger.error("trying to transfer call "+e.id()+" in state "+e.state())}w.default.callRemoteFunction(g.RemoteFunction.transferCall,e.id(),t.id())}async removeCall(e){var t;const n=this._calls[e];if(super.removeCall(e),(null==n?void 0:n.settings.isConference)&&(null==n?void 0:n.settings.mixedAudioTrackID)){const e=document.getElementById(n.settings.mixedAudioTrackID);e&&(e.src=null,e.srcObject=null,null===(t=e.parentElement)||void 0===t||t.removeChild(e))}await m.default.StreamManager.get().updateLocalVideo(),Object.values(this._calls).some((e=>e.state()!==b.CallState.ENDED))||v.clearUmCache().then((()=>{this.logger.info("Streams from cache were stopped.")}))}setProtocolVersion(e){this.protocolVersion=e}useVideoSource(e){let t=Object.keys(this._calls).length;return new Promise(((n,r)=>{for(let i in this._calls)if(this._calls.hasOwnProperty(i)){const a=this._calls[i];m.default.CameraManager.get().setCallVideoSettings(a,Object.assign(Object.assign({},m.default.CameraManager.get().getCallVideoSettings(a)),{cameraId:e})),m.default.StreamManager.get().updateCallStream(a).then((e=>{t--,t<=0&&n()}),(e=>{r(e)}))}}))}setVideoSettings(e){let t=Object.keys(this._calls).length;return new Promise(((n,r)=>{0===t&&n();for(let i in this._calls)if(this._calls.hasOwnProperty(i)){const a=this._calls[i];m.default.CameraManager.get().setCallVideoSettings(a,m.default.CameraManager.legacyParamConverter(e)).then((e=>{t--,t<=0&&n()}),(e=>{r(e)}))}}))}useAudioSource(e){let t=Object.keys(this._calls).length;return new Promise(((n,r)=>{0===t&&n();for(let i in this._calls)if(this._calls.hasOwnProperty(i)){const a=this._calls[i];m.default.AudioDeviceManager.get().setCallAudioSettings(a,Object.assign(Object.assign({},m.default.AudioDeviceManager.get().getCallAudioSettings(a)),{inputId:e})).then((e=>{t--,t<=0&&n()}),(e=>{r(e)}))}}))}handleIncomingConnection(e,t,n,r,i,a){if(this._calls[e])throw this.logger.error("Call "+e+" already exists"),new Error("Internal error");const o=p.SDPMuggle.detectDirections(i).some((e=>"video"===e.type&&("sendonly"===e.direction||"sendrecv"===e.direction)));let s={number:t,extraHeaders:r,video:o,isAudio:!o,wiredLocal:!0,wiredRemote:!0,forceActive:!1};const l=this.getCallInstance(e,n,!0,s);this._h264first&&(l.rearangeCodecs=h.CodecSorterHelpers.H264Sorter);let u=!1;l.settings.active=!0,Object.keys(this._calls).length>1&&(l.setActiveForce(!1),u=!0);let g=[];p.SDPMuggle.checkIsVimsSectionExistsIn(i)&&!window.__VIIceServer__||(g=this.iceServers[e],p.SDPMuggle.checkIsVimsSectionExistsIn(i)||(l.settings.isDirect=!0));let f=i;l.settings.incoming&&(f=p.SDPMuggle.fixSetupSection(f)),l.settings.isDirect&&(f=p.SDPMuggle.recoverVideoFmts(f,this.logger)),c.PCFactory.get().incomeDirectPC(e,{receiveVideo:!0,sendVideo:!0},f,u,g).then((a=>{l.peerConnection=a,d.Client.getInstance().onIncomingCall(e,t,n,r,this.isSDPHasVideo(i))})),l.sysOn("AnswerAccepted",(e=>{!l.settings.isConference&&a&&this.endpointManagers.get(l).setMIDInfo(a)})),this.handleConfirmingIncomingConnection(l)}handleConfirmingIncomingConnection(e){e.settings.state!==b.CallState.ENDED&&w.default.callRemoteFunction(g.RemoteFunction.confirmIncomingConnection,e.id())}handleRingOut(e){let t=this.findCall(e,"handleRingOut");t&&(d.Client.getInstance().playProgressTone(!0),t.onRingOut(),t.canStartSendingCandidates())}async handleConnectionConnected(e,t,n,r){let i=this.findCall(e,"handleConnectionConnected");if(i){this.logger.info("handleConnectionConnected(), received SDP: \n".concat(n)),!i.settings.isConference&&r&&this.endpointManagers.get(i).setMIDInfo(r),this.patchAudioMixConf(i,r),n&&!p.SDPMuggle.checkIsVimsSectionExistsIn(n)&&(i.settings.isDirect=!0),i.signalingConnected=!0,i.canStartSendingCandidates(),i.onConnected(t,n);try{await m.default.StreamManager.get().updateLocalVideo()}catch(e){this.logger.error("handleConnectionConnected(): updating local video has failed ".concat(JSON.stringify(e)))}if(void 0!==n&&n.length>0){const e=n.indexOf("m=video");if(-1!==e){const t=n.indexOf("a=sendrecv",e),r=n.indexOf("a=sendonly",e),i=n.indexOf("a=recvonly",e),a=n.indexOf("a=inactive",e);-1===t&&-1===r&&-1===i&&-1===a&&(n+="a=inactive\r\n")}i.settings.hasEarlyMedia||i.peerConnection.processRemoteAnswer(t,n)}}}startEarlyMedia(e,t,n,r){let i=this.findCall(e,"startEarlyMedia");i&&(this.logger.info("startEarlyMedia(), received SDP: \n".concat(n)),i.settings.hasEarlyMedia=!0,void 0!==n&&(i.peerConnection.processRemoteAnswer(t,n),!i.settings.isConference&&r)&&this.endpointManagers.get(i).setMIDInfo(r),d.Client.getInstance().stopProgressTone())}stopRinging(e){let t=this.findCall(e,"stopRinging");t&&(t.canStartSendingCandidates(),d.Client.getInstance().stopProgressTone(),t.onStopRinging())}handleTransferStarted(e){}handleTransferComplete(e){let t=this.findCall(e,"handleTransferComplete");t&&t.onTransferComplete()}handleTransferFailed(e){let t=this.findCall(e,"handleTransferFailed");t&&t.onTransferFailed()}async handleReinvite(e,t,n,r){let i=this.findCall(e,"handleReinvite");if(!i)return;!i.settings.isConference&&r&&i.active()&&await this.getEndpointManager(i).setMIDInfo(r);const a=this.isSDPHasVideo(n);let o=n;i.settings.isDirect&&(o=p.SDPMuggle.recoverVideoFmts(o,this.logger)),i.peerConnection.handleReinvite(t,o,a)}handleInReinvite(e,t,n,r){let a=this.findCall(e,"handleReinvite");a&&(this.logger.info("handleInReinvite(), received SDP: \n".concat(n)),this.getEndpointManager(a).setMIDInfo(r).then((()=>{let e=n;a.settings.incoming&&(e=p.SDPMuggle.fixSetupSection(e)),a.settings.isDirect&&(e=p.SDPMuggle.recoverVideoFmts(e,this.logger)),a.runIncomingReInvite(t,e),a.dispatchEvent({name:i.CallEvents.PendingUpdate,result:!0,call:a})})))}checkCallStateAndClosePC(e){const t=e.state();return(t===b.CallState.STOPPING||t===b.CallState.ENDED)&&(this.logger.info("Call ".concat(e.id()," in ").concat(t," state. PeerConnection will be closed.")),e.peerConnection.close(),!0)}findCall(e,t){let n=this._calls[e];return""===e&&(n=this._calls[Object.keys(this._calls)[0]]),void 0===n?null:n}recalculateNumCalls(){this._numCalls=0;for(let e in this._calls)this._calls.hasOwnProperty(e)&&this._numCalls++}icerestart(){Object.values(this._calls).forEach((e=>{let t=e.peerConnection.impl.iceConnectionState;this.logger.info("ICE connection state is ".concat(t," for call ").concat(e.id())),e.settings.isDirect&&e.settings.incoming||"stable"!==e.peerConnection.impl.signalingState||"failed"!==t&&"disconnected"!==t||e.peerConnection._runReinvite(!0)}))}_traceName(){return"CallManager"}}r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"call",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"removeCall",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"useVideoSource",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"setVideoSettings",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"useAudioSource",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"handleIncomingConnection",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"handleRingOut",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"handleConnectionConnected",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"stopRinging",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"handleTransferStarted",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"handleTransferComplete",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"handleTransferFailed",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"handleReinvite",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"handleInReinvite",null),r([l.LogManager.d_trace(l.LogCategory.CALLMANAGER)],R.prototype,"findCall",null),t.CallManager=R},8237:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallPromiseResolver=void 0;class n{static add(e,t){const n=this.callPromisesMap.get(e)||[];this.callPromisesMap.set(e,n.concat(t)),this.setCallPromiseTimeout(e,t)}static remove(e){const t=this.callPromisesMap.get(e);if(t){this.callPromisesMap.delete(e);for(const e of t)this.clearCallPromiseTimeout(e)}}static resolve(e){var t;const n=this.callPromisesMap.get(e);if(n){for(const e of n){const n=null===(t=e.dispatchEvent)||void 0===t?void 0:t.call(e,!0);e.resolve(n)}this.remove(e)}}static reject(e,t){var n;const r=this.callPromisesMap.get(e);if(r){for(const e of r){const r=null===(n=e.dispatchEvent)||void 0===n?void 0:n.call(e,!1,t);e.reject(r)}this.remove(e)}}static setCallPromiseTimeout(e,t){const n=setTimeout((()=>{this.reject(e,"Handling a reinvite has timed out")}),3e3);this.timeoutIdMap.set(t,n)}static clearCallPromiseTimeout(e){const t=this.timeoutIdMap.get(e);t&&(clearTimeout(t),this.timeoutIdMap.delete(e))}}t.CallPromiseResolver=n,n.callPromisesMap=new WeakMap,n.timeoutIdMap=new WeakMap},9144:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Endpoint=void 0;const r=n(3576),i=n(8597),a=n(1150);class o extends r.EventTarget{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];super(),this.isDefault=e,this.sipUri="",this.displayName="",this.userName="",this.wasAdded=!1,this.mediaRenderers=[],this.addDefaultEventListener(i.EndpointEvents.RemoteMediaAdded,(e=>{e.mediaRenderer.renderDefault()})),this.logger=a.LogManager.get().createLogger(a.LogCategory.ENDPOINT,"".concat(this._traceName()," ").concat(this.id))}enableAll(){this.mediaRenderers.map((e=>e.enable()))}disableAll(){this.mediaRenderers.map((e=>e.disable()))}useAudioOutput(e){this.logger.info("useAudioOutput(".concat(e,")")),this.mediaRenderers&&this.mediaRenderers.forEach((t=>t.useAudioOutput(e)))}updateInfo(e){this.place=e.place,this.sipUri=e.sipURI,this.displayName=e.displayName,this.userName=e.username}_traceName(){return"Endpoint"}}t.Endpoint=o},8597:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndpointEvents=void 0,function(e){e.InfoUpdated="InfoUpdated",e.Removed="Removed",e.RemoteMediaAdded="RemoteMediaAdded",e.RemoteMediaRemoved="RemoteMediaRemoved",e.RemoteMediaUpdated="RemoteMediaUpdated",e.RTCStatsReceived="RTCStatsReceived",e.VoiceStart="VoiceStart",e.VoiceEnd="VoiceEnd",e.MediaRenderDisabled="MediaRenderDisabled",e.MediaRenderEnabled="MediaRenderEnabled"}(t.EndpointEvents||(t.EndpointEvents={}))},9574:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=n(9144),a=n(3992),o=n(2282),s=n(8597),l=n(7222),c=n(8707),d=n(308);class u{constructor(e){this.call=e,this.transceiverBucket=[],this.displayRules={new:{audio:["default"],video:["default"]}},this.transceiverEndpointHashMap=new WeakMap,this.activeEndpoints=new Map,this.activeMR=new Map,this.mutex=new a.TaskMutex,this.endpointInfo={endpoints:{},reinviteCauses:[]}}setDisplayRules(e){throw new Error("not implemented")}setMIDInfo(e){const t=JSON.parse(e);t.endpoints[""]&&(t.endpoints[this.call.id()]=t.endpoints[""],delete t.endpoints[""]);const n=this.diffEndpoints(t);this.endpointInfo=t;for(let r in n.added)n.added.hasOwnProperty(r)&&this.constructEndpoint(r,n.added[r]);for(let r in n.removed)n.removed.hasOwnProperty(r)&&this.destructEndpoint(r);for(let r in n.changed)if(n.changed.hasOwnProperty(r)){const e=this.activeEndpoints.get(r);for(let i in n.changed[r].midDiff.added)n.changed[r].midDiff.added.hasOwnProperty(i)&&this.transceiverBucket.forEach((n=>{n.mid===i&&this.createNewMR(n,e,t.endpoints[r].mids)}));for(let i in n.changed[r].midDiff.changed)if(n.changed[r].midDiff.changed.hasOwnProperty(i)){const a=this.activeMR.get(i);a?(a.kind=n.changed[r].midDiff.changed[i],e.dispatchEvent({name:s.EndpointEvents.RemoteMediaUpdated,call:this.call,endpoint:e,mediaRenderer:a})):this.transceiverBucket.forEach((n=>{n.mid===i&&this.createNewMR(n,e,t.endpoints[r].mids)}))}for(let i in n.changed[r].midDiff.removed)if(n.changed[r].midDiff.removed.hasOwnProperty(i)){let n=t.endpoints[r].mids;if("ViewerCall"===this.call._traceName()&&Object.keys(n).find((e=>"audio"===n[e]))){const t=this.activeMR.get(i);t&&(t.kind="audio",t.stream.getVideoTracks().forEach((e=>{e.stop(),t.stream.removeTrack(e)})),this.activeMR.delete(i)),e.dispatchEvent({name:s.EndpointEvents.RemoteMediaUpdated,call:this.call,endpoint:e,mediaRenderer:t})}else{const t=this.activeMR.get(i);this.removeMediaRenderer(e,t),this.activeMR.delete(i)}}}}updateTransceiver(e){if(!e.mid)return;this.transceiverBucket.find((t=>t===e))||this.transceiverBucket.push(e);const t=this.searchEndpointByMid(e.mid);t&&this.createNewMR(e,t.endpoint,t.mids)}getEndpointInfo(){return this.endpointInfo}destructEndpoint(e){const t=this.activeEndpoints.get(e);t&&(t.mediaRenderers.forEach((e=>{t.dispatchEvent({name:s.EndpointEvents.RemoteMediaRemoved,call:this.call,endpoint:t,mediaRenderer:e}),e.mids.forEach((e=>this.activeMR.delete(e))),e.clear()})),this.activeEndpoints.delete(e),t.dispatchEvent({name:s.EndpointEvents.Removed,call:this.call,endpoint:t}),this.call.dispatchEvent({name:o.CallEvents.EndpointRemoved,call:this.call,endpoint:t}))}makeMids(e){const t={};return c.default.parse(e).media.forEach(((e,n)=>{const r=e.attr.find((e=>"mid"===e.name));t[r?r.value:n]=e.descr.media})),{endpoints:{[this.call.id()]:{place:0,type:"call",mids:t}},reinviteCauses:[]}}constructEndpoint(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new i.Endpoint(n);let a;r.id=e,a=this.call.settings.isConference?this.getDataForConference({id:e,place:t.place}):{id:e,place:t.place,displayName:this.call.settings.displayName,sipURI:"",username:""},r.updateInfo(a),this.activeEndpoints.set(e,r),this.call.dispatchEvent({name:o.CallEvents.EndpointAdded,endpoint:r,call:this.call}),this.transceiverBucket.forEach((e=>this.updateTransceiver(e)))}getDataForConference(e){let{id:t,place:n}=e;const r={id:t,place:n,displayName:"",sipURI:"",username:""},i=this.endpointInfo.reinviteCauses.find((e=>e.id===t));return i&&(i.displayName&&(r.displayName=i.displayName),i.sipURI&&(r.sipURI=i.sipURI),i.username&&(r.username=i.username)),r}diffMids(e,t){const n={added:{},changed:{},removed:{},unchanged:{}};let r=!1;for(let i in t)t.hasOwnProperty(i)&&(e.hasOwnProperty(i)?e[i]!==t[i]?(n.changed[i]=t[i],r=!0):n.unchanged[i]=t[i]:(n.added[i]=t[i],r=!0));for(let i in e)e.hasOwnProperty(i)&&!t.hasOwnProperty(i)&&(n.removed[i]=e[i],r=!0);return{result:r,diff:n}}searchEndpointByMid(e){for(let t in this.endpointInfo.endpoints)if(this.endpointInfo.endpoints.hasOwnProperty(t)&&this.endpointInfo.endpoints[t].mids[e])return{endpoint:this.activeEndpoints.get(t),mids:this.endpointInfo.endpoints[t].mids};return null}getEndpoints(){return Array.from(this.activeEndpoints.values())}diffEndpoints(e){const t={added:{},changed:{},removed:{},unchanged:{}};for(let n in e.endpoints)if(e.endpoints.hasOwnProperty(n))if(this.endpointInfo.endpoints.hasOwnProperty(n)){const r=this.diffMids(this.endpointInfo.endpoints[n].mids,e.endpoints[n].mids);r.result?t.changed[n]=Object.assign(Object.assign({},e.endpoints[n]),{midDiff:r.diff}):t.unchanged[n]=e.endpoints[n]}else t.added[n]=e.endpoints[n];for(let n in this.endpointInfo.endpoints)this.endpointInfo.endpoints.hasOwnProperty(n)&&!e.endpoints.hasOwnProperty(n)&&(t.removed[n]=this.endpointInfo.endpoints[n]);return t}createNewMR(e,t,n){if(!e.mid)return;this.transceiverEndpointHashMap.set(e,t);const r=this.mediaRendererFabric(e,n);r&&(r.conferenceEpManagerUpdateState=()=>{var e;null===(e=d.CallManager.get().getConferenceEndpointManager(this.call))||void 0===e||e.updateState()},r.conferenceEpManagerUpdateRenderSize=()=>{var e;null===(e=d.CallManager.get().getConferenceEndpointManager(this.call))||void 0===e||e.updateRenderSize()},this.activeMR.set(e.mid,r),t.mediaRenderers.push(r),t.dispatchEvent({name:s.EndpointEvents.RemoteMediaAdded,call:this.call,endpoint:t,mediaRenderer:r}))}mediaRendererFabric(e,t){if(e.mid){if(this.activeMR.has(e.mid))return null;if("ViewerCall"!==this.call._traceName())return new l.MediaRenderer({stream:new MediaStream([e.receiver.track]),kind:t[e.mid],transceivers:[e],mids:[e.mid]});{const n=Object.keys(t),r=this.transceiverBucket.filter((e=>n.includes(e.mid)));if("audio"===t[e.mid])return n.length>r.length?null:2===n.length&&n.length===r.length?new l.MediaRenderer({stream:new MediaStream([r[0].receiver.track,r[1].receiver.track]),kind:"video",transceivers:[r[0],r[1]],mids:[r[0].mid,r[1].mid]}):new l.MediaRenderer({stream:new MediaStream([e.receiver.track]),kind:"audio",transceivers:[e],mids:[e.mid]});if("video"===t[e.mid]||"sharing"===t[e.mid]){let i=n.find((e=>"audio"===t[e])),a=this.activeMR.get(i),o=r.find((e=>e.mid===i));if(a&&a.element instanceof HTMLVideoElement)return a.kind="video",a.stream.addTrack(e.receiver.track),a.element.srcObject=a.stream,a.transceivers=[e,o],a.mids=[e.mid,o.mid],a;if(a){let n=this.transceiverEndpointHashMap.get(e);this.removeMediaRenderer(n,a);const r=new l.MediaRenderer({stream:new MediaStream([o.receiver.track,e.receiver.track]),kind:t[e.mid],transceivers:[e],mids:[e.mid]});return this.activeMR.set(i,r),r}if(!a&&r.find((e=>e.mid===i))){const n=new l.MediaRenderer({stream:new MediaStream([o.receiver.track,e.receiver.track]),kind:t[e.mid],transceivers:[e],mids:[e.mid]});return this.activeMR.set(i,n),n}return new l.MediaRenderer({stream:new MediaStream([e.receiver.track]),kind:t[e.mid],transceivers:[e],mids:[e.mid]})}}}}removeMediaRenderer(e,t){e.mediaRenderers=e.mediaRenderers.filter((e=>e.id!==t.id)),e.dispatchEvent({name:s.EndpointEvents.RemoteMediaRemoved,call:this.call,endpoint:e,mediaRenderer:t}),t.clear()}}r([a.queueDecorator()],u.prototype,"setDisplayRules",null),r([a.queueDecorator()],u.prototype,"setMIDInfo",null),r([a.queueDecorator()],u.prototype,"updateTransceiver",null),t.default=u},6497:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.SharingCall=void 0;const i=n(1150),a=n(3947),o=n(3902),s=n(4610),l=n(3385),c=n(245),d=n(4106),u=n(125),g=n(575),f=n(3869);class h extends s.AbstractCall{constructor(e,t){super(e),this.signalingConnected=!1,this.settings={id:e,displayName:a.Authenticator.get().displayName,mode:s.CallMode.P2P,number:t.number,video:{sendVideo:!0,receiveVideo:!1},customData:null,extraHeaders:t.extraHeaders,wiredLocal:!0,wiredRemote:!0,H264first:!0,VP8first:!1,forceActive:!1,usedSinkId:null,extraParams:{},active:!0,state:s.CallState.PROGRESSING,audioDirections:{sendAudio:t.audioDirections.sendAudio},videoDirections:{sendVideo:!0,receiveVideo:!1},hasEarlyMedia:!1,incoming:!1,simulcast:!1,isConference:!0,simulcastProfileName:"general"};const n=new RTCPeerConnection;let r;n?this.getNewScreenSharing().then((t=>{if(null!==t.stream){const i=t.stream.getVideoTracks()[0],a=t.stream.getAudioTracks()[0]||"audio";n.addTransceiver(a,{direction:"sendonly",streams:[t.stream]}),n.addTransceiver(i,{direction:"sendonly",streams:[t.stream]}),n.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!1}).then((e=>(r=e,n.setLocalDescription(e)))).then((()=>{this.peerConnection=n,c.default.callRemoteFunction(d.RemoteFunction.callConference,-1,this.settings.number,!0,e,null,null,this.settings.extraHeaders,"",r.sdp,{mids:{0:"audio",1:"sharing"}})})).catch((()=>{this.handleConnectionFailed(1001,"",{})}))}else this.handleConnectionFailed(1001,"",{})})):this.handleConnectionFailed(1001,"",{}),this.setHandlers()}getEndpoints(){return[]}getNewScreenSharing(){return new Promise(((e,t)=>{f.default.getScreenMedia(this.settings.audioDirections.sendAudio).then((t=>{const n={stream:t,renderer:null};t.getTracks().forEach((e=>{e.onended=()=>{this.hangup()}})),e(n)})).catch((e=>{this.logger.error("Media access denied: ".concat(e?e.message||e.name||e:"unknown")),t(e)}))}))}setHandlers(){c.default.setRPCHandler(g.RemoteEvent.handleRejectReinvite,((e,t,n)=>{e===this.settings.id&&this.handleRejectReinvite()})),c.default.setRPCHandler(g.RemoteEvent.handleConnectionDisconnected,((e,t,n)=>{e===this.settings.id&&this.handleConnectionDisconnected(e,t,n)})),c.default.setRPCHandler(g.RemoteEvent.handleConnectionFailed,((e,t,n,r)=>{e===this.settings.id&&this.handleConnectionFailed(t,n,r)})),c.default.setRPCHandler(g.RemoteEvent.handleSIPInfo,((e,t,n,r,i)=>{e===this.settings.id&&this.handleSIPInfo(t,n,r,i)})),c.default.setRPCHandler(g.RemoteEvent.handleConnectionConnected,((e,t,n)=>{e===this.settings.id&&this.handleConnectionConnected(t,n)})),c.default.setRPCHandler(g.RemoteEvent.handleReInvite,((e,t,n)=>{e===this.settings.id&&this.handleInReinvite(t,n)})),c.default.setRPCHandler(g.RemoteEvent.handleAcceptReinvite,((e,t,n)=>{e===this.settings.id&&this.handleReinvite(n)}))}handleRejectReinvite(){this.dispatchEvent({code:20,call:this})}handleInReinvite(e,t){return new Promise((n=>{this.logger.info("handleInReinvite(), received SDP: \n".concat(t));const r=new RTCSessionDescription({sdp:t,type:"offer"});this.peerConnection.setRemoteDescription(r).then((()=>this.peerConnection.createAnswer())).then((t=>{this.peerConnection.setLocalDescription(t).then((()=>{this.restoreRMute(),c.default.callRemoteFunction(d.RemoteFunction.acceptReInvite,this.settings.id,e,t.sdp,{mids:{0:"audio",1:"sharing"}}),n()}))})).catch((e=>{this.dispatchEvent({name:"SDP",origin:"handleInReinvite",sdp:this.peerConnection.localDescription,description:"answer_reject: ".concat(e.message)}),this.logger.error(e),n()}))}))}handleConnectionConnected(e,t){return new Promise((n=>{this.logger.info("handleConnectionConnected(), received SDP: \n".concat(t)),void 0!==t&&"have-local-offer"===this.peerConnection.signalingState?(this.signalingConnected=!0,this.onConnected(e,t),this.processRemoteAnswer(t).then((()=>n())).catch((e=>{this.logger.error(e),n()}))):(this.logger.error("handleConnectionConnected: Wrong connection state ".concat(this.peerConnection.signalingState," or empty SDP")),n())}))}handleConnectionDisconnected(e,t,n){u.Client.getInstance().stopProgressTone(),this.peerConnection.getTransceivers().forEach((e=>{const t=e.sender.track;e.sender.replaceTrack(null).then((()=>{t&&(t.onended=null,t.onmute=null,t.stop()),e.direction="inactive"}))})),this.onDisconnected(t,n).catch((t=>{this.logger.error("Can't remove the call ".concat(e,": ").concat(t.message))}))}handleSIPInfo(e,t,n,r){this.onInfo(this,e,t,n,r)}handleReinvite(e){return new Promise((t=>{this.logger.info("handleReinvite(), received SDP: \n".concat(e)),this.processRemoteAnswer(e).then((()=>t())).catch((e=>{this.logger.error(e),t()}))}))}handleConnectionFailed(e,t,n){u.Client.getInstance().stopProgressTone(),this.onFailed(e,t,n)}onDisconnected(e,t){return new Promise(((n,r)=>{this._setState(s.CallState.ENDED),this.dispatchEvent({name:"Disconnected",call:this,headers:e,params:t}),n(!0)}))}onInfo(e,t,n,r,i){return t+"/"+n==l.Constants.ZINGAYA_IM_MIME_TYPE?this.dispatchEvent({name:"onSendMessage",call:this,text:r}):this.dispatchEvent({name:"InfoReceived",call:this,body:r,headers:i,mimeType:t+"/"+n}),!0}processRemoteAnswer(e){return new Promise(((t,n)=>{if(void 0!==e&&e.length>0){let r={sdp:e,type:o.RTCSdpType.answer};this.peerConnection.setRemoteDescription(r).then((()=>{this.restoreRMute(),t()})).catch((e=>{this.dispatchEvent({name:"SDP",origin:"_processRemoteAnswer",sdp:this.peerConnection.localDescription,description:"answer_reject: ".concat(e.message)}),n(e)}))}else n()}))}_traceName(){return"ViewerCall"}}r([i.LogManager.d_trace(i.LogCategory.CALL)],h.prototype,"handleConnectionFailed",null),r([i.LogManager.d_trace(i.LogCategory.CALL)],h.prototype,"onDisconnected",null),t.SharingCall=h},4211:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6497),i=n(2957),a=n(4610),o=n(2282),s=n(1150);class l{constructor(){this.calls=new Map,this.logger=s.LogManager.get().createLogger(s.LogCategory.SIGNALING,"SharingCallManager")}static get(){var e;return null!==(e=this.inst)&&void 0!==e||(this.inst=new l),this.inst}findCall(e){return this.calls.get(e)}call(e){const t=i.Utils.generateUUID(),n=new r.SharingCall(t,e);return this.calls.set(t,n),n}removeCall(e){this.calls.delete(e)}async hangupAllCalls(){const e=Array.from(this.calls.values()).map((e=>new Promise((t=>{const n=setTimeout((()=>{this.logger.info("The timeout of disconnected event for the call ".concat(e.id()," has reached.")),this.removeCall(e.id()),e.settings.state=a.CallState.ENDED,t()}),1500);e.on(o.CallEvents.Disconnected,(()=>{clearTimeout(n),t()}),{once:!0}),e.hangup()}))));await Promise.all(e)}}t.default=l},8582:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ViewerCall=void 0;const i=n(1150),a=n(3947),o=n(9774),s=n(3902),l=n(4610),c=n(3385);class d extends l.AbstractCall{constructor(e,t){super(e),this.signalingConnected=!1,this.settings={id:e,displayName:a.Authenticator.get().displayName,mode:l.CallMode.P2P,number:t.number,video:{sendVideo:!1,receiveVideo:!0},customData:null,extraHeaders:t.extraHeaders,wiredLocal:!0,wiredRemote:!0,H264first:!0,VP8first:!1,forceActive:!1,usedSinkId:null,extraParams:{},active:!0,state:l.CallState.PROGRESSING,audioDirections:{sendAudio:!1},videoDirections:{sendVideo:!1,receiveVideo:!0},hasEarlyMedia:!1,incoming:!1,simulcast:!1,isConference:!0,simulcastProfileName:"general"}}getEndpoints(){return o.ViewerManager.get().getEndpointManager(this).getEndpoints()}onDisconnected(e,t){return new Promise(((n,r)=>{this._setState(l.CallState.ENDED);const i=o.ViewerManager.get().getEndpointManager(this);i.getEndpoints().forEach((e=>{i.destructEndpoint(e.id)})),this.dispatchEvent({name:"Disconnected",call:this,headers:e,params:t}),n(!0)}))}onInfo(e,t,n,r,i){return t+"/"+n==c.Constants.ZINGAYA_IM_MIME_TYPE?this.dispatchEvent({name:"onSendMessage",call:this,text:r}):this.dispatchEvent({name:"InfoReceived",call:this,body:r,headers:i,mimeType:t+"/"+n}),!0}processRemoteAnswer(e){return new Promise(((t,n)=>{if(void 0!==e&&e.length>0){let r={sdp:e,type:s.RTCSdpType.answer};this.peerConnection.setRemoteDescription(r).then((()=>{this.restoreRMute(),t()})).catch((e=>{this.dispatchEvent({name:"SDP",origin:"_processRemoteAnswer",sdp:this.peerConnection.localDescription,description:"answer_reject: ".concat(e.message)}),n(e)}))}else n()}))}_traceName(){return"ViewerCall"}}r([i.LogManager.d_trace(i.LogCategory.CALL)],d.prototype,"onDisconnected",null),t.ViewerCall=d},9774:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ViewerManager=void 0;const i=n(1150),a=n(2957),o=n(4106),s=n(575),l=n(9411),c=n(8582),d=n(9574),u=n(3992),g=n(245),f=n(9553),h=n(6278);class p extends l.AbstractCallManager{constructor(){super(),this.peerConnectionManagers=new WeakMap,this.mutex=new u.TaskMutex,this.logger=i.LogManager.get().createLogger(i.LogCategory.SIGNALING,this._traceName()),g.default.setRPCHandler(s.RemoteEvent.handleConnectionConnected,((e,t,n,r,i)=>{this.handleConnectionConnected(e,t,n,i)})),g.default.setRPCHandler(s.RemoteEvent.handleReInvite,((e,t,n,r)=>{this.handleInReinvite(e,t,n,r)})),g.default.setRPCHandler(s.RemoteEvent.handleAcceptReinvite,((e,t,n)=>{this.handleReinvite(e,t,n)})),g.default.setRPCHandler(s.RemoteEvent.startEarlyMedia,((e,t,n)=>{this.startEarlyMedia(e,t,n)}))}static get(){return void 0===this.inst&&(this.inst=new p),this.inst}get calls(){return this._calls}joinAsViewer(e){let t=a.Utils.generateUUID();if(this._calls[t])throw this.logger.error("Call "+t+" already exists"),new Error("Internal error");const n=new c.ViewerCall(t,e);this._calls[t]=n;const r=p.get().calls[t],i=new RTCPeerConnection;let s;return i.addEventListener("track",(e=>this.onAddTrack(e,n))),i?(i.addTransceiver("audio",{direction:"recvonly"}),i.addTransceiver("video",{direction:"recvonly"}),i.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then((e=>(s=e,i.setLocalDescription(e)))).then((()=>{n.peerConnection=i,this.endpointManagers.set(n,new d.default(n)),g.default.callRemoteFunction(o.RemoteFunction.callConference,-1,n.settings.number,!0,t,null,null,n.settings.extraHeaders,"",s.sdp)})).catch((()=>{p.get().handleConnectionFailed(r.settings.id,1001,"",{})}))):p.get().handleConnectionFailed(r.settings.id,1001,"",{}),this.confEpManagerMap.set(n,new f.ConferenceEndpointManager(n)),this.wsConfMap.set(n,new h.ConfSignaling(n)),n}getConferenceEndpointManager(e){return this.confEpManagerMap.get(e)}getConfSignaling(e){return this.wsConfMap.get(e)}_traceName(){return"ViewerManager"}findCall(e,t){let n=this._calls[e];return""===e&&(n=this._calls[Object.keys(this._calls)[0]]),void 0===n?null:n}handleConnectionConnected(e,t,n,r){return new Promise((i=>{let a=this.findCall(e,"handleConnectionConnected");a?(this.logger.info("handleConnectionConnected(), received SDP: \n".concat(n)),this.patchAudioMixConf(a,r),void 0!==n&&"have-local-offer"===a.peerConnection.signalingState?(a.signalingConnected=!0,a.onConnected(t,n),a.processRemoteAnswer(n).then((()=>i())).catch((e=>{this.logger.error(e),i()}))):(this.logger.error("handleConnectionConnected: Wrong connection state ".concat(a.peerConnection.signalingState," or empty SDP")),i())):i()}))}startEarlyMedia(e,t,n){return new Promise((t=>{let r=this.findCall(e,"startEarlyMedia");r?(this.logger.info("startEarlyMedia(), received SDP: \n".concat(n)),void 0!==n&&"have-local-offer"===r.peerConnection.signalingState?(r.settings.hasEarlyMedia=!0,r.processRemoteAnswer(n).then((()=>t())).catch((e=>{this.logger.error(e),t()}))):(this.logger.error("handleConnectionConnected: Wrong connection state ".concat(r.peerConnection.signalingState," or empty SDP")),t())):t()}))}handleReinvite(e,t,n){return new Promise((t=>{let r=this.findCall(e,"handleReinvite");r?(this.logger.info("handleReinvite(), received SDP: \n".concat(n)),r.processRemoteAnswer(n).then((()=>t())).catch((e=>{this.logger.error(e),t()}))):t()}))}handleInReinvite(e,t,n,r){return new Promise((i=>{const a=this.findCall(e,"handleInReinvite");a?(this.logger.info("handleInReinvite(), received SDP: \n".concat(n)),this.getEndpointManager(a).setMIDInfo(r).then((()=>{const e=new RTCSessionDescription({sdp:n,type:"offer"});return a.peerConnection.setRemoteDescription(e)})).then((()=>a.peerConnection.createAnswer())).then((e=>{a.peerConnection.setLocalDescription(e).then((()=>{a.restoreRMute(),g.default.callRemoteFunction(o.RemoteFunction.acceptReInvite,a.settings.id,t,e.sdp),i()}))})).catch((e=>{a.dispatchEvent({name:"SDP",origin:"handleInReinvite",sdp:a.peerConnection.localDescription,description:"answer_reject: ".concat(e.message)}),this.logger.error(e),i()}))):i()}))}onAddTrack(e,t){if(t){const n=p.get().getEndpointManager(t);n&&n.updateTransceiver(e.transceiver)}}}r([i.LogManager.d_trace(i.LogCategory.CALLMANAGER)],p.prototype,"findCall",null),r([u.queueDecorator()],p.prototype,"handleConnectionConnected",null),r([u.queueDecorator()],p.prototype,"startEarlyMedia",null),r([u.queueDecorator()],p.prototype,"handleReinvite",null),r([u.queueDecorator()],p.prototype,"handleInReinvite",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],p.prototype,"onAddTrack",null),t.ViewerManager=p},787:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchUpdatedEvent=void 0;const r=n(2282);t.dispatchUpdatedEvent=(e,t,n)=>{var i;const a=Object.assign({name:r.CallEvents.Updated,result:t,call:e},n&&{reason:n});return null===(i=null==e?void 0:e.dispatchEvent)||void 0===i||i.call(e,a),a}},125:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;const i=n(7998),a=n(141),o=n(2957),s=n(3947),l=n(3869),c=n(1150),d=n(84),u=n(308),g=n(3576),f=n(4106),h=n(575),p=n(6230),m=n(209),v=n(7272),y=n(9091),C=n(2089),_=n(304),S=n(8582),E=n(9774),b=n(245),M=n(6081),w=n(4211),R=n(4007),L=n(8879),T=n(164),I=n(4893);class P extends g.EventTarget{constructor(){if(super(),this._connected=!1,this.progressToneScript={US:"440@-19,480@-19;*(2/4/1+2)",RU:"425@-19;*(1/3/1)"},this.playingNow=!1,this.serversList=[],this.level=100,this.micRequired=!1,this.videoConstraints=null,this.progressToneCountry="US",this.progressTone=!0,this.enableTrace=!1,this.showDebugInfo=!1,this.showWarnings=!1,this.RTCsupported=!1,this._deviceEnumAPI=!1,this._h264first=!1,this._VP8first=!1,this.limitVCodecs=void 0,this.limitACodecs=void 0,this._alreadyInitialized=!1,P.instance)throw new Error("Error - use Voximplant.getInstance()");P.instance=this,this._promises={},l.default.init(),d.PCFactory.get().requireMedia=!1,this.voxCallManager=u.CallManager.get(),this.voxViewerManager=E.ViewerManager.get(),this.setLogLevelAll(c.LogLevel.NONE),b.default.setRPCHandler(h.RemoteEvent.onPCStats,((e,t)=>{d.PCFactory.get().getPeerConnect(e)&&this.dispatchEvent({name:"NetStatsReceived",stats:t})})),this.logger=c.LogManager.get().createLogger(c.LogCategory.CLIENT,this._traceName()),this._defaultSinkId=null,this.loginState=T.LoginState.LOGGED_OFF}get version(){return"4.6.3-2641"}static getInstance(){return void 0===P.instance&&(P.instance=new P),P.instance}playProgressTone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(!e||e&&this.progressTone)&&null!==this.progressToneScript[this.progressToneCountry]&&(this.playingNow||this.playToneScript(this.progressToneScript[this.progressToneCountry]),this.playingNow=!0)}stopProgressTone(){this.playingNow&&(this.stopPlayback(),this.playingNow=!1)}onIncomingCall(e,t,n,r,i){this.dispatchEvent({name:a.Events.IncomingCall,call:u.CallManager.get().calls[e],headers:r,video:i})}get alreadyInitialized(){return this._alreadyInitialized}init(e){return new Promise((async(t,n)=>{this.alreadyInitialized&&n(new Error("WebSDK already initialized")),this._alreadyInitialized=!0,this._config=void 0!==e?e:{},void 0!==this._config.progressToneCountry&&(this.progressToneCountry=this._config.progressToneCountry),!0!==this._config.progressTone&&(this.progressTone=!1),void 0!==this._config.serverIp&&(this.serverIp=this._config.serverIp),void 0!==this._config.enableTrace&&(this.enableTrace=this._config.enableTrace),void 0!==this._config.showDebugInfo&&(this.showDebugInfo=this._config.showDebugInfo),!1!==this._config.showWarnings&&(this.showWarnings=!0),"string"==typeof this._config.videoContainerId&&(this.remoteVideoContainerId=this._config.videoContainerId),"string"==typeof this._config.remoteVideoContainerId&&(this.remoteVideoContainerId=this._config.remoteVideoContainerId),"string"==typeof this._config.localVideoContainerId&&(this.localVideoContainerId=this._config.localVideoContainerId),!1!==this._config.micRequired&&(this.micRequired=!0),void 0!==this._config.videoSupport?this.videoSupport=this._config.videoSupport:this.videoSupport=!1,void 0===this._config.queueType&&(this._config.queueType=i.QueueTypes.ACD),void 0!==this._config.H264first&&(this._h264first=this._config.H264first,u.CallManager.get()._h264first=this._h264first),void 0!==this._config.VP8first&&(this._VP8first=this._config.VP8first);const r=Number(this._config.rtcStatsCollectionInterval);if(isNaN(r)?u.CallManager.get().rtcStatsCollectionInterval=I.DEFAULT_COLLECT_INTERVAL:u.CallManager.get().rtcStatsCollectionInterval=r>0?Math.max(o.Utils.floorTo(r,500),I.MIN_COLLECT_INTERVAL):0,void 0!==P.getInstance().config().experiments&&void 0!==P.getInstance().config().experiments.rtcStatsInquiryInterval?u.CallManager.get().rtcStatsInquiryInterval=P.getInstance().config().experiments.rtcStatsInquiryInterval:u.CallManager.get().rtcStatsInquiryInterval=500,!this._config.protocolVersion||"2"!==this._config.protocolVersion&&"3"!==this._config.protocolVersion?this._callProtocolVersion="3":(this._callProtocolVersion=this._config.protocolVersion,u.CallManager.get().setProtocolVersion(this._callProtocolVersion)),this._config.prettyPrint&&c.LogManager.get().setPrettyPrint(this._config.prettyPrint),this.showWarnings&&this.setLogLevelAll(c.LogLevel.WARNING),this.showDebugInfo&&this.setLogLevelAll(c.LogLevel.INFO),this.enableTrace&&this.setLogLevelAll(c.LogLevel.TRACE),this.logger.info("SDK version: ".concat(this.version)),this.logger.info("init(".concat(JSON.stringify(this._config),")")),!window.isSecureContext){const e="getUserMedia() and other APIs required for the access to the user media devices are not available on insecure origins. You need to switch your application to a secure origin, such as HTTPS.";throw this.logger.error(e),Error(e)}if(this._config.experiments&&this._config.experiments.ignorewebrtc)this.RTCsupported=!0;else if("undefined"!=typeof webkitRTCPeerConnection||void 0!==this.mozRTCPeerConnection||"undefined"!=typeof RTCPeerConnection||"undefined"!=typeof RTCIceGatherer)if("undefined"!=typeof mozRTCPeerConnection)try{new mozRTCPeerConnection({iceServers:[]}),this.RTCsupported=!0}catch(e){}else this.RTCsupported=!0;if(!this.RTCsupported)throw n(new Error("NO_WEBRTC_SUPPORT")),new Error("NO_WEBRTC_SUPPORT");var l;if(void 0!==this._config.videoConstraints){this.videoConstraints=this._config.videoConstraints;const e=v.default.CameraManager.legacyParamConverter(this._config.videoConstraints);try{await v.default.CameraManager.get().setDefaultVideoSettings(e)}catch(t){n(new Error("WebSDK haven't be able to set ".concat(JSON.stringify(e)," as the default video settings")))}}null!=window.location.href.match(/^file\:\/{3}.*$/g)&&void 0!==console.error&&this.showWarnings&&console.error("WebRTC requires application to be loaded from a web server"),this.voxAuth=s.Authenticator.get(),this.voxAuth.setHandler({onLoginSuccessful:(e,t)=>{this.loginState=T.LoginState.LOGGED_IN;const n={name:a.Events.AuthResult,displayName:e,result:!0,tokens:t};this._resolvePromise("login",n),this.dispatchEvent(n)},onLoginFailed:e=>{this.loginState=T.LoginState.LOGGED_OFF;const t={name:a.Events.AuthResult,code:e,result:!1};this._rejectPromise("login",t),this.dispatchEvent(t)},onSecondStageInitiated:()=>{const e={name:a.Events.AuthResult,code:301,result:!1};this._rejectPromise("login",e),this.dispatchEvent(e)},onOneTimeKeyGenerated:e=>{const t={name:a.Events.AuthResult,key:e,code:302,result:!1};this._resolvePromise("loginkey",t),this.dispatchEvent(t)},onRefreshTokenFailed:e=>{const t={name:a.Events.RefreshTokenResult,code:e,result:!1};this.dispatchEvent(t)},onRefreshTokenSuccess:e=>{const t={name:a.Events.RefreshTokenResult,tokens:e,result:!0};this.dispatchEvent(t)}}),b.default.addHandler(this),b.default.setRPCHandler(h.RemoteEvent.sipRegisterSuccessful,((e,t)=>{this.dispatchEvent({name:"SIPRegistrationSuccessful",id:e,sipuri:t})})),b.default.setRPCHandler(h.RemoteEvent.onACDStatus,((e,t,n,r)=>{y.default.onStatusUpdated(t,n,r)})),b.default.setRPCHandler(h.RemoteEvent.SQMessagingStatusUpdated,((e,t,n,r)=>{C.default.onStatusUpdated(t,n,r)})),b.default.setRPCHandler(h.RemoteEvent.onSQStatusError,((e,t,n,r)=>{C.default.onError(t,n,r),y.default.onError(t,n,r)})),b.default.setRPCHandler(h.RemoteEvent.sipRegisterFailed,((e,t,n,r)=>{this.dispatchEvent({name:"SIPRegistrationFailed",id:e,sipuri:t,status:n,reason:r})})),b.default.setRPCHandler(h.RemoteEvent.unregisterPushTokenResult,(e=>{p.PushService.updatePromiseResult(e)})),b.default.setRPCHandler(h.RemoteEvent.registerPushTokenResult,(e=>{p.PushService.updatePromiseResult(e)})),l=setInterval((()=>{"undefined"!=typeof document&&(clearInterval(l),this.dispatchEvent({name:a.Events.SDKReady,version:this.version}),t({name:a.Events.SDKReady,version:this.version}))}),100)}))}getErrorCall(e,t,n,r){const i="viewer"===e?new S.ViewerCall(o.Utils.generateUUID(),t):new _.CallExMedia(o.Utils.generateUUID(),s.Authenticator.get().displayName,!1,t);return setTimeout((()=>{i.onFailed(n,r,{})}),500),i}isHttps(){return"https:"===window.location.protocol||"localhost"===window.location.hostname||window.location.href.includes("127.0.0.1")}call(e,t,n,r){void 0===t&&void 0===n&&void 0===r||this.logger.warning("useVideo, customData, extraHeaders are deprecated since 4.6.0. Please use the same parameter in the CallSettings instead."),this.logger.info("call(".concat(JSON.stringify(e),", ").concat(JSON.stringify(t),")"));let i={H264first:this._h264first,VP8first:this._VP8first};switch("string"==typeof e||"number"==typeof e?("object"==typeof t&&(t.receiveVideo=!0),i={number:e,video:t,customData:n,extraHeaders:r}):("object"==typeof e.video&&(e.video.receiveVideo=!0),i=e),typeof i.video){case"boolean":i.isAudio=!i.video,i.video={sendVideo:i.video,receiveVideo:!0};break;case"object":i.isAudio=!i.video.receiveVideo&&!i.video.sendVideo;break;case"undefined":i.isAudio=!0,i.video={sendVideo:!1,receiveVideo:!0}}if(!this.isHttps())return this.getErrorCall("call",i,M.CallError.HTTP_NOT_SECURE,"Sorry, your connection to this site is not secure, so the WebRTC call is prohibited. Please, use https:// instead");try{return o.Utils.checkCA(),this.voxCallManager.call(i)}catch(e){return this.getErrorCall("call",i,+e.code,e.message)}}callConference(e,t,n,r){void 0===t&&void 0===n&&void 0===r||this.logger.warning("useVideo, customData, extraHeaders are deprecated since 4.6.0. Please use the same parameter in the CallSettings instead."),this.logger.info("callConference(callSettings: ".concat(JSON.stringify(e),", useVideo: ").concat(JSON.stringify(t),")"));let i={H264first:this._h264first,VP8first:this._VP8first};switch("string"==typeof e||"number"==typeof e?("object"==typeof t&&(t.receiveVideo=!0),i={number:e,video:t,customData:n,extraHeaders:r}):("object"==typeof e.video&&(e.video.receiveVideo=!0),i=e),typeof i.video){case"boolean":i.video={sendVideo:i.video,receiveVideo:!0};break;case"undefined":i.video={sendVideo:!1,receiveVideo:!0}}if(i.isConference=!0,!this.isHttps())return this.getErrorCall("conf",i,M.CallError.HTTP_NOT_SECURE,"Sorry, your connection to this site is not secure, so the WebRTC call is prohibited. Please, use https:// instead");try{return o.Utils.checkCA(),this.voxCallManager.callConference(i)}catch(e){return console.error(e),this.getErrorCall("conf",i,+e.code,e.message)}}joinAsSharing(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;this.logger.info("joinAsSharing(".concat(e,")"));let r={number:e,audioDirections:{sendAudio:t},extraHeaders:n};if(!this.isHttps())return this.getErrorCall("sharing",r,M.CallError.HTTP_NOT_SECURE,"Sorry, your connection to this site is not secure, so the WebRTC call is prohibited. Please, use https:// instead");try{return o.Utils.checkCA(),w.default.get().call(r)}catch(e){return this.getErrorCall("call",r,+e.code,e.message)}}joinAsViewer(e,t){this.logger.info("joinAsViewer(".concat(e,")"));let n={number:e,extraHeaders:t};if(!this.isHttps())return this.getErrorCall("viewer",n,M.CallError.HTTP_NOT_SECURE,"Sorry, your connection to this site is not secure, so the WebRTC call is prohibited. Please, use https:// instead");try{return o.Utils.checkCA(),this.voxViewerManager.joinAsViewer(n)}catch(e){return this.getErrorCall("viewer",n,+e.code,e.message)}}config(){return this._config}async connect(){return void 0===this._config&&this.logger.warning("Please, run Voximplant init before connect."),b.default.connect(this._config.queueType,this._config.serverIp)}async disconnect(){this.logger.info("disconnect()"),this.checkConnection(),await Promise.all([w.default.get().hangupAllCalls(),E.ViewerManager.get().hangupAllCalls(),u.CallManager.get().hangupAllCalls()]),await b.default.disconnect(),this.loginState=T.LoginState.LOGGED_OFF,v.default.StreamManager.get().clear(),b.default.removeRPCHandler(h.RemoteEvent.onCallRemoteFunctionError),b.default.removeRPCHandler(h.RemoteEvent.handleError)}setOperatorACDStatus(e){return this.logger.info("setOperatorACDStatus(".concat(e,")")),y.default.setStatus(e)}setOperatorSQMessagingStatus(e){if(this._config.queueType==i.QueueTypes.SmartQueue)return this.logger.info("setOperatorSQMessagingStatus (".concat(e,")")),C.default.setStatus(e);Promise.reject("This function only enabled in SmartQueue. You must set QueueType to QueueTypes.SmartQueue in the ClientConfig")}getOperatorACDStatus(){return y.default.getStatus()}getOperatorSQMessagingStatus(){return C.default.getStatus()}login(e,t,n){return this.logger.info("login(".concat(e,", ").concat(t?"***":void 0,", {receiveCalls: ").concat(n&&n.receiveCalls,"})")),this.loginState=T.LoginState.LOGGING_IN,new Promise(((r,i)=>{this._promises.login={resolve:r,reject:i},n=void 0!==n?n:{},this.checkConnection(),this._config.experiments&&this._config.experiments.mediaServer&&(n.mediaServer=this._config.experiments.mediaServer),this.voxAuth.basicLogin(e,t,n)}))}loginWithCode(e,t,n){return this.loginState=T.LoginState.LOGGING_IN,new Promise(((r,i)=>{this._promises.login={resolve:r,reject:i},n=void 0!==n?n:{},n=Object.assign(Object.assign({},n),{serverPresenceControl:!1}),this.checkConnection(),this.voxAuth.loginStage2(e,t,n)}))}loginWithToken(e,t,n){return this.logger.info("loginWithToken(".concat(e,", '***', {receiveCalls: ").concat(n&&n.receiveCalls,"})")),this.loginState=T.LoginState.LOGGING_IN,new Promise(((r,i)=>{this._promises.login={resolve:r,reject:i},n=void 0!==n?n:{},(n=Object.assign(Object.assign({},n),{serverPresenceControl:!1})).accessToken=t,this.checkConnection(),this.voxAuth.tokenLogin(e,n)}))}tokenRefresh(e,t,n){return this.logger.info("tokenRefresh(".concat(e,")")),new Promise(((r,i)=>{const o=e=>{e.result?r(e):i(e),this.off(a.Events.RefreshTokenResult,o)};this.on(a.Events.RefreshTokenResult,o),this.voxAuth.tokenRefresh(e,t,n)}))}requestOneTimeLoginKey(e){return new Promise(((t,n)=>{this._promises.loginkey={resolve:t,reject:n},this.checkConnection(),this.voxAuth.generateOneTimeKey(e)}))}loginWithOneTimeKey(e,t,n){return this.logger.info("loginWithOneTimeKey(".concat(e,", '***' , {receiveCalls: ").concat(n&&n.receiveCalls,"})")),this.loginState=T.LoginState.LOGGING_IN,new Promise(((r,i)=>{this._promises.login={resolve:r,reject:i},n=void 0!==n?n:{},n=Object.assign(Object.assign({},n),{serverPresenceControl:!1}),this.checkConnection(),this.voxAuth.loginUsingOneTimeKey(e,t,n)}))}connected(){return this._connected}showLocalVideo(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return void 0===t&&void 0===n||this.logger.warning("showLocalVideo: mirror and detachCamera parameters are deprecated! And will not lead to desired behaviour."),this.logger.info("showLocalVideo(".concat(e,", ").concat(t,", ").concat(n,")")),e?v.default.StreamManager.get().showLocalVideo():v.default.StreamManager.get().hideLocalVideo()}setLocalVideoPosition(e,t){throw new Error("Deprecated: please use CSS to position '#voximplantlocalvideo' element")}setLocalVideoSize(e,t){throw new Error("Deprecated: please use CSS to set size of '#voximplantlocalvideo' element")}setVideoSettings(e,t,n){v.default.CameraManager.get().setDefaultVideoSettings(v.default.CameraManager.legacyParamConverter(e)),u.CallManager.get().setVideoSettings(e).then((()=>{t&&t(null)}),(e=>{n&&n(null)}))}setVideoBandwidth(e){this.logger.info("setVideoBandwidth(".concat(e,")")),this.checkConnection(),d.PCFactory.get().setBandwidthParams(e),b.default.callRemoteFunction(f.RemoteFunction.setDesiredVideoBandwidth,e)}playToneScript(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.logger.info("playToneScript('***', ".concat(t,")")),o.Utils.playToneScript(e,t)}stopPlayback(){this.logger.info("stopPlayback()"),o.Utils.stopPlayback()&&this.dispatchEvent({name:a.Events.PlaybackFinished})}volume(e){throw new Error("Deprecated: please use the Media Renderer interface of each call instead")}audioSources(){throw Error("Deprecated: please use Hardware module to manipulate devices")}videoSources(){throw Error("Deprecated: please use Hardware module to manipulate devices")}audioOutputs(){throw Error("Deprecated: please use Hardware module to manipulate devices")}useAudioSource(e,t,n){const r=v.default.AudioDeviceManager.get().getDefaultAudioSettings();return v.default.AudioDeviceManager.get().setDefaultAudioSettings(Object.assign(Object.assign({},r),{inputId:e})),new Promise(((r,i)=>u.CallManager.get().useAudioSource(e).then((()=>{t&&t(null),r(null)}),(e=>{n&&n(e),i(e)}))))}useVideoSource(e,t,n){const r=v.default.CameraManager.get().getDefaultVideoSettings();return v.default.CameraManager.get().setDefaultVideoSettings(Object.assign(Object.assign({},r),{cameraId:e})),new Promise(((r,i)=>u.CallManager.get().useVideoSource(e).then((()=>{t&&t(null),r(null)}),(e=>{n&&n(e),i(e)}))))}useAudioOutput(e){return new Promise(((t,n)=>{"chrome"!==l.default.getWSVendor(!0)&&n(new Error("Unsupported browser. Only Google Chrome 49 and above.")),this._defaultSinkId=e,t()}))}attachRecordingDevice(e,t){c.LogManager.get().writeMessage(c.LogCategory.CLIENT,"DEPRECATED",c.LogLevel.ERROR,"Now all media connection on demand. There is no reason do it by hand."),e&&e(null)}detachRecordingDevice(){v.default.StreamManager.get().clear()}setCallActive(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.setActive(t)}sendVideo(){c.LogManager.get().writeMessage(c.LogCategory.CLIENT,"DEPRECATED",c.LogLevel.ERROR,"This function deprecated. Use Call.sendVideo() instead.")}isRTCsupported(){try{const e=new RTCPeerConnection;if(void 0===navigator.getUserMedia&&void 0===navigator.mediaDevices.getUserMedia)throw new Error("No getUserMedia");return e.addTransceiver("audio"),e.getTransceivers().forEach((e=>{if(!e.stopped&&"stopped"!==e.direction&&"stopped"!==e.currentDirection&&(e.sender.replaceTrack(null),e.direction="sendrecv",void 0===e.currentDirection))throw new Error("No currentDirection")})),e.close(),!0}catch(e){return!1}}transferCall(e,t){this.logger.info("transferCall(".concat(e,", ").concat(e,")"));try{o.Utils.checkCA(),this.voxCallManager.transferCall(e,t)}catch(n){this.voxCallManager.handleConnectionFailed(e.id(),+n.message,"",{}),this.voxCallManager.handleConnectionFailed(t.id(),+n.message,"",{})}}setLogLevel(e,t){c.LogManager.get().setLogLevel(e,t)}onSignalingConnected(){this._connected=!0;const e={name:a.Events.ConnectionEstablished};this._resolvePromise("connect",e),this.dispatchEvent(e)}onSignalingClosed(){this._connected=!1,this.dispatchEvent({name:a.Events.ConnectionClosed}),this.progressTone&&this.stopProgressTone()}onSignalingConnectionFailed(e){this._connected=!1,this._rejectPromise("connect",event)}onMediaConnectionFailed(){}getCall(e){return u.CallManager.get().calls[e]}removeCall(e){u.CallManager.get().removeCall(e)}screenSharingSupported(){return l.default.screenSharingSupported()}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}on(e,t,n){super.on(e,t)}off(e,t){super.off(e,t)}registerForPushNotificatuons(e){return this.logger.info("Deprecated registerForPushNotificatuons()"),p.PushService.register(e)}registerForPushNotifications(e){return this.logger.info("registerForPushNotifications()"),p.PushService.register(e)}unregisterForPushNotificatuons(e){return this.logger.info("Deprecated unregisterForPushNotificatuons()"),p.PushService.unregister(e)}unregisterForPushNotifications(e){return this.logger.info("unregisterForPushNotifications()"),p.PushService.unregister(e)}handlePushNotification(e){return this.logger.info("handlePushNotification()"),p.PushService.incomingPush(e)}getGUID(){return(new m.default).toString()}enableSilentLogging(e){c.LogManager.get().shadowLogging=e}clearSilentLog(){c.LogManager.get().clearSilentLog()}getSilentLog(){return c.LogManager.get().getSLog()}setLoggerCallback(e){c.LogManager.get().setLoggerCallback(e)}getClientState(){const e=b.default.currentState();return e==b.VoxSignalingState.CONNECTING||e==b.VoxSignalingState.WSCONNECTED?c.ClientState.CONNECTING:e==b.VoxSignalingState.CLOSING||e==b.VoxSignalingState.IDLE?c.ClientState.DISCONNECTED:e==b.VoxSignalingState.CONNECTED?this.loginState==T.LoginState.LOGGING_IN?c.ClientState.LOGGING_IN:this.loginState==T.LoginState.LOGGED_IN?c.ClientState.LOGGED_IN:c.ClientState.CONNECTED:void 0}setSwfColor(){c.LogManager.get().writeMessage(c.LogCategory.CLIENT,"NOT SUPPORTED",c.LogLevel.ERROR,"setSwfColor deprecated, and not supported!")}_traceName(){return"Client"}checkConnection(){if(!this._connected)throw new Error("NOT_CONNECTED_TO_VOXIMPLANT")}_resolvePromise(e,t){const n=this._promises[e];n&&(n.resolve(t),this._promises[e]=void 0)}_rejectPromise(e,t){const n=this._promises[e];n&&(n.reject(t),this._promises[e]=void 0)}setLogLevelAll(e){const t=c.LogManager.get();Object.keys(c.LogCategory).forEach((n=>{t.setLogLevel(c.LogCategory[n],e)}))}setConnectionData(e,t){e&&(this._config.gateway=e),t&&(this._config.connectionId=t)}isInsertableStreamsSupported(){var e,t;return(null===(t=null===(e=this.config())||void 0===e?void 0:e.experiments)||void 0===t?void 0:t.encodedInsertableStreams)&&window.RTCRtpSender&&!!RTCRtpSender.prototype.createEncodedStreams}isMediaTrackInsertableStreamSupported(){var e,t;return(null===(t=null===(e=this.config())||void 0===e?void 0:e.experiments)||void 0===t?void 0:t.mediaTrackInsertableStreams)&&window.MediaStreamTrackProcessor&&window.MediaStreamTrackGenerator}limitAudioCodecs(e){return this.limitACodecs=e,this.logger.info("limitAudioCodecs(): Trying to limit audio codecs to \n".concat(JSON.stringify(e))),new Promise((async(t,n)=>{let r,i;const a=()=>{null==r||r.getTracks().forEach((e=>e.stop())),null==i||i.close()};try{if(r=await R.StreamManager.getUserMedia({audio:!0,video:!1}),i=new RTCPeerConnection,i){await i.addTransceiver(r.getAudioTracks()[0]);const o=await i.createOffer().catch((()=>n("limitAudioCodecs(): cannot get local offer"))),s=L.SDPMuggle.reduceCodecs(o,{audio:e});return this.logger.info("limitAudioCodecs(): limit codecs was resolved with result ".concat(s.isAudio," \n").concat(s.sdp.sdp)),a(),t(s.isAudio)}return this.logger.info("limitAudioCodecs(): Cannot create a test peer connection"),a(),n("limitAudioCodecs(): Cannot create a test peer connection, audio codecs will be full reduced")}catch(e){return this.logger.info("limitAudioCodecs(): ".concat(e.message)),a(),n("limitAudioCodecs(): Media access denied, audio codecs will be full reduced")}}))}limitVideoCodecs(e){return this.limitVCodecs=e,this.logger.info("limitVideoCodecs(): Trying to limit video codecs to \n".concat(JSON.stringify(e))),new Promise((async(t,n)=>{let r,i;const a=()=>{null==r||r.getTracks().forEach((e=>e.stop())),null==i||i.close()};try{if(r=await R.StreamManager.getUserMedia({audio:!0,video:!0}),i=new RTCPeerConnection,i){await i.addTransceiver(r.getAudioTracks()[0]),await i.addTransceiver(r.getVideoTracks()[0]);const o=await i.createOffer().catch((()=>n("limitVideoCodecs(): cannot get local offer"))),s=L.SDPMuggle.reduceCodecs(o,{video:e});return this.logger.info("limitVideoCodecs(): limit codecs was resolved with result ".concat(s.isVideo," \n").concat(s.sdp.sdp)),a(),t(s.isVideo)}return this.logger.info("limitVideoCodecs(): Cannot create a test peer connection"),a(),n("limitVideoCodecs(): Cannot create a test peer connection, video codecs will be full reduced")}catch(e){return this.logger.info("limitVideoCodecs(): ".concat(e.message)),a(),n("limitVideoCodecs(): Media access denied, video codecs will be full reduced")}}))}}r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"playProgressTone",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"stopProgressTone",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"onIncomingCall",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"init",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"call",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"callConference",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"joinAsSharing",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"joinAsViewer",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"connect",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"disconnect",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"setOperatorACDStatus",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"setOperatorSQMessagingStatus",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"getOperatorACDStatus",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"getOperatorSQMessagingStatus",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"login",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"loginWithCode",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"loginWithToken",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"tokenRefresh",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"requestOneTimeLoginKey",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"loginWithOneTimeKey",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"connected",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"showLocalVideo",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"setLocalVideoPosition",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"setLocalVideoSize",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"setVideoSettings",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"setVideoBandwidth",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"playToneScript",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"stopPlayback",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"volume",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"audioSources",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"videoSources",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"audioOutputs",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"useAudioSource",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"useVideoSource",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"useAudioOutput",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"attachRecordingDevice",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"detachRecordingDevice",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"setCallActive",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"sendVideo",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"isRTCsupported",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"transferCall",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"setLogLevel",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"onSignalingConnected",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"onSignalingClosed",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"onSignalingConnectionFailed",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"onMediaConnectionFailed",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"getCall",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"removeCall",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"addEventListener",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"removeEventListener",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"on",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"off",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"checkConnection",null),r([c.LogManager.d_trace(c.LogCategory.CLIENT)],P.prototype,"setLogLevelAll",null),t.Client=P},9553:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ConferenceEndpointManager=void 0;const i=n(3992),a=n(308),o=n(6278),s=n(9002),l=n(9001),c=n(1901),d=n(6980),u=n(1316);class g{constructor(e){this.call=e,this.currentState={},this.mutex=new i.TaskMutex,d.VideoStatusMachineMediator.subscribeOnEndpointEvents(e),c.registerEndpointStreamsUpdatedHandler(e)}updateState(){const e={};this.call.getEndpoints().forEach((t=>{e[t.id]={audio:[],video:[]},t.mediaRenderers.forEach((n=>{if("audio"===n.kind&&n.enabled)return void(e[t.id].audio=[...e[t.id].audio,...n.mids]);const r=d.VideoStatusMachineMediator.retrieveVSMByMediaRenderer(n);u.MediaRenderResolver.isVideoMR(n)&&"disabledByUser"!==(null==r?void 0:r.value)&&(e[t.id].video=[...e[t.id].video,...n.mids])}))}));const t=this.diffStates(e);if(t.dirty){this.currentState=e,this.call.getEndpoints().forEach((e=>{e.mediaRenderers.forEach((n=>{n.mids.forEach((r=>{u.MediaRenderResolver.isVideoMR(n)&&d.VideoStatusMachineMediator.retrieveVSMByEndpoint(e)||(t.mrEnabled.includes(r)&&e.dispatchEvent({name:l.EndpointEvents.MediaRenderEnabled,endpoint:e,call:this.call,mediaRenderer:n}),t.mrDisabled.includes(r)&&e.dispatchEvent({name:l.EndpointEvents.MediaRenderDisabled,endpoint:e,call:this.call,mediaRenderer:n}))}))}))}));const n=a.CallManager.get().getConfSignaling(this.call);n&&n.runFunction(o.ConfSignalingRemoteFunctions.MANAGE_ENDPOINTS,e)}}updateRenderSize(){const e={};this.call.getEndpoints().forEach((t=>{const n={};t.mediaRenderers.forEach((e=>{if("audio"!==e.kind&&e.videoSize&&e.videoSize.width&&e.videoSize.height){const t=[e.videoSize.width,e.videoSize.height];e.mids.forEach((e=>n[e]=t))}})),Object.keys(n).length&&(e[t.id]=n)}));const t=a.CallManager.get().getConfSignaling(this.call);t&&t.runFunction(o.ConfSignalingRemoteFunctions.REQUEST_VIDEO_SIZE,e)}setCurrentState(e){throw Error("Not implemented")}diffStates(e){const t=["added","default"];let n=!1,r=[],i=[],a=[],o=[],s=[],l={};for(let c in this.currentState)this.currentState.hasOwnProperty(c)&&!t.includes(c)&&(e[c]?["audio","video"].forEach((t=>{this.currentState[c][t]&&this.currentState[c][t].includes("default")?(s.push(c),n=!0):e[c][t]&&e[c][t].includes("default")?(o.push(c),n=!0):(this.currentState[c][t]&&this.currentState[c][t].forEach((r=>{e[c][t]&&e[c][t].includes(r)||(a.push(r),n=!0)})),e[c][t]&&e[c][t].forEach((e=>{this.currentState[c][t]&&this.currentState[c][t].includes(e)||(i.push(e),n=!0)})))})):(n=!0,l[c]=e[c]));for(let c in e)e.hasOwnProperty(c)&&!t.includes(c)&&(this.currentState[c]||(n=!0,r.push(c)));return{dirty:n,removed:r,mrEnabled:i,mrDisabled:a,allEnabled:o,allDisabled:s}}}r([s.debounceDecorator(400,!1)],g.prototype,"updateState",null),r([s.debounceDecorator(400,!1)],g.prototype,"updateRenderSize",null),r([i.queueDecorator()],g.prototype,"setCurrentState",null),t.ConferenceEndpointManager=g},4298:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConferenceEndpointResolver=void 0;const r=n(308);t.ConferenceEndpointResolver=class{constructor(e){this.call=e}get endpointManager(){return r.CallManager.get().getEndpointManager(this.call)}resolveById(e){var t;const n=null===(t=this.endpointManager)||void 0===t?void 0:t.getEndpoints();return null==n?void 0:n.find((t=>t.id===e))}resolveByMid(e){var t;const n=null===(t=this.endpointManager)||void 0===t?void 0:t.getEndpointInfo();if(!n)return;const[r]=Object.entries(n.endpoints).find((t=>{let[n,r]=t;const{mids:i={}}=r;return e in i}))||[];return r?this.resolveById(r):void 0}}},1901:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerEndpointStreamsUpdatedHandler=t.EndpointStreamsUpdatedHandler=void 0;const r=n(1150),i=n(4298),a=n(6980),o=new WeakMap;class s{constructor(e){this.endpointResolver=e,this.logger=r.LogManager.get().createLogger(r.LogCategory.VSM,"EndpointStreamsUpdatedHandler")}static getInstanceBy(e){return o.get(e)}handle(e){const{hidden:t={},appeared:n={}}=e,r=[...Object.entries(t),...Object.entries(n)];for(const[i,o]of r){const e=this.endpointResolver.resolveByMid(i),t=o?"ENDPOINT_STREAM_HIDDEN":"ENDPOINT_STREAM_APPEARED";if(!e){this.logger.info("Endpoint with mid ".concat(i," hasn't found"));continue}const n=a.VideoStatusMachineMediator.retrieveVSMByEndpoint(e);n?n.transition(t):this.logger.warning("Associated VSM with endpoint ".concat(e.id," has not found"))}}}t.EndpointStreamsUpdatedHandler=s,t.registerEndpointStreamsUpdatedHandler=e=>{const t=new i.ConferenceEndpointResolver(e),n=new s(t);return o.set(e,n),n}},9124:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createVideoStatusMachine=void 0;const r=n(6185),i=n(6143),a=n(1150),o=a.LogManager.get().createLogger(a.LogCategory.VSM,"VideoStatusMachine");t.createVideoStatusMachine=e=>{const t=r.obs("enabled"),n={log:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.info("[VSM of ".concat(e.id,"] ").concat(n.join("")))},warn:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.warning("[VSM of ".concat(e.id,"] ").concat(n.join("")))},error:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.error("[VSM of ".concat(e.id,"] ").concat(n.join("")))}};return[i.createStatelessFSM(t,{enabled:{DISABLE_VIDEO:"disabledByUser",ENDPOINT_STREAM_HIDDEN:"disabledByServer"},disabledByUser:{ENABLE_VIDEO:"enabled"},disabledByServer:{ENDPOINT_STREAM_APPEARED:"enabled"}},null,n),t]}},6980:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoStatusMachineMediator=void 0;const r=n(2282),i=n(9001),a=n(9124),o=n(1316),s=n(308),l=n(1150),c=n(1450),d=new WeakMap,u=new WeakMap,g=new WeakMap,f=new WeakMap,h={disabledByUser:c.MediaRenderDisablingReason.Manual,disabledByServer:c.MediaRenderDisablingReason.Automatic};class p{constructor(){}static associateVSMWith(e){const[t,n]=a.createVideoStatusMachine(e);return d.set(e,t),g.set(t,e),n.watch((t=>{this.handleVideoStatusUpdate(e,t)})),this.logger.info("New VSM has been associated with endpoint ".concat(e.id)),t}static retrieveVSMByEndpoint(e){return d.get(e)}static retrieveVSMByMediaRenderer(e){return u.get(e)}static removeVSMAssociationOf(e){d.delete(e)}static subscribeOnEndpointEvents(e){e.on(r.CallEvents.EndpointAdded,(t=>{let{endpoint:n}=t;const r=this.associateVSMWith(n);f.set(n,e.id()),n.on(i.EndpointEvents.RemoteMediaAdded,(e=>{let{mediaRenderer:t}=e;o.MediaRenderResolver.isVideoMR(t)&&u.set(t,r)})),n.on(i.EndpointEvents.RemoteMediaRemoved,(e=>{let{mediaRenderer:t}=e;o.MediaRenderResolver.isVideoMR(t)&&u.delete(t)}))})),e.on(r.CallEvents.EndpointRemoved,(e=>{let{endpoint:t}=e;this.removeVSMAssociationOf(t)}))}static makeTransition(e,t){var n;const r=null===(n=g.get(e))||void 0===n?void 0:n.id;this.logger.info("Start transition ".concat(t," for a VSM of the endpoint ").concat(r));const i=e.transition(t);return i||(this.logger.info("The transition has failed"),this.onTransitionFail(e)),i}static dispatchMediaRenderEvent(e,t,n){const r="enabled"===t?i.EndpointEvents.MediaRenderEnabled:i.EndpointEvents.MediaRenderDisabled,a=o.MediaRenderResolver.retrieveVideoMR(e.mediaRenderers);if(!a)return this.logger.info("Has not associated a media renderer. Dispatching ".concat(r," has aborted")),!1;const l=f.get(e);if(!l)return this.logger.info("Has not associated a call id with endpoint ".concat(e.id,". Dispatching ").concat(r," has aborted")),!1;const c=s.CallManager.get().findCall(l,"");if(!c)return this.logger.info("Cannot find a call with id ".concat(l,". Dispatching ").concat(r," has aborted")),!1;const d={name:r,call:c,endpoint:e,mediaRenderer:a};return"disabled"===t&&n&&(d.reason=h[n]),e.dispatchEvent(d),this.logger.info("The ".concat(r," event has been dispatched ").concat(n?"with reason "+n:"")),!0}static handleVideoStatusUpdate(e,t){this.logger.info("Video status of endpoint ".concat(e.id," to ").concat(t)),"enabled"===t&&this.dispatchMediaRenderEvent(e,"enabled"),"disabledByServer"!==t&&"disabledByUser"!==t||this.dispatchMediaRenderEvent(e,"disabled",t)}static onTransitionFail(e){if("enabled"!==e.value){const t=g.get(e);if(!t)return this.logger.warning("An endpoint has not found by VSM"),!1;this.dispatchMediaRenderEvent(t,"disabled",e.value)}}}t.VideoStatusMachineMediator=p,p.logger=l.LogManager.get().createLogger(l.LogCategory.VSM,"VideoStatusMachineMediator")},3385:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=void 0;class n{}t.Constants=n,n.DIRECT_CALL_HEADER="X-DirectCall",n.VIAMEDIA_CALL_HEADER="X-ViaMedia",n.CALLSTATSIOID_HEADER="X-CallstatsIOID",n.CALL_DATA_HEADER="VI-CallData",n.ZINGAYA_IM_MIME_TYPE="application/zingaya-im",n.P2P_SPD_FRAG_MIME_TYPE="voximplant/sdpfrag",n.VI_HOLD_EMUL="vi/holdemul",n.VI_SPD_OFFER_MIME_TYPE="vi/sdpoffer",n.VI_SPD_ANSWER_MIME_TYPE="vi/sdpanswer",n.VI_CONF_PARTICIPANT_INFO_ADDED="vi/conf-info-added",n.VI_CONF_PARTICIPANT_INFO_REMOVED="vi/conf-info-removed",n.VI_CONF_PARTICIPANT_INFO_UPDATED="vi/conf-info-updated",n.VI_CONF_PARTICIPANT_BATCH="vi/conf-batch"},9002:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounceDecorator=void 0;const r=n(1150);t.debounceDecorator=function(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:400,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(i,a,o)=>({value:function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];e&&n&&r.LogManager.get().writeMessage(r.LogCategory.UTILS,"Debounce",r.LogLevel.WARNING,"Function has been debounced."),clearTimeout(e),e=setTimeout((()=>{e=null,o.value.apply(this,a)}),t)}})}},3576:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.EventTarget=void 0;const i=n(1150),a=n(6577),o=n(9367);class s{sysOn(e,t,n){this._ETonTo("system",e,t,n)}sysOff(e,t){this._EToffTo("system",e,t)}on(e,t,n){this._ETonTo("user",e,t,n)}off(e,t){this._EToffTo("user",e,t)}_ETonTo(e,t,n,r){void 0===this.eventListeners&&(this.eventListeners={});let i=this.eventListeners;void 0===i[t]&&(i[t]=[]);const a={listener:n,options:r,_triggered:!1,_namespace:e};r&&r.capture?i[t].unshift(a):i[t].push(a)}_EToffTo(e,t,n){const r=this.eventListeners;if(void 0!==r&&void 0!==r[t])if("function"==typeof n){for(let i=0;i<r[t].length;i++)if(r[t][i].listener==n&&r[t][i]._namespace===e){r[t].splice(i,1);break}}else r[t]=r[t].filter((t=>t._namespace!==e))}logStats(e,t){i.LogManager.get().writeMessage(i.LogCategory.UTILS,"[event]",i.LogLevel.INFO,"".concat(e," ").concat(JSON.stringify(a.getShortStreamStats(t))))}dispatchEvent(e){var t,n;if(void 0!==this.eventListeners&&void 0!==this.eventListeners[e.name]){const n=this.eventListeners[e.name].filter((e=>"user"===e._namespace));"CallStatsReceived"===e.name?this.logStats(e.name,e.stats):i.LogManager.get().writeMessage(i.LogCategory.UTILS,"[event]",i.LogLevel.INFO,"".concat(e.name).concat((null===(t=e.name)||void 0===t?void 0:t.includes("QualityIssue"))?" "+e.level:"",", listeners: ").concat(n.length));for(let t=0;t<this.eventListeners[e.name].length;t++)try{if(!(this.eventListeners[e.name][t].options&&this.eventListeners[e.name][t].options.once&&this.eventListeners[e.name][t]._triggered||"system"!==this.eventListeners[e.name][t]._namespace&&"user"!==this.eventListeners[e.name][t]._namespace&&("default"!==this.eventListeners[e.name][t]._namespace||n.length))&&(this.eventListeners[e.name][t]._triggered=!0,!1===this.eventListeners[e.name][t].listener(e)))return}catch(e){console.error(e)}}else i.LogManager.get().writeMessage(i.LogCategory.UTILS,"[event]",i.LogLevel.INFO,"".concat(e.name).concat((null===(n=e.name)||void 0===n?void 0:n.includes("QualityIssue"))?" "+e.level:"",", listeners: 0"))}removeEventListener(e,t){this.off(e,t)}addEventListener(e,t,n){this.on(e,t,n)}addDefaultEventListener(e,t){this._ETonTo("default",e,t,{})}removeDefaultEventListener(e){this._EToffTo("default",e)}_traceName(){return"EventTarget"}}r([i.LogManager.d_trace(i.LogCategory.EVENTTARGET)],s.prototype,"sysOn",null),r([i.LogManager.d_trace(i.LogCategory.EVENTTARGET)],s.prototype,"sysOff",null),r([i.LogManager.d_trace(i.LogCategory.EVENTTARGET)],s.prototype,"on",null),r([i.LogManager.d_trace(i.LogCategory.EVENTTARGET)],s.prototype,"off",null),r([o.throttleDecorator(5e3)],s.prototype,"logStats",null),r([i.LogManager.d_trace(i.LogCategory.EVENTTARGET)],s.prototype,"removeEventListener",null),r([i.LogManager.d_trace(i.LogCategory.EVENTTARGET)],s.prototype,"addEventListener",null),r([i.LogManager.d_trace(i.LogCategory.EVENTTARGET)],s.prototype,"addDefaultEventListener",null),r([i.LogManager.d_trace(i.LogCategory.EVENTTARGET)],s.prototype,"removeDefaultEventListener",null),t.EventTarget=s},141:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Events=void 0,function(e){e[e.SDKReady="SDKReady"]="SDKReady",e[e.ConnectionEstablished="ConnectionEstablished"]="ConnectionEstablished",e[e.ConnectionFailed="ConnectionFailed"]="ConnectionFailed",e[e.ConnectionClosed="ConnectionClosed"]="ConnectionClosed",e[e.Reconnecting="Reconnecting"]="Reconnecting",e[e.Reconnected="Reconnected"]="Reconnected",e[e.AuthResult="AuthResult"]="AuthResult",e[e.RefreshTokenResult="RefreshTokenResult"]="RefreshTokenResult",e[e.PlaybackFinished="PlaybackFinished"]="PlaybackFinished",e[e.MicAccessResult="MicAccessResult"]="MicAccessResult",e[e.IncomingCall="IncomingCall"]="IncomingCall",e[e.SourcesInfoUpdated="SourcesInfoUpdated"]="SourcesInfoUpdated",e[e.NetStatsReceived="NetStatsReceived"]="NetStatsReceived",e[e.SIPRegistrationSuccessful="SIPRegistrationSuccessful"]="SIPRegistrationSuccessful",e[e.SIPRegistrationFailed="SIPRegistrationFailed"]="SIPRegistrationFailed",e[e.ACDStatusUpdated="ACDStatusUpdated"]="ACDStatusUpdated",e[e.SQMessagingStatusUpdated="SQMessagingStatusUpdated"]="SQMessagingStatusUpdated",e[e.ACDError="ACDError"]="ACDError",e[e.SQError="SQError"]="SQError",e[e.PlaybackError="PlaybackError"]="PlaybackError"}(t.Events||(t.Events={}))},209:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.str=e||n.getNewGUIDString()}toString(){return this.str}static getNewGUIDString(){let e=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{let n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}_traceName(){return"GUID"}}t.default=n},7272:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Hardware=void 0;const r=n(4855);var i;!function(e){let t,n;!function(e){e[e.DevicesUpdated="DevicesUpdated"]="DevicesUpdated",e[e.MediaRendererAdded="MediaRendererAdded"]="MediaRendererAdded",e[e.MediaRendererUpdated="MediaRendererUpdated"]="MediaRendererUpdated",e[e.MediaRendererRemoved="MediaRendererRemoved"]="MediaRendererRemoved",e[e.BeforeMediaRendererRemoved="BeforeMediaRendererRemoved"]="BeforeMediaRendererRemoved"}(t=e.HardwareEvents||(e.HardwareEvents={})),function(e){e[e.VIDEO_QUALITY_HIGH="video_quality_high"]="VIDEO_QUALITY_HIGH",e[e.VIDEO_QUALITY_LOW="video_quality_low"]="VIDEO_QUALITY_LOW",e[e.VIDEO_QUALITY_MEDIUM="video_quality_medium"]="VIDEO_QUALITY_MEDIUM",e[e.VIDEO_SIZE_QQVGA="video_size_qqvga"]="VIDEO_SIZE_QQVGA",e[e.VIDEO_SIZE_QCIF="video_size_qcif"]="VIDEO_SIZE_QCIF",e[e.VIDEO_SIZE_QVGA="video_size_qvga"]="VIDEO_SIZE_QVGA",e[e.VIDEO_SIZE_CIF="video_size_cif"]="VIDEO_SIZE_CIF",e[e.VIDEO_SIZE_nHD="video_size_nhd"]="VIDEO_SIZE_nHD",e[e.VIDEO_SIZE_VGA="video_size_vga"]="VIDEO_SIZE_VGA",e[e.VIDEO_SIZE_SVGA="video_size_svga"]="VIDEO_SIZE_SVGA",e[e.VIDEO_SIZE_HD="video_size_hd"]="VIDEO_SIZE_HD",e[e.VIDEO_SIZE_UXGA="video_size_uxga"]="VIDEO_SIZE_UXGA",e[e.VIDEO_SIZE_FHD="video_size_fhd"]="VIDEO_SIZE_FHD",e[e.VIDEO_SIZE_UHD="video_size_uhd"]="VIDEO_SIZE_UHD"}(n=e.VideoQuality||(e.VideoQuality={}));class i extends r.AudioDeviceManager{}e.AudioDeviceManager=i;class a extends r.CameraManager{}e.CameraManager=a;class o extends r.StreamManager{}e.StreamManager=o}(i=t.Hardware||(t.Hardware={})),t.default=i},2709:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.AudioDeviceManager=void 0;const i=n(1150),a=n(4007),o=n(9699),s=n(787),l=n(2957),c=["inputId","noiseSuppression","echoCancellation","disableAudio"];class d{constructor(){if(void 0!==d.instance)throw new Error("Error - use StreamManager.get()");navigator&&navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints?this._supportedConstraints=navigator.mediaDevices.getSupportedConstraints():this._supportedConstraints={},this.__defaultParams={echoCancellation:!0,autoGainControl:!0,noiseSuppression:!0},this._lastAudioInputDevices=[],this._lastAudioOutputDevices=[],this._callParams={},this.logger=i.LogManager.get().createLogger(i.LogCategory.USERMEDIA,this._traceName())}getAudioContext(){if(this.audioContext)return this.audioContext;if(void 0!==window.AudioContext||void 0!==window.webkitAudioContext){window.AudioContext=window.AudioContext||window.webkitAudioContext;try{return this.audioContext=new AudioContext,this.audioContext}catch(e){return this.audioContext=null,null}}}prepareAudioContext(){this.getAudioContext()}static get(){return void 0===d.instance&&(d.instance=new d),d.instance}getInputDevices(){return navigator.mediaDevices.enumerateDevices().then((e=>(this.logger.info("Got input devices: ".concat(JSON.stringify(e))),this._lastAudioInputDevices=e.map((e=>{if("audio"===e.kind||"audioinput"===e.kind)return{id:e.deviceId,name:e.label,group:e.groupId}})).filter((e=>void 0!==e)),this._lastAudioInputDevices)))}getOutputDevices(){return navigator.mediaDevices.enumerateDevices().then((e=>(this.logger.info("Got output devices: ".concat(JSON.stringify(e))),this._lastAudioOutputDevices=e.map((e=>{if("audiooutput"===e.kind)return{id:e.deviceId,name:e.label,group:e.groupId}})).filter((e=>void 0!==e)),this._lastAudioOutputDevices)))}getDefaultAudioSettings(){return this.__defaultParams}setDefaultAudioSettings(e){this.logger.info("Set next params for default audio settings: ".concat(JSON.stringify(e))),this.__defaultParams=Object.assign(Object.assign({},this.__defaultParams),e),this.logger.info("Current default audio settings: ".concat(JSON.stringify(this.__defaultParams)))}async setCallAudioSettings(e,t){if(this.logger.info("Setting call ".concat(e.id()," audio settings: ").concat(JSON.stringify(t))),!e.active())return Promise.reject(s.dispatchUpdatedEvent(e,!1,o.CallFailedUpdateReasons.mediaOnHold));if(this._callParams[e.id()]===t)return;const n=this._callParams[e.id()];let r=c.some((e=>n[e]!==t[e]));r||"default"!==t.inputId||(r=!0);const i=n.outputId!==t.outputId;if(this.logger.info("Must update renderers: ".concat(i,", must update source: ").concat(r)),this._callParams[e.id()]=t,r)try{await a.StreamManager.get().updateStreamSettings(e),this.logger.info("Audio settings were set successfully.")}catch(t){throw this.logger.warning("Failed to update call ".concat(e.id()," stream: ").concat(l.Utils.stringifyError(t))),Error(t)}i&&void 0!==t.outputId&&await Promise.all(e.getEndpoints().map((e=>e.mediaRenderers.filter((e=>{let{kind:t}=e;return"audio"===t})).map((e=>e.useAudioOutput(t.outputId))))))}getCallAudioSettings(e){return this._callParams[e.id()]}getCallConstraints(e){return this._callParams[e]?this._getAudioConstraints(this._callParams[e]):(this._callParams[e]=this.__defaultParams,this._getAudioConstraints(this.__defaultParams))}_getAudioConstraints(e){if(e.disableAudio)return!1;e.strict;const t={};return e.inputId&&(t.deviceId={exact:e.inputId}),"boolean"==typeof e.echoCancellation&&this._supportedConstraints.echoCancellation&&(t.echoCancellation=e.echoCancellation),"boolean"==typeof e.noiseSuppression&&this._supportedConstraints.noiseSuppression&&(t.noiseSuppression=e.noiseSuppression),"boolean"==typeof e.autoGainControl&&this._supportedConstraints.autoGainControl&&(t.autoGainControl=e.autoGainControl),e.advanced&&(t.advanced=e.advanced),t.echoCancellationType="system",!Object.keys(t)||t}_traceName(){return"AudioDeviceManager"}}r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"getInputDevices",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"getOutputDevices",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"getDefaultAudioSettings",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"setDefaultAudioSettings",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"setCallAudioSettings",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"getCallAudioSettings",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"getCallConstraints",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"_getAudioConstraints",null),t.AudioDeviceManager=d},2334:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.CameraManager=void 0;const i=n(1150),a=n(4007),o=n(7272),s=n(3869),l=n(9699),c=n(787);class d{constructor(){if(void 0!==d.instance)throw new Error("Error - use StreamManager.get()");navigator&&navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints?this._supportedConstraints=navigator.mediaDevices.getSupportedConstraints():this._supportedConstraints={},this._callParams={},this._lastCameraDevices=[],this.__defaultParams={},this.logger=i.LogManager.get().createLogger(i.LogCategory.USERMEDIA,this._traceName())}static get(){return void 0===d.instance&&(d.instance=new d),d.instance}async setDefaultVideoSettings(e){const t=this._validateCameraParams(e);this.logger.info("Setting  default video settings, params: ".concat(JSON.stringify(e),", valid params: ").concat(JSON.stringify(t))),this.__defaultParams=t,await o.Hardware.StreamManager.get().updateLocalVideo()}getDefaultVideoSettings(){return this.__defaultParams}setCallVideoSettings(e,t){const n=this._validateCameraParams(t);return this.logger.info("Setting call ".concat(e.id()," video settings, params: ").concat(JSON.stringify(t),", valid params: ").concat(JSON.stringify(n))),e.active()?(this._callParams[e.id()]=n,new Promise(((t,n)=>{a.StreamManager.get().updateStreamSettings(e).then((()=>{this.logger.info("Video settings were set successfully."),t()})).catch((t=>{this.logger.warning("Failed to set call ".concat(e.id()," video settings: ").concat(t)),n(t)}))}))):Promise.reject(c.dispatchUpdatedEvent(e,!1,l.CallFailedUpdateReasons.mediaOnHold))}getCallVideoSettings(e){return this._callParams[e.id()]}getCallConstraints(e){return"__local__"===e?(this._callParams[e]=this.__defaultParams,this._getVideoConstraints(this.__defaultParams)):this._callParams[e]?this._getVideoConstraints(this._callParams[e]):(this._callParams[e]=this.__defaultParams,this._getVideoConstraints(this.__defaultParams))}getInputDevices(){return navigator.mediaDevices.enumerateDevices().then((e=>(this.logger.info("Got input devices: ".concat(JSON.stringify(e))),this._lastCameraDevices=e.map((e=>{if("video"===e.kind||"videoinput"===e.kind)return{id:e.deviceId,name:e.label,group:e.groupId}})).filter((e=>void 0!==e)),this._lastCameraDevices)))}_getVideoConstraints(e){const t={};return e.cameraId?t.deviceId={exact:e.cameraId}:void 0!==e.facingMode&&(!1===e.facingMode?t.facingMode="environment":t.facingMode="user"),e.frameHeight&&(t.height={},e.strict?t.height.min=e.frameHeight:t.height.ideal=e.frameHeight),e.frameWidth&&(t.width={},e.strict?t.width.min=e.frameWidth:t.width.ideal=e.frameWidth),e.frameRate&&e.frameRate>0&&this._supportedConstraints.frameRate&&(t.frameRate=e.frameRate+""),e.aspectRatio&&e.aspectRatio>0&&this._supportedConstraints.aspectRatio&&(t.aspectRatio={exact:e.aspectRatio+""}),!Object.keys(t)||t}_validateCameraParams(e){if(e.videoQuality){(e.frameHeight||e.frameWidth)&&this.logger.warning('"videoQuality" parameter detected. The "frameHeight" and the "frameWidth" params will be ignored');const t=this._videoQualityToSize(e.videoQuality);e.frameWidth=t.w,e.frameHeight=t.h}return s.default.isIphone()&&(delete e.videoQuality,delete e.frameWidth,delete e.frameHeight,delete e.frameRate),e}_videoQualityToSize(e){switch(e){case o.Hardware.VideoQuality.VIDEO_QUALITY_HIGH:return{w:1280,h:720};case o.Hardware.VideoQuality.VIDEO_QUALITY_MEDIUM:return{w:640,h:480};case o.Hardware.VideoQuality.VIDEO_QUALITY_LOW:return{w:320,h:240};case o.Hardware.VideoQuality.VIDEO_SIZE_QQVGA:return{w:160,h:120};case o.Hardware.VideoQuality.VIDEO_SIZE_QCIF:return{w:176,h:144};case o.Hardware.VideoQuality.VIDEO_SIZE_QVGA:return{w:320,h:240};case o.Hardware.VideoQuality.VIDEO_SIZE_CIF:return{w:352,h:288};case o.Hardware.VideoQuality.VIDEO_SIZE_nHD:return{w:640,h:360};case o.Hardware.VideoQuality.VIDEO_SIZE_VGA:return{w:640,h:480};case o.Hardware.VideoQuality.VIDEO_SIZE_SVGA:return{w:800,h:600};case o.Hardware.VideoQuality.VIDEO_SIZE_HD:return{w:1280,h:720};case o.Hardware.VideoQuality.VIDEO_SIZE_UXGA:return{w:1600,h:1200};case o.Hardware.VideoQuality.VIDEO_SIZE_FHD:return{w:1920,h:1080};case o.Hardware.VideoQuality.VIDEO_SIZE_UHD:return{w:3840,h:2160};default:return{w:320,h:240}}}static legacyParamConverter(e){const t={videoQuality:o.Hardware.VideoQuality.VIDEO_QUALITY_MEDIUM};return e.width&&("string"==typeof e.width||"number"==typeof e.width?(delete t.videoQuality,t.frameWidth=e.width):"string"==typeof e.width.exact||"number"==typeof e.width.exact?(delete t.videoQuality,t.frameWidth=e.width.exact,t.strict=!0):"string"==typeof e.width.min||"number"==typeof e.width.min?(delete t.videoQuality,t.frameWidth=e.width.min):"string"==typeof e.width.max||"number"==typeof e.width.max?(delete t.videoQuality,t.frameWidth=e.width.max):"string"!=typeof e.width.ideal&&"number"!=typeof e.width.ideal||(delete t.videoQuality,t.frameWidth=e.width.ideal)),e.height&&("string"==typeof e.height||"number"==typeof e.height?(delete t.videoQuality,t.frameHeight=e.height):"string"==typeof e.height.exact||"number"==typeof e.height.exact?(delete t.videoQuality,t.frameHeight=e.height.exact,t.strict=!0):"string"==typeof e.height.min||"number"==typeof e.height.min?(delete t.videoQuality,t.frameHeight=e.height.min):"string"==typeof e.height.max||"number"==typeof e.height.max?(delete t.videoQuality,t.frameHeight=e.height.max):"string"!=typeof e.height.ideal&&"number"!=typeof e.height.ideal||(delete t.videoQuality,t.frameHeight=e.height.ideal)),t}testResolutions(e){const t=[o.Hardware.VideoQuality.VIDEO_SIZE_QQVGA,o.Hardware.VideoQuality.VIDEO_SIZE_QCIF,o.Hardware.VideoQuality.VIDEO_SIZE_QVGA,o.Hardware.VideoQuality.VIDEO_SIZE_CIF,o.Hardware.VideoQuality.VIDEO_SIZE_nHD,o.Hardware.VideoQuality.VIDEO_SIZE_VGA,o.Hardware.VideoQuality.VIDEO_SIZE_SVGA,o.Hardware.VideoQuality.VIDEO_SIZE_HD,o.Hardware.VideoQuality.VIDEO_SIZE_UXGA,o.Hardware.VideoQuality.VIDEO_SIZE_FHD,o.Hardware.VideoQuality.VIDEO_SIZE_UHD];return this._lastResolutionTestResult?new Promise(((e,t)=>{e(this._lastResolutionTestResult)})):this._testResolutions(t,{},e)}_testResolutions(e,t,n){if(e.length){let r=e.shift(),i={strict:!0};const s=this._videoQualityToSize(r);i.frameWidth=s.w,i.frameHeight=s.h,n&&(i.cameraId=n);let l={video:this._getVideoConstraints(i)};return a.StreamManager.getUserMedia(l).then((i=>(this.logger.info("_testResolutions(): Media access granted"),i.getTracks().forEach((e=>e.stop())),t[o.Hardware.VideoQuality[r]]=!0,this._testResolutions(e,t,n))),(i=>(this.logger.error("_testResolutions(): Media access denied: ".concat(i?i.message||i.name||i:"unknown")),t[o.Hardware.VideoQuality[r]]=!1,this._testResolutions(e,t,n))))}return this._lastResolutionTestResult=t,t}loadResolutionTestResult(e){return!![o.Hardware.VideoQuality.VIDEO_SIZE_QQVGA,o.Hardware.VideoQuality.VIDEO_SIZE_QCIF,o.Hardware.VideoQuality.VIDEO_SIZE_QVGA,o.Hardware.VideoQuality.VIDEO_SIZE_CIF,o.Hardware.VideoQuality.VIDEO_SIZE_nHD,o.Hardware.VideoQuality.VIDEO_SIZE_VGA,o.Hardware.VideoQuality.VIDEO_SIZE_SVGA,o.Hardware.VideoQuality.VIDEO_SIZE_HD,o.Hardware.VideoQuality.VIDEO_SIZE_UXGA,o.Hardware.VideoQuality.VIDEO_SIZE_FHD,o.Hardware.VideoQuality.VIDEO_SIZE_UHD].every((t=>void 0!==e[o.Hardware.VideoQuality[t]]))&&(this._lastResolutionTestResult=e,!0)}_traceName(){return"CameraManager"}}r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"setDefaultVideoSettings",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"getDefaultVideoSettings",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"setCallVideoSettings",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"getCallVideoSettings",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"getCallConstraints",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"getInputDevices",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"_getVideoConstraints",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d.prototype,"_validateCameraParams",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],d,"legacyParamConverter",null),t.CameraManager=d},4007:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManager=void 0;const i=n(1150),a=n(7272),o=n(3576),s=n(2334),l=n(3869),c=n(141),d=n(125),u=n(2709),g=n(7222),f=n(308),h=n(8237),p=n(787),m=n(4610),v=n(9001);class y extends o.EventTarget{constructor(){if(super(),this.isLocalVideoRequested=!1,this.localVideoPromises=[],this._dedicatedMirrorStream=null,void 0!==y.instance)throw new Error("Error - use StreamManager.get()");this._callStreams={},this._localMediaRenderers=[],this._sharingStreams={},this.logger=i.LogManager.get().createLogger(i.LogCategory.HARDWARE,this._traceName())}static get(){return void 0===y.instance&&(y.instance=new y),y.instance}async getCallStream(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=void 0===e?"__default":e.id();if(this._callStreams[n]&&!t)return this._callStreams[n];{const t=this._composeConstraints(e);if(this.logger.info("[constraints]: ".concat(JSON.stringify(t))),!t.audio&&!t.video&&"__default"!==n)return null;try{const r=await y.getUserMedia(t);this.logger.info("Media access granted"),this._callStreams[n]=r,r.getTracks().forEach((e=>{e.onended=this.onCallEnded,e.onmute=this.onCallEnded}));const i=e.state();return i===m.CallState.STOPPING||i===m.CallState.ENDED?(this.logger.info("Media Stream will be stopped, because call in ".concat(i," state")),r):(d.Client.getInstance().dispatchEvent({name:c.Events.MicAccessResult,result:!0,stream:r}),r)}catch(r){let a=null;this.logger.warning("Couldn't get media stream the first time. Error name: ".concat(r.name,", error reason: ").concat(r.message));try{"NotFoundError"===(null==r?void 0:r.name)&&(a=await this._handleNotFoundError(e,t)),"NotReadableError"===(null==r?void 0:r.name)&&(a=await this._handleNotReadableError(e,t))}catch(e){throw this.logger.error("Media access denied: ".concat((null==e?void 0:e.message)||(null==e?void 0:e.name)||e||"unknown")),d.Client.getInstance().dispatchEvent({name:c.Events.MicAccessResult,result:!1,stream:null}),e}if(!a)throw new Error("Can't get stream");return this.logger.info("Media access granted"),this._callStreams[n]=a,a.getTracks().forEach((e=>{e.onended=this.onCallEnded,e.onmute=this.onCallEnded})),d.Client.getInstance().dispatchEvent({name:c.Events.MicAccessResult,result:Boolean(a),stream:a,fallback:!0}),a}}}async _handleNotFoundError(e,t){let n={audio:!0};return this.logger.info("[NotFoundError backup constraints]: ".concat(JSON.stringify(t))),void 0!==e&&(e.settings.videoDirections.sendVideo=!1,n=this._composeConstraints(e)),await y.getUserMedia(n)}async _handleNotReadableError(e,t){var n,r;const i=void 0===e?"__default":e.id();this.logger.info("[NotReadableError constraints]: ".concat(JSON.stringify(t)));const a=this._callStreams[i];a&&a.getTracks().forEach((e=>e.stop()));try{return await y.getUserMedia(t)}catch(t){this.logger.warning("Couldn't handle NotReadableError. Error name: ".concat(t.name,", error reason: ").concat(t.message));const i={video:Boolean(null===(r=null===(n=null==e?void 0:e.settings)||void 0===n?void 0:n.videoDirections)||void 0===r?void 0:r.sendVideo),audio:!0};return this.logger.info("[NotReadableError fallback constraints]: ".concat(JSON.stringify(i))),await y.getUserMedia(i)}}_updateCallStream(e){return this.remCallStream(e),this.getCallStream(e)}updateCallStream(e){return this.logger.info("Updating call ".concat(e.id()," stream")),new Promise(((t,n)=>{const r=this._callStreams[e.id()],i=()=>{setTimeout((()=>this.updateLocalVideo()),500),e.peerConnection.restoreMute();const t=()=>{r.getTracks().forEach((t=>{e.peerConnection.getTransceivers().some((e=>e.sender.track&&e.sender.track.id===t.id))||l.default.isIphone()||t.stop()}))};setTimeout(t,500),setTimeout(t,2e3),setTimeout(t,5e3)},a=()=>{i(),t()};this.getCallStream(e,!0).then((t=>{const i=r.getTracks(),o=t.getTracks(),s=i.map((e=>e.kind)).sort(),l=o.map((e=>e.kind)).sort();return h.CallPromiseResolver.add(e,{resolve:a,reject:n,dispatchEvent:p.dispatchUpdatedEvent.bind(null,e)}),i.length===o.length&&s.every(((e,t)=>e===l[t]))?e.peerConnection.updateCustomMedia(t):(e.peerConnection.fastRemoveCustomMedia(r),this._remCallStream(r),e.peerConnection.addCustomMedia(t))})).catch(n)}))}async updateStreamSettings(e){this.logger.info("Updating call ".concat(e.id()," stream settings"));try{const t=await this.getCallStream(e,!0);await e.peerConnection.updateMediaTracks(t),await this.updateLocalVideo()}catch(e){throw this.logger.error("updateStreamSettings error: ".concat(e.message)),e}}remCallStream(e){const t=void 0===e?"__default":e.id();this._callStreams[t]&&(this._remCallStream(this._callStreams[t]),this._callStreams[t]=void 0,delete this._callStreams[t])}_remCallStream(e){e&&(l.default.isIphone()||e.getTracks().forEach((t=>{t.onended=void 0,t.onmute=void 0,t.stop(),e.removeTrack(t)})))}clear(){this._mirrorStream&&this._mirrorStream.getTracks().forEach((e=>{e.onended=void 0,e.onmute=void 0,e.stop()})),this._mirrorStream=void 0;for(let e in this._callStreams)if(this._callStreams.hasOwnProperty(e)){const t=this._callStreams[e];t&&t.getTracks().forEach((e=>{e.onended=void 0,e.onmute=void 0,e.stop()}))}this._callStreams={}}getLocalMediaRenderers(){return this._localMediaRenderers}showLocalVideo(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.logger.info("Call to show local video."),new Promise(((t,n)=>{const r="voximplantlocalvideo";if(this.isLocalVideoRequested)return this.logger.warning("The local video is already displaying."),t(this._localMediaRenderers[0]);const i=this._getVideoFromCalls();if(this.isLocalVideoRequested=!0,i){const n=new g.MediaRenderer({stream:new MediaStream([i]),kind:"video",placeOnDom:e,isLocal:!0,deprecatedId:r,mids:["local"]});this._localMediaRenderers.push(n),this.logger.info("New localMediaRenderer for existing track was added."),t(n),this.dispatchEvent({name:a.default.HardwareEvents.MediaRendererAdded,renderer:n})}else{const i=this.getDedicatedMirrorStream().then((n=>{this._dedicatedMirrorStream&&this.stopDedicatedMirrorStream(),this._dedicatedMirrorStream=n;const i=new g.MediaRenderer({stream:n,kind:"video",placeOnDom:e,isLocal:!0,deprecatedId:r,mids:["local"]});this._localMediaRenderers.push(i),this.logger.info("New localMediaRenderer was added. New stream was created."),t(i),this.dispatchEvent({name:a.default.HardwareEvents.MediaRendererAdded,renderer:i})})).catch((e=>{this.isLocalVideoRequested=!1,n(e)}));this.localVideoPromises.push(i)}}))}async getDedicatedMirrorStream(){try{return this.logger.info("Getting dedicated mirror stream."),await y.getUserMedia({video:s.CameraManager.get().getCallConstraints("__local__")})}catch(e){if("NotReadableError"===(null==e?void 0:e.name))return this.logger.info("Couldn't get mirror stream. Will do it again."),this.stopDedicatedMirrorStream(),await y.getUserMedia({video:s.CameraManager.get().getCallConstraints("__local__")});throw e}}stopDedicatedMirrorStream(){if(this._dedicatedMirrorStream){this._dedicatedMirrorStream.getTracks().forEach((e=>{e.onended=null,e.onmute=null,e.stop()}));try{this._dedicatedMirrorStream.stop(),this.logger.info("Dedicated mirror stream was stopped.")}catch(e){}this._dedicatedMirrorStream=null}}async updateLocalVideo(e){if(this._localMediaRenderers&&0===this._localMediaRenderers.length)return void this.logger.info("Local video wasn't updated because there is 0 local media renderers.");if(!this.isLocalVideoRequested)return void this.logger.info("Local video wasn't updated because it wasn't requested.");const t=this._getVideoFromCalls();if(this.logger.info("Local video for rendererKind: ".concat(e," will be updated. Track from call exist: ").concat(Boolean(t))),t)this._localMediaRenderers[0].stream.getVideoTracks()[0].id!==t.id?(this._localMediaRenderers[0].replaceVideo(new MediaStream([t])),this.stopDedicatedMirrorStream(),this.dispatchEvent({name:a.default.HardwareEvents.MediaRendererUpdated,renderer:this._localMediaRenderers[0],type:e||this._localMediaRenderers[0].kind})):this.logger.info("Local media renderer contains different track from call.");else try{const t=await this.getDedicatedMirrorStream();this._dedicatedMirrorStream&&this.stopDedicatedMirrorStream(),this._dedicatedMirrorStream=t,this._localMediaRenderers[0]&&(this._localMediaRenderers[0].kind=e||"video",this._localMediaRenderers[0].replaceVideo(t),this.dispatchEvent({name:a.default.HardwareEvents.MediaRendererUpdated,renderer:this._localMediaRenderers[0],type:e||this._localMediaRenderers[0].kind}))}catch(e){this.logger.error("Unable to update local video: ".concat(e.message))}}async hideLocalVideo(){return this.isLocalVideoRequested?(await Promise.all(this.localVideoPromises),this.logger.info("Start hiding local video."),this.localVideoPromises=[],0===this._localMediaRenderers.length?(this.logger.info("There isn't local media renderer."),Promise.resolve()):(this.dispatchEvent({name:a.default.HardwareEvents.BeforeMediaRendererRemoved,renderer:this._localMediaRenderers[0]}),this.isLocalVideoRequested=!1,this._dedicatedMirrorStream&&this.stopDedicatedMirrorStream(),this._localMediaRenderers[0].clear(),this._localMediaRenderers[0].stream=null,this._localMediaRenderers.shift(),this.dispatchEvent({name:a.default.HardwareEvents.MediaRendererRemoved,renderer:this._localMediaRenderers[0]}),this.logger.info("Local video was hidden."),Promise.resolve())):(this.logger.info("Nothing to hide. Local video wasn't requested."),Promise.resolve())}on(e,t,n){super.on(e,t)}off(e,t){super.off(e,t)}_newScreenSharing(e){return this.logger.info("Getting media for screen sharing."),new Promise(((t,n)=>{l.default.getScreenMedia().then((n=>{var r;this.logger.info("Media access granted");const i={stream:n,renderer:null};n.getTracks().forEach((t=>{t.onended=()=>e.stopSharingScreen()}));let a=null===(r=this._localMediaRenderers)||void 0===r?void 0:r[0];a&&(a.kind="sharing"),void 0===this._sharingStreams[e.id()]&&(this._sharingStreams[e.id()]=[]),this._sharingStreams[e.id()].push(i),t(i)})).catch((e=>{this.logger.error("Media access denied: ".concat(e?e.message||e.name||e:"unknown")),n(e)}))}))}_getScreenSharing(e){return void 0!==this._sharingStreams[e.id()]?this._sharingStreams[e.id()]:[]}_clearScreenSharing(e,t){return this.logger.info("Stopping sharing media stream."),new Promise((n=>{var r;this._sharingStreams[e.id()]=this._sharingStreams[e.id()].filter((e=>e.stream.id!==t.stream.id)),t.renderer&&(this._localMediaRenderers=this._localMediaRenderers.filter((e=>e.id!==t.renderer.id)),t.renderer.clear(),t.renderer=void 0),t.stream.getTracks().forEach((e=>{e.enabled=!1,e.onended=null,e.stop()})),"sharing"===(null===(r=this._localMediaRenderers[0])||void 0===r?void 0:r.kind)&&(this._localMediaRenderers[0].kind="video"),this.logger.info("Sharing media stream was stopped."),e.dispatchEvent({name:v.CallEvents.SharingStopped,call:e,result:!0}),n()}))}_getTracksKind(e){let t={};const n=this._callStreams[e.id()];void 0!==n&&n.getTracks().forEach((e=>t[e.id]=e.kind));const r=this._sharingStreams[e.id()];return void 0!==r&&r.forEach((e=>{e.stream.getTracks().forEach((e=>t[e.id]="sharing"))})),t}_traceName(){return"StreamManager"}_getVideoFromCalls(){const e=f.CallManager.get(),t=[];for(const n in e.calls)if(e.calls.hasOwnProperty(n)){const r=e.calls[n];if(!r.active())break;const i={time:r.getCallDuration(),track:null};r.peerConnection&&r.peerConnection.getTransceivers().forEach((e=>{null===i.track&&-1!==e.direction.indexOf("send")&&e.sender.track&&"video"===e.sender.track.kind&&"live"===e.sender.track.readyState&&(i.track=e.sender.track)})),i.track&&t.push(i)}return t.length?(t.sort(((e,t)=>e.time>t.time?1:e.time<t.time?-1:0)),t[0].track):null}onCallEnded(){}_composeConstraints(e){const t=void 0===e?"__default":e.id(),n={};return"__default"!==t&&void 0!==e&&e.settings.videoDirections.sendVideo?n.video=s.CameraManager.get().getCallConstraints(t):n.video=!1,"__default"===t||e.settings.audioDirections.sendAudio?n.audio=u.AudioDeviceManager.get().getCallConstraints(t):n.audio=!1,n}static getUserMedia(e){return new Promise(((t,n)=>{const r=navigator.mediaDevices.getUserMedia(e).then((e=>{y.umCache.push(e),t(e)})).catch(n);y.umCachePromises.push(r)}))}static async clearUmCache(){await Promise.all(y.umCachePromises),y.umCachePromises=[],y.umCache=y.umCache.filter((e=>{const t=y.get()._dedicatedMirrorStream;return!(!t||e.id!==t.id)||(e.getTracks().forEach((e=>e.stop())),!1)}))}}y.umCache=[],y.umCachePromises=[],r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"getCallStream",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"_handleNotFoundError",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"_handleNotReadableError",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"_updateCallStream",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"updateCallStream",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"remCallStream",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"_remCallStream",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"clear",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"getLocalMediaRenderers",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"showLocalVideo",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"hideLocalVideo",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"on",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"off",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"_newScreenSharing",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"_getScreenSharing",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"_clearScreenSharing",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"_getTracksKind",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"onCallEnded",null),r([i.LogManager.d_trace(i.LogCategory.HARDWARE)],y.prototype,"_composeConstraints",null),t.StreamManager=y},4855:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManager=t.CameraManager=t.AudioDeviceManager=void 0;var r=n(2709);Object.defineProperty(t,"AudioDeviceManager",{enumerable:!0,get:function(){return r.AudioDeviceManager}});var i=n(2334);Object.defineProperty(t,"CameraManager",{enumerable:!0,get:function(){return i.CameraManager}});var a=n(4007);Object.defineProperty(t,"StreamManager",{enumerable:!0,get:function(){return a.StreamManager}})},6230:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PushService=void 0;const r=n(4106),i=n(209),a=n(245);class o{static updatePromiseResult(e){const t=this._pushPromises[e.params];t&&(clearTimeout(t.expire),e.msg?t.reject(e.msg):t.resolve(),delete this._pushPromises[e.params])}static register(e){return new Promise(((t,n)=>{const o=(new i.default).toString();a.default.callRemoteFunction(r.RemoteFunction.registerPushToken,e,o)?this._pushPromises[o]={resolve:t,reject:n,expire:setTimeout(n,3e4)}:n()}))}static unregister(e){return new Promise(((t,n)=>{const o=(new i.default).toString();a.default.callRemoteFunction(r.RemoteFunction.unregisterPushToken,e,o)?this._pushPromises[o]={resolve:t,reject:n,expire:setTimeout(n,3e4)}:n()}))}static incomingPush(e){return new Promise(((t,n)=>{a.default.callRemoteFunction(r.RemoteFunction.pushFeedback,e)?t():n()}))}_traceName(){return"PushService"}}t.PushService=o,o._pushPromises={}},1150:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.LogManager=t.Logger=t.ClientState=t.LogCategory=t.LogLevel=void 0,function(e){e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARNING=2]="WARNING",e[e.INFO=3]="INFO",e[e.TRACE=4]="TRACE"}(n=t.LogLevel||(t.LogLevel={})),function(e){e[e.SIGNALING=0]="SIGNALING",e[e.RTC=1]="RTC",e[e.USERMEDIA=2]="USERMEDIA",e[e.CALL=3]="CALL",e[e.CALLEXP2P=4]="CALLEXP2P",e[e.CALLEXSERVER=5]="CALLEXSERVER",e[e.CALLMANAGER=6]="CALLMANAGER",e[e.CLIENT=7]="CLIENT",e[e.AUTHENTICATOR=8]="AUTHENTICATOR",e[e.PCFACTORY=9]="PCFACTORY",e[e.UTILS=10]="UTILS",e[e.ORTC=11]="ORTC",e[e.MESSAGING=12]="MESSAGING",e[e.REINVITEQ=13]="REINVITEQ",e[e.HARDWARE=14]="HARDWARE",e[e.ENDPOINT=15]="ENDPOINT",e[e.EVENTTARGET=16]="EVENTTARGET",e[e.VSM=17]="VSM"}(r=t.LogCategory||(t.LogCategory={})),function(e){e[e.DISCONNECTED="DISCONNECTED"]="DISCONNECTED",e[e.CONNECTING="CONNECTING"]="CONNECTING",e[e.CONNECTED="CONNECTED"]="CONNECTED",e[e.LOGGING_IN="LOGGING_IN"]="LOGGING_IN",e[e.LOGGED_IN="LOGGED_IN"]="LOGGED_IN"}(t.ClientState||(t.ClientState={}));class i{constructor(e,t,n){this.category=e,this.label=t,this.provider=n}log(e,t){this.provider.writeMessage(this.category,this.label,e,t)}error(e){this.log(n.ERROR,e)}warning(e){this.log(n.WARNING,e)}info(e){this.log(n.INFO,e)}trace(e){this.log(n.TRACE,e)}}t.Logger=i;class a{constructor(){this.timeOriginGap=0,this.isFirstPrint=!0,this.levels={},this.showTrace=!1,this._shadowLogging=!1}get shadowLogging(){return this._shadowLogging}set shadowLogging(e){this._shadowLogging||(this._shadowLog=[]),this._shadowLogging=e}static get(){return void 0===this.inst&&(this.inst=new a,this.inst.prettyPrint=!1),this.inst}static d_trace(e){return(t,r,i)=>({value:function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];const c="login"===r||"basicLogin"===r||"sendWSMessage"===r&&"login"===s[0],d="sendWSMessage"===r?2:1,u=t._traceName?"".concat(t._traceName()).concat(this&&this.settings?" ".concat(this.settings.id):this&&this.id&&"function"!=typeof this.id?" ".concat(this.id):""):"";let g="";try{g=s.map(((e,t)=>c&&t===d?'"********"':JSON.stringify(e))).join()}catch(e){g="circular structure"}return a.get().writeMessage(e,u,n.TRACE,"".concat(r,"(").concat(g,")")),i.value.apply(this,s)}})}getSLog(){return this._shadowLog}clearSilentLog(){this._shadowLog=[]}setLoggerCallback(e){this._outerCallback=e}setPrettyPrint(e){this.prettyPrint=e}setLogLevel(e,t){t===n.TRACE?this.showTrace=!0:this.levels[r[e]]=t}writeMessage(e,t,i,o){i===n.TRACE?a.traceTick++:a.logTick++,this.timeOriginGap||(this.timeOriginGap=performance.now());const s="string"==typeof o?o:JSON.stringify(o),l=this.isFirstPrint?this.prettyPrint?(new Date).toUTCString():(new Date).toString():parseInt(""+(performance.now()-this.timeOriginGap)/1e3),c=i===n.TRACE?"VIWSTR ".concat(a.traceTick):"VIWSLR ".concat(a.logTick),d="".concat(c," ").concat(l," ").concat(n[i]," ").concat(t,": ").concat(s);if(i<=(void 0!==this.levels[r[e]]?this.levels[r[e]]:n.NONE)||i===n.TRACE&&this.showTrace){if(void 0!==console.debug&&void 0!==console.info&&void 0!==console.error&&void 0!==console.warn)if(this.prettyPrint){const e="%c".concat(c," ").concat(l," [").concat(n[i],"] %c").concat(t,": %c").concat(s),r={[n.ERROR]:"color:#fab005",[n.WARNING]:"color:#af2a2a",[n.INFO]:"color:#0ca678",[n.TRACE]:"color:#8f66ff"};i===n.ERROR?console.error(d):i===n.WARNING?console.warn(e,r[i],"color:#2375a2","color:#000"):i===n.INFO?console.info(e,r[i],"color:#2375a2","color:#000"):i===n.TRACE?console.debug(e,r[i],"color:#2375a2","color:#000"):console.log(e,r[i],"color:#2375a2","color:#000")}else i===n.ERROR?console.error(d):i===n.WARNING?console.warn(d):i===n.INFO?console.info(d):i===n.TRACE?console.debug(d):console.log(d);else console.log(d);this.isFirstPrint&&(this.isFirstPrint=!1)}this.shadowLogging&&(i!==n.TRACE||this.showTrace)&&this._shadowLog.push(d),"function"!=typeof this._outerCallback||i===n.TRACE&&!this.showTrace||this._outerCallback({formattedText:d,category:e,label:t,level:i,message:s})}createLogger(e,t){return new i(e,t,this)}_traceName(){return"Logger"}}t.LogManager=a,a.logTick=0,a.traceTick=0},164:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginState=void 0,function(e){e[e.LOGGED_OFF=0]="LOGGED_OFF",e[e.LOGGING_IN=1]="LOGGING_IN",e[e.LOGGED_IN=2]="LOGGED_IN"}(t.LoginState||(t.LoginState={}))},1450:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaRenderDisablingReason=void 0,function(e){e.Automatic="automatic",e.Manual="manual"}(t.MediaRenderDisablingReason||(t.MediaRenderDisablingReason={}))},7222:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.MediaRenderer=void 0;const i=n(3869),a=n(125),o=n(1150),s=n(2957),l=n(2282),c=n(141),d=n(7272),u=n(8597),g=n(6980);class f{constructor(e){this._playElemLock=0,this._encodedStreams=[],this._enabled=!0,this.isRemoving=!1,this._receiverTransform=s.Utils.getDefaultStreamTransformer();const{stream:t,kind:n,placeOnDom:r,isLocal:l,deprecatedId:c,transceivers:u,mids:g}=e;if(this.transceivers=u,this.stream=t,this.kind=n,this.mids=g,this.placeOnDom=r||!1,this.isLocal=l||!1,void 0===this.kind&&(this.kind=t.getVideoTracks().length?"video":"audio"),this._id=s.Utils.generateUUID(),this.logger=o.LogManager.get().createLogger(o.LogCategory.USERMEDIA,this._traceName()),this.stream.getTracks().forEach((e=>{e.onended=()=>{this.checkStreamActive(t)}})),this.stream.getTracks().length){if(this.element=document.getElementById(this.stream.getTracks()[0].id)||document.createElement("sharing"===this.kind?"video":this.kind),this.element.autoplay=!0,this.isLocal&&(this.element.muted=!0),this.element.setAttribute("playsinline",null),c?document.getElementById("voximplantlocalvideo")?this.element.id=this.stream.getTracks()[0].id:this.element.id="voximplantlocalvideo":this.element.id=this.stream.getTracks()[0].id,"audio"!==n)this.stream.getAudioTracks().length||(this.element.muted=!0);else{const e=d.default.AudioDeviceManager.get().getDefaultAudioSettings();e.outputId&&"function"==typeof this.element.setSinkId&&this.element.setSinkId("").then((()=>{this.element.setSinkId(e.outputId+"")})).catch((()=>{this.element.setSinkId(e.outputId+"")}))}i.default.attachMedia(this),this.placeOnDom&&this.renderDefault()}a.Client.getInstance().isInsertableStreamsSupported()&&this.transceivers.length&&this.transceivers.forEach((e=>{const t=e.receiver.createEncodedStreams();this._encodedStreams.push(t)}))}checkStreamActive(e){e.getTracks().some((e=>"live"===e.readyState))||this.clear()}get id(){return this._id}renderDefault(){const e=a.Client.getInstance(),t=this.isLocal?e.config().localVideoContainerId:e.config().remoteVideoContainerId,n=document.getElementById(t);this.render(n)}get enabled(){const e=g.VideoStatusMachineMediator.retrieveVSMByMediaRenderer(this);return e?"enabled"===e.value:this._enabled}enable(){if(!this.transceivers.length)throw Error("Transceiver list is empty");this.makeVideoStatusTransition("enable"),this._enabled=!0,this.conferenceEpManagerUpdateState&&this.conferenceEpManagerUpdateState()}disable(){if(!this.transceivers.length)throw Error("Transceiver list is empty");this.makeVideoStatusTransition("disable"),this._enabled=!1,this.conferenceEpManagerUpdateState&&this.conferenceEpManagerUpdateState()}requestVideoSize(e,t){return this.transceivers.length?(this.videoSize={width:e,height:t},this.conferenceEpManagerUpdateRenderSize(),Promise.resolve()):Promise.reject()}render(e){if(this.logger.info("render() id: ".concat(this._id," to ").concat(e?e.tagName.toLowerCase():"no_container"," #").concat(e?e.id:"no_container"," class ").concat(e?e.className:"no_container")),!(a.Client.getInstance().config()&&a.Client.getInstance().config().experiments&&a.Client.getInstance().config().experiments.preventRendering))if(e&&("video"===e.tagName.toLowerCase()&&"audio"!==this.kind||"audio"===e.tagName.toLowerCase()&&"audio"===this.kind))this.isElementCreated=!1,this.element=e,i.default.attachMedia(this),this.addListeners();else{this.isElementCreated=!0;const t=e||document.body;void 0!==this.element.parentElement&&null!==this.element.parentElement?this.element.parentElement&&this.element.parentElement.removeChild(this.element):this.element.parentNode&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),t.appendChild(this.element),this.addListeners()}}addListeners(){this.element.addEventListener("canplaythrough",this.onCanplaythrough.bind(this)),this.element.addEventListener("error",(e=>this.logger.info("An error occurred during the loading of an ".concat(this.kind," for ").concat(JSON.stringify(this.mids),": ").concat(JSON.stringify(e))))),this.element.addEventListener("abort",(()=>this.logger.info("The loading of an ".concat(this.kind," for ").concat(JSON.stringify(this.mids)," is aborted.")))),this.element.addEventListener("stalled",(()=>{this.logger.info("Failed to fetch data, but trying for ".concat(this.kind," ").concat(JSON.stringify(this.mids)))})),this.element.addEventListener("suspend",(()=>{this.logger.info("The media ".concat(this.kind," for ").concat(JSON.stringify(this.mids)," was suspended."))}))}onCanplaythrough(){this.element&&(this.playElement(),this.element.onpause=this.playElement)}replaceVideo(e){e?(this.stream=e,this.element?i.default.attachMedia(this):this.logger.info("replaceVideo(): replacing video has failed: DOM element is undefined")):this.logger.error("replaceVideo(): replacing video has failed: a mediastream is not provided")}makeVideoStatusTransition(e){const t=g.VideoStatusMachineMediator.retrieveVSMByMediaRenderer(this);if(t){const n="".concat(e.toUpperCase(),"_VIDEO");if(!g.VideoStatusMachineMediator.makeTransition(t,n)){const n=t.value.replace(/([a-z])([A-Z])/g,"$1 $2").toLowerCase();throw Error("Cannot ".concat(e," the media renderer due to the one is already ").concat(n))}}}clear(){this.isRemoving?this.logger.info("MediaRendered ID: already removing ".concat(this._id,". Ignored.")):(this.isRemoving=!0,this.onBeforeDestroy&&this.onBeforeDestroy(),this.element&&(this.element.removeEventListener("canplaythrough",this.onCanplaythrough),i.default.detachMedia(this),this.isElementCreated&&(this.element.id="",void 0!==this.element.parentElement&&null!==this.element.parentElement?this.element.parentElement&&this.element.parentElement.removeChild(this.element):this.element.parentNode&&this.element.parentNode&&this.element.parentNode.removeChild(this.element))),this.onDestroy&&this.onDestroy())}setVolume(e){this.logger.info("setVolume(".concat(e,")")),this.element&&(this.element.volume=e)}async useAudioOutput(e){if(this.logger.info("useAudioOutput(".concat(e,") on MediaRenderer ").concat(this.kind)),"audio"===this.kind)try{"function"==typeof this.element.setSinkId?await this.element.setSinkId(e):this.logger.warning("Set audio output is impossible. Browser doesn't support this option.")}catch(e){this.logger.error("useAudioOutput(): error has occurred on MR with kind ".concat(this.kind," ").concat(s.Utils.stringifyError(e)))}else this.logger.info("useAudioOutput(): media renderer with kind ".concat(this.kind," has been skipped. Only audio media renderers support this function"))}_traceName(){return"MediaRenderer"}playElement(){this.element&&this.element.paused&&this.element.readyState>3&&(this.logger.info("MediaRenderer ID:".concat(this._id," for ").concat(JSON.stringify(this.mids)," is trying to play")),this.element.play().catch((e=>{this.logger.warning("Can't start playing MediaRenderer ID:".concat(this._id,". ").concat(e.message)),a.Client.getInstance().dispatchEvent({name:c.Events.PlaybackError,element:this.element,error:e})})))}pauseElement(){if(0===this._playElemLock||this._playElemLock>10)if(this.element instanceof HTMLVideoElement){let e=this.element.pause();void 0!==e&&e.catch((e=>{}))}else this.element.pause();else this._playElemLock+=1,setTimeout(this.pauseElement,400)}notifyAboutCreation(e,t){t.wasAdded?(t.dispatchEvent({name:u.EndpointEvents.RemoteMediaAdded,call:e,endpoint:t,mediaRenderer:this}),e.dispatchEvent({name:l.CallEvents.MediaElementCreated,call:e,stream:this.stream,element:this.element,type:this.kind})):setTimeout((()=>this.notifyAboutCreation(e,t)),400)}get receiverTransform(){return this._receiverTransform}set receiverTransform(e){this._receiverTransform=e,this._encodedStreams.forEach((e=>{e.readable.pipeThrough(this._receiverTransform).pipeTo(e.writable)}))}}r([o.LogManager.d_trace(o.LogCategory.USERMEDIA)],f.prototype,"checkStreamActive",null),r([o.LogManager.d_trace(o.LogCategory.USERMEDIA)],f.prototype,"renderDefault",null),r([o.LogManager.d_trace(o.LogCategory.USERMEDIA)],f.prototype,"render",null),r([o.LogManager.d_trace(o.LogCategory.USERMEDIA)],f.prototype,"clear",null),r([o.LogManager.d_trace(o.LogCategory.USERMEDIA)],f.prototype,"setVolume",null),r([o.LogManager.d_trace(o.LogCategory.USERMEDIA)],f.prototype,"useAudioOutput",null),t.MediaRenderer=f},1316:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaRenderResolver=void 0;const n=["video","sharing"],r=["audio"];t.MediaRenderResolver=class{static isVideoMR(e){return n.includes(e.kind)}static isAudioMR(e){return r.includes(e.kind)}static retrieveVideoMR(e){return e.find(this.isVideoMR)}static retrieveAudioMR(e){return e.find(this.isAudioMR)}}},6054:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Messaging=void 0;const r=n(7250),i=n(311),a=n(8635);var o;!function(e){e.getInstance=function(){return t.getInstance()};class t extends r.Messenger{}e.Messenger=t;class n extends i.Conversation{}e.Conversation=n;class o extends a.Message{}let s,l,c;e.Message=o,function(e){e.UNKNOWN="UNKNOWN",e.createConversation="createConversation",e.editConversation="editConversation",e.removeConversation="removeConversation",e.joinConversation="joinConversation",e.leaveConversation="leaveConversation",e.getConversation="getConversation",e.getConversations="getConversations",e.getPublicConversations="getPublicConversations",e.searchConversations="searchConversations",e.removeEmptyConversation="removeEmptyConversation",e.addParticipants="addParticipants",e.editParticipants="editParticipants",e.removeParticipants="removeParticipants",e.getUser="getUser",e.getUsers="getUsers",e.editUser="editUser",e.setStatus="setStatus",e.sendMessage="sendMessage",e.editMessage="editMessage",e.removeMessage="removeMessage",e.typingMessage="typingMessage",e.isRead="isRead",e.subscribe="subscribe",e.unsubscribe="unsubscribe",e.manageNotification="manageNotification",e.getSubscriptionList="getSubscriptionList",e.createBot="createBot",e.removeBot="removeBot",e.retransmitEvents="retransmitEvents"}(s=e.MessengerAction||(e.MessengerAction={})),function(e){e.CreateConversation="CreateConversation",e.EditConversation="EditConversation",e.RemoveConversation="RemoveConversation",e.GetConversation="GetConversation",e.GetPublicConversations="GetPublicConversations",e.SendMessage="SendMessage",e.EditMessage="EditMessage",e.RemoveMessage="RemoveMessage",e.Typing="Typing",e.EditUser="EditUser",e.GetUser="GetUser",e.Error="Error",e.RetransmitEvents="RetransmitEvents",e.Read="Read",e.Subscribe="Subscribe",e.Unsubscribe="Unsubscribe",e.SetStatus="SetStatus",e.GetSubscriptionList="GetSubscriptionList",e.CreateBot="CreateBot",e.RemoveBot="RemoveBot"}(l=e.MessengerEvents||(e.MessengerEvents={})),function(e){e[e.Error_0=0]="Error_0",e[e.Error_1=1]="Error_1",e[e.Error_2=2]="Error_2",e[e.Error_3=3]="Error_3",e[e.Error_8=8]="Error_8",e[e.Error_10=10]="Error_10",e[e.Error_11=11]="Error_11",e[e.Error_12=12]="Error_12",e[e.Error_13=13]="Error_13",e[e.Error_15=15]="Error_15",e[e.Error_16=16]="Error_16",e[e.Error_18=18]="Error_18",e[e.Error_19=19]="Error_19",e[e.Error_21=21]="Error_21",e[e.Error_22=22]="Error_22",e[e.Error_23=23]="Error_23",e[e.Error_24=24]="Error_24",e[e.Error_25=25]="Error_25",e[e.Error_26=26]="Error_26",e[e.Error_28=28]="Error_28",e[e.Error_30=30]="Error_30",e[e.Error_32=32]="Error_32",e[e.Error_33=33]="Error_33",e[e.Error_34=34]="Error_34",e[e.Error_35=35]="Error_35",e[e.Error_36=36]="Error_36",e[e.Error_37=37]="Error_37",e[e.Error_38=38]="Error_38",e[e.Error_39=39]="Error_39",e[e.Error_40=40]="Error_40",e[e.Error_41=41]="Error_41",e[e.Error_42=42]="Error_42",e[e.Error_43=43]="Error_43",e[e.Error_500=500]="Error_500"}(c=e.MessengerError||(e.MessengerError={}))}(o=t.Messaging||(t.Messaging={})),t.default=o},311:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.Conversation=void 0;const i=n(1150),a=n(7250),o=n(1855),s=n(8635),l=n(7050),c=n(8202),d=n(6968),u=n(6054);class g{constructor(e){this._backup={},this._uuid=e.uuid,this._participants=e.participants,this._title=e.title,this._direct=e.direct,this._publicJoin=e.publicJoin,this._uberConversation=e.uberConversation,this._customData=e.customData,this._createdAt=e.createdAt,this._lastUpdate=e.lastUpdate,this._lastSeq=Number(e.lastSeq)}get uuid(){return this._uuid}get title(){return this._title}set title(e){this._backup.title=this._title,this._title=e}get createdAt(){return this._createdAt}get lastUpdate(){return this._lastUpdate}get direct(){return this._direct}get uberConversation(){return this._uberConversation}get publicJoin(){return this._publicJoin}set publicJoin(e){this._backup.publicJoin=this._publicJoin,this._publicJoin=e}get participants(){return this._participants}get customData(){return this._customData}set customData(e){this._backup.customData=this._customData,this._customData=e}get lastSeq(){return this._lastSeq}updateSeq(e){"number"==typeof e&&e>this._lastSeq&&(this._lastSeq=e),this._lastUpdate=Date.now()/1e3|0}static _createFromBus(e,t){return new g({participants:e.participants&&Array.isArray(e.participants)?e.participants.map((e=>{const t=Number(e.flags)===d.MsgPermissions.all,n=Number(e.flags)>d.MsgPermissions.is_owner&&e.flags<d.MsgPermissions.all,r=Number(e.flags).toString(2).slice(-6).split("").reverse();return{userId:Number(e.user_id),lastRead:e.last_read,isOwner:t||n,canWrite:t||"1"===r[0],canEdit:t||"1"===r[1],canRemove:t||"1"===r[2],canManageParticipants:t||"1"===r[3],canEditAll:t||"1"===r[4],canRemoveAll:t||"1"===r[5]}})):[],title:e.title,uuid:e.uuid,direct:e.direct,publicJoin:e.enable_public_join,uberConversation:e.uber_conversation,createdAt:e.created_at,lastUpdate:e.last_update,lastSeq:t,customData:e.custom_data&&"object"==typeof e.custom_data?e.custom_data:void 0})}static createFromCache(e){return new g({uuid:e.uuid,title:e.title,participants:e.participants||[],direct:e.direct,publicJoin:e.publicJoin,uberConversation:e.uberConversation,createdAt:e.createdAt,lastUpdate:e.lastUpdate,customData:e.customData})}toCache(){return{uuid:this._uuid,title:this._title,participants:this._participants,direct:this._direct,publicJoin:this._publicJoin,uberConversation:this._uberConversation,createdAt:this._createdAt,lastUpdate:this._lastUpdate,customData:this._customData,lastSeq:this._lastSeq}}_getCreatePayload(){return{participants:this._prepareParticipants(this._participants).map((e=>Object.assign(e,{flags:e.flags?e.flags:7}))),title:"string"==typeof this._title?this._title:"",direct:"boolean"==typeof this._direct&&this._direct,enable_public_join:"boolean"==typeof this._publicJoin&&this._publicJoin,uber_conversation:"boolean"==typeof this._uberConversation?this._uberConversation:void 0,custom_data:"object"==typeof this._customData?this._customData:{}}}_getEditPayload(){if(void 0===this._uuid)throw Error("You must get conversation UUID with MessengetAction.getConversation() action!");return{uuid:this._uuid,title:"string"==typeof this._title?this._title:"",enable_public_join:"boolean"==typeof this._publicJoin&&this._publicJoin,custom_data:"object"==typeof this._customData?this._customData:{}}}_getUserPermissions(e){const t=(e.isOwner?"1000000000":"")+[e.canRemoveAll,e.canEditAll,e.canManageParticipants,e.canRemove,e.canEdit,e.canWrite].map((e=>e?1:0)).join("");return parseInt(t,2)}_prepareParticipants(e){return e.map((e=>({user_id:e.userId,flags:this._getUserPermissions(e),last_read:e.lastRead})))}_revertChanges(){Object.keys(this._backup).forEach((e=>{this[e]=this._backup[e]})),this._backup={}}update(){return o.default.get().editConversation(this)}setTitle(e){return"string"!=typeof e?a.Messenger.getInstance().reject(u.default.MessengerError.Error_0,u.default.MessengerAction.editConversation):(this._backup.title=this._title,this._title=e,o.default.get().editConversation(this))}setPublicJoin(e){return"boolean"!=typeof e?a.Messenger.getInstance().reject(u.default.MessengerError.Error_0,u.default.MessengerAction.editConversation):(this._backup.publicJoin=this._publicJoin,this._publicJoin=e,o.default.get().editConversation(this))}setCustomData(e){return!e||Array.isArray(e)||"object"!=typeof e?a.Messenger.getInstance().reject(u.default.MessengerError.Error_0,u.default.MessengerAction.editConversation):(this._backup.customData=this._customData,this._customData=e,o.default.get().editConversation(this))}addParticipants(e){return Array.isArray(e)&&0!=e.length?new Promise(((t,n)=>{const r=l.MsgSignaling.get().sendWsMessage(c.MsgAction.addParticipants,{uuid:this._uuid,participants:this._prepareParticipants(e)});a.Messenger.getInstance()._registerPromise(r,t,n)})):a.Messenger.getInstance().reject(u.default.MessengerError.Error_0,u.default.MessengerAction.addParticipants)}editParticipants(e){return Array.isArray(e)&&0!=e.length?new Promise(((t,n)=>{const r=l.MsgSignaling.get().sendWsMessage(c.MsgAction.editParticipants,{uuid:this._uuid,participants:this._prepareParticipants(e)});a.Messenger.getInstance()._registerPromise(r,t,n)})):a.Messenger.getInstance().reject(u.default.MessengerError.Error_0,u.default.MessengerAction.editParticipants)}removeParticipants(e){return Array.isArray(e)&&0!=e.length?new Promise(((t,n)=>{const r=l.MsgSignaling.get().sendWsMessage(c.MsgAction.removeParticipants,{uuid:this._uuid,participants:e.filter((e=>void 0!==e.userId)).map((e=>e.userId))});a.Messenger.getInstance()._registerPromise(r,t,n)})):a.Messenger.getInstance().reject(u.default.MessengerError.Error_0,u.default.MessengerAction.removeParticipants)}sendMessage(e,t){return"string"!=typeof e?a.Messenger.getInstance().reject(u.default.MessengerError.Error_0,u.default.MessengerAction.sendMessage):new s.Message(e,t).sendTo(this)}typing(){return this._debounceLock?Promise.resolve(!1):(setTimeout((()=>{this._debounceLock=!1}),1e4),this._debounceLock=!0,new Promise(((e,t)=>{const n=l.MsgSignaling.get().sendWsMessage(c.MsgAction.typingMessage,{conversation:this._uuid});a.Messenger.getInstance()._registerPromise(n,e,t)})))}markAsRead(e){return new Promise(((t,n)=>{const r=l.MsgSignaling.get().sendWsMessage(c.MsgAction.isRead,{conversation:this._uuid,seq:e});a.Messenger.getInstance()._registerPromise(r,t,n)}))}retransmitEvents(e,t,n){return"number"!=typeof t||"number"!=typeof e?a.Messenger.getInstance().reject(u.default.MessengerError.Error_0,u.default.MessengerAction.retransmitEvents):new Promise(((r,i)=>{let o,s,d;Promise.all(Array(t-e+1).fill(0).map(((t,n)=>n+e)).map((e=>new Promise(((t,n)=>{const r=n=>{n.events&&n.events[0]&&Number(n.events[0].seq)===e&&n.requestUuid===o&&(clearTimeout(l),a.Messenger.getInstance().off(u.default.MessengerEvents.RetransmitEvents,r),a.Messenger.getInstance().off(u.default.MessengerEvents.Error,i),s||(s=n.initiator),d||(d=n.messengerAction),t(n.events[0]))},i=t=>{t.messengerAction==u.default.MessengerAction.retransmitEvents&&t.events&&t.events[0]&&Number(t.events[0].seq)===e&&(clearTimeout(l),a.Messenger.getInstance().off(u.default.MessengerEvents.RetransmitEvents,r),a.Messenger.getInstance().off(u.default.MessengerEvents.Error,i),n(t))},l=setTimeout((()=>{a.Messenger.getInstance().off(u.default.MessengerEvents.RetransmitEvents,r),a.Messenger.getInstance().off(u.default.MessengerEvents.Error,i),a.Messenger.getInstance().reject(u.default.MessengerError.Error_0,u.default.MessengerAction.retransmitEvents).catch(n)}),a.Messenger.rejectTimeout);a.Messenger.getInstance().on(u.default.MessengerEvents.RetransmitEvents,r),a.Messenger.getInstance().on(u.default.MessengerEvents.Error,i)}))))).then((e=>r({initiator:s,messengerAction:d,events:e,requestUuid:o}))).catch(i),o=l.MsgSignaling.get().sendWsMessage(c.MsgAction.retransmitEvents,{conversation:this._uuid,events_from:0|e,events_to:0|t,count:n})}))}_traceName(){return"Conversation"}}r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"updateSeq",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"toCache",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"_getCreatePayload",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"_getEditPayload",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"_prepareParticipants",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"_revertChanges",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"update",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"addParticipants",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"editParticipants",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"removeParticipants",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"typing",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"markAsRead",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g.prototype,"retransmitEvents",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g,"_createFromBus",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],g,"createFromCache",null),t.Conversation=g},1855:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=n(7050),a=n(7250),o=n(311),s=n(8635),l=n(1150),c=n(6054),d=n(249),u=n(6623),g=n(8202);class f{constructor(){if(f.instance)throw new Error(u.MESSAGING_ERR_2);this.signalling=i.MsgSignaling.get(),this.signalling.addEventListener(d.MsgEvent.onCreateConversation,((e,t)=>{this.resolveEvent(e,c.default.MessengerEvents.CreateConversation,t)})),this.signalling.addEventListener(d.MsgEvent.onEditConversation,((e,t)=>{this.resolveEvent(e,c.default.MessengerEvents.EditConversation,t)})),this.signalling.addEventListener(d.MsgEvent.onRemoveConversation,((e,t)=>{a.Messenger.getInstance()._dispatchEvent(c.default.MessengerEvents.RemoveConversation,{uuid:e.object.uuid,seq:e.seq,messengerAction:c.default.MessengerAction[e.on_incoming_event],initiator:Number(e.initiator),timestamp:"number"==typeof e.timestamp?1e3*e.timestamp:void 0,requestUuid:t},t)})),this.signalling.addEventListener(d.MsgEvent.onGetConversation,((e,t)=>{this.resolveEvent(e,c.default.MessengerEvents.GetConversation,t)})),this.signalling.addEventListener(d.MsgEvent.onGetPublicConversations,((e,t)=>{a.Messenger.getInstance()._dispatchEvent(c.default.MessengerEvents.GetPublicConversations,{conversations:e.object.uuid,initiator:Number(e.initiator),messengerAction:c.default.MessengerAction[e.on_incoming_event],requestUuid:t},t)})),this.signalling.addEventListener(d.MsgEvent.onSendMessage,((e,t)=>{this.resolveMessageEvent(e,c.default.MessengerEvents.SendMessage,t)})),this.signalling.addEventListener(d.MsgEvent.onEditMessage,((e,t)=>{this.resolveMessageEvent(e,c.default.MessengerEvents.EditMessage,t)})),this.signalling.addEventListener(d.MsgEvent.onRemoveMessage,((e,t)=>{this.resolveMessageEvent(e,c.default.MessengerEvents.RemoveMessage,t)})),this.signalling.addEventListener(d.MsgEvent.isRead,((e,t)=>{a.Messenger.getInstance()._dispatchEvent(c.default.MessengerEvents.Read,{conversation:e.object.conversation,seq:e.object.seq,initiator:Number(e.initiator),messengerAction:c.default.MessengerAction[e.on_incoming_event],requestUuid:t},t)})),this.signalling.addEventListener(d.MsgEvent.onTyping,((e,t)=>{a.Messenger.getInstance()._dispatchEvent(c.default.MessengerEvents.Typing,{conversation:e.object.conversation,initiator:Number(e.initiator),messengerAction:c.default.MessengerAction[e.on_incoming_event],requestUuid:t},t)})),this.signalling.addEventListener(d.MsgEvent.onRetransmitEvents,((e,t)=>{a.Messenger.getInstance()._dispatchEvent(c.default.MessengerEvents.RetransmitEvents,{events:[e.object&&e.object.event?-1==e.object.event.indexOf("Message")&&e.object.payload?{conversation:o.Conversation._createFromBus(e.object.payload.object,e.object.payload.seq),initiator:Number(e.object.payload.initiator),seq:e.object.payload.seq,messengerAction:c.default.MessengerAction[e.object.payload.on_incoming_event],timestamp:"number"==typeof e.object.payload.timestamp?1e3*e.object.payload.timestamp:void 0}:{message:s.Message._createFromBus(e.object.payload.object,Number(e.object.payload.initiator)),initiator:Number(e.object.payload.initiator),seq:e.object.payload.seq,timestamp:"number"==typeof e.object.payload.timestamp?1e3*e.object.payload.timestamp:void 0,messengerAction:c.default.MessengerAction[e.object.payload.on_incoming_event]}:void 0],initiator:Number(e.initiator),messengerAction:c.default.MessengerAction[e.on_incoming_event],requestUuid:t},t)}))}static get(){return f.instance=f.instance||new f,f.instance}resolveEvent(e,t,n){const r=o.Conversation._createFromBus(e.object,e.seq);void 0!==r&&r.updateSeq(e.seq),a.Messenger.getInstance()._dispatchEvent(t,{conversation:r,initiator:Number(e.initiator),seq:e.seq,messengerAction:c.default.MessengerAction[e.on_incoming_event],timestamp:"number"==typeof e.timestamp?1e3*e.timestamp:void 0,requestUuid:n},n)}resolveMessageEvent(e,t,n){const r=s.Message._createFromBus(e.object,Number(e.initiator));a.Messenger.getInstance()._dispatchEvent(t,{message:r,initiator:Number(e.initiator),seq:e.seq,messengerAction:c.default.MessengerAction[e.on_incoming_event],timestamp:"number"==typeof e.timestamp?1e3*e.timestamp:void 0},n)}static deserialize(e){return o.Conversation.createFromCache(e)}static serialize(e){return e.toCache()}createConversation(e,t,n,r,i,s){return new Promise(((l,c)=>{const d=this.signalling.sendWsMessage(g.MsgAction.createConversation,new o.Conversation({participants:e,title:t,direct:n,publicJoin:r,customData:s,uberConversation:i})._getCreatePayload());a.Messenger.getInstance()._registerPromise(d,l,c)}))}editConversation(e){return new Promise(((t,n)=>{let r;const i=e=>{e.requestUuid===r&&(clearTimeout(s),a.Messenger.getInstance().off(c.default.MessengerEvents.EditConversation,i),a.Messenger.getInstance().off(c.default.MessengerEvents.Error,o),t(e))},o=t=>{t.requestUuid===r&&(clearTimeout(s),a.Messenger.getInstance().off(c.default.MessengerEvents.EditConversation,i),a.Messenger.getInstance().off(c.default.MessengerEvents.Error,o),e._revertChanges(),n(t))},s=setTimeout((()=>{a.Messenger.getInstance().off(c.default.MessengerEvents.EditConversation,i),a.Messenger.getInstance().off(c.default.MessengerEvents.Error,o),a.Messenger.getInstance().reject(c.default.MessengerError.Error_0,c.default.MessengerAction.editConversation).catch(n)}),a.Messenger.rejectTimeout);a.Messenger.getInstance().on(c.default.MessengerEvents.EditConversation,i),a.Messenger.getInstance().on(c.default.MessengerEvents.Error,o),r=this.signalling.sendWsMessage(g.MsgAction.editConversation,e._getEditPayload())}))}getConversation(e){return new Promise(((t,n)=>{const r=this.signalling.sendWsMessage(g.MsgAction.getConversation,{uuid:e});a.Messenger.getInstance()._registerPromise(r,t,n)}))}getConversations(e){if(!Array.isArray(e))return a.Messenger.getInstance().reject(c.default.MessengerError.Error_0,c.default.MessengerAction.getConversations);let t;const n=Promise.all(e.map((e=>new Promise(((n,r)=>{const i=r=>{r.requestUuid===t&&r.conversation.uuid===e&&(clearTimeout(s),a.Messenger.getInstance().off(c.default.MessengerEvents.GetConversation,i),a.Messenger.getInstance().off(c.default.MessengerEvents.Error,o),n(r))},o=e=>{e.requestUuid===t&&(clearTimeout(s),a.Messenger.getInstance().off(c.default.MessengerEvents.GetConversation,i),a.Messenger.getInstance().off(c.default.MessengerEvents.Error,o),r(e))},s=setTimeout((()=>{a.Messenger.getInstance().off(c.default.MessengerEvents.GetConversation,i),a.Messenger.getInstance().off(c.default.MessengerEvents.Error,o),a.Messenger.getInstance().reject(c.default.MessengerError.Error_0,c.default.MessengerAction.getConversation).catch(r)}),a.Messenger.rejectTimeout);a.Messenger.getInstance().on(c.default.MessengerEvents.GetConversation,i),a.Messenger.getInstance().on(c.default.MessengerEvents.Error,o)})))));return t=this.signalling.sendWsMessage(g.MsgAction.getConversations,{uuid:e}),n}getPublicConversations(){return new Promise(((e,t)=>{const n=this.signalling.sendWsMessage(g.MsgAction.getPublicConversations,{});a.Messenger.getInstance()._registerPromise(n,e,t)}))}static extractUserName(e){if(-1===e.indexOf("@"))return e;{const t=e.split("@");return t[1]=t[1].split(".").splice(0,2).join("."),t.join("@")}}_traceName(){return"ConversationManager"}}r([l.LogManager.d_trace(l.LogCategory.MESSAGING)],f.prototype,"resolveEvent",null),r([l.LogManager.d_trace(l.LogCategory.MESSAGING)],f.prototype,"resolveMessageEvent",null),r([l.LogManager.d_trace(l.LogCategory.MESSAGING)],f.prototype,"createConversation",null),r([l.LogManager.d_trace(l.LogCategory.MESSAGING)],f.prototype,"editConversation",null),r([l.LogManager.d_trace(l.LogCategory.MESSAGING)],f.prototype,"getConversation",null),r([l.LogManager.d_trace(l.LogCategory.MESSAGING)],f.prototype,"getConversations",null),r([l.LogManager.d_trace(l.LogCategory.MESSAGING)],f.prototype,"getPublicConversations",null),r([l.LogManager.d_trace(l.LogCategory.MESSAGING)],f,"get",null),r([l.LogManager.d_trace(l.LogCategory.MESSAGING)],f,"deserialize",null),r([l.LogManager.d_trace(l.LogCategory.MESSAGING)],f,"serialize",null),r([l.LogManager.d_trace(l.LogCategory.MESSAGING)],f,"extractUserName",null),t.default=f},8635:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.Message=void 0;const i=n(1150),a=n(7050),o=n(8202),s=n(7250);class l{constructor(e,t){this._text=e,void 0!==t&&Array.isArray(t)&&t.every((e=>e&&"object"==typeof e))?this._payload=t:this._payload=[]}get uuid(){return this._uuid}get conversation(){return this._conversation}get text(){return this._text}set text(e){this._text=e}get payload(){return this._payload}set payload(e){this._payload=e}get sender(){return this._sender}static _createFromBus(e,t){let n=new l(e.text,e.payload);return n._uuid=e.uuid,n._conversation=e.conversation,n._sender=t,n}static createFromCache(e){let t=new l(e.text,e.payload);return t._uuid=e.uuid,t._conversation=e.conversation,t._sender=Number(e.sender),t}toCache(){return{uuid:this._uuid,text:this._text,payload:this._payload,conversation:this._conversation,sender:this._sender}}getPayload(){let e={text:this._text,conversation:this._conversation};return void 0!==this._payload&&Array.isArray(this._payload)&&this._payload.every((e=>"object"==typeof e))?e.payload=this._payload:e.payload=[],e}sendTo(e){return this._conversation=e.uuid,new Promise(((e,t)=>{const n=a.MsgSignaling.get().sendWsMessage(o.MsgAction.sendMessage,this.getPayload());s.Messenger.getInstance()._registerPromise(n,e,t)}))}update(){return new Promise(((e,t)=>{const n=a.MsgSignaling.get().sendWsMessage(o.MsgAction.editMessage,Object.assign(this.getPayload(),{uuid:this._uuid}));s.Messenger.getInstance()._registerPromise(n,e,t)}))}remove(){return new Promise(((e,t)=>{const n=a.MsgSignaling.get().sendWsMessage(o.MsgAction.removeMessage,{uuid:this._uuid,conversation:this.conversation});s.Messenger.getInstance()._registerPromise(n,e,t)}))}_traceName(){return"Message"}}r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],l.prototype,"toCache",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],l.prototype,"getPayload",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],l.prototype,"sendTo",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],l.prototype,"update",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],l.prototype,"remove",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],l,"_createFromBus",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],l,"createFromCache",null),t.Message=l},7250:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.Messenger=void 0;const i=n(1150),a=n(7050),o=n(249),s=n(1855),l=n(311),c=n(8635),d=n(6054),u=n(3947),g=n(6623),f=n(8202),h={0:"Something went wrong. Please check your input or required parameters."};class p{constructor(){if(p.instance)throw new Error(g.MESSAGING_ERR_1);this.eventListeners={},this.awaitPromiseList={},this.cm=s.default.get(),this.signalling=a.MsgSignaling.get(),this.signalling.addEventListener(o.MsgEvent.onError,((e,t)=>{this._dispatchEvent(d.default.MessengerEvents.Error,{initiator:this.currentUserId,code:e.code,description:e.description,messengerAction:d.default.MessengerAction[e.on_incoming_event],timestamp:"number"==typeof e.timestamp?1e3*e.timestamp:void 0,requestUuid:t},t)})),this.signalling.addEventListener(o.MsgEvent.onEditUser,((e,t)=>{this._dispatchEvent(d.default.MessengerEvents.EditUser,{user:{userId:Number(e.object.user_id),userName:e.object.user_name,displayName:e.object.display_name,conversationsList:e.object.conversations_list,notificationEvents:e.object.notification_events?e.object.notification_events.map(this.msgEventToMessengerEvent):void 0,customData:e.object.custom_data,privateCustomData:e.object.private_custom_data},initiator:Number(e.initiator),messengerAction:d.default.MessengerAction[e.on_incoming_event],timestamp:"number"==typeof e.timestamp?1e3*e.timestamp:void 0,requestUuid:t},t)})),this.signalling.addEventListener(o.MsgEvent.onGetUser,((e,t)=>{this._dispatchEvent(d.default.MessengerEvents.GetUser,{user:{userId:Number(e.object.user_id),userName:e.object.user_name,displayName:e.object.display_name,conversationsList:e.object.conversations_list,notificationEvents:e.object.notification_events?e.object.notification_events.map(this.msgEventToMessengerEvent):void 0,customData:e.object.custom_data,privateCustomData:e.object.private_custom_data},initiator:Number(e.initiator),messengerAction:d.default.MessengerAction[e.on_incoming_event],requestUuid:t},t)})),this.signalling.addEventListener(o.MsgEvent.onSetStatus,((e,t)=>{this._dispatchEvent(d.default.MessengerEvents.SetStatus,{online:e.object.online,initiator:Number(e.initiator),messengerAction:d.default.MessengerAction[e.on_incoming_event],timestamp:"number"==typeof e.timestamp?1e3*e.timestamp:void 0,requestUuid:t},t)})),this.signalling.addEventListener(o.MsgEvent.onSubscribe,((e,t)=>{this._dispatchEvent(d.default.MessengerEvents.Subscribe,{users:e.object.user_id,initiator:Number(e.initiator),messengerAction:d.default.MessengerAction[e.on_incoming_event],requestUuid:t},t)})),this.signalling.addEventListener(o.MsgEvent.onUnsubscribe,((e,t)=>{this._dispatchEvent(d.default.MessengerEvents.Unsubscribe,{users:e.object.user_id,initiator:Number(e.initiator),messengerAction:d.default.MessengerAction[e.on_incoming_event],requestUuid:t},t)})),this.signalling.addEventListener(o.MsgEvent.onGetSubscriptionList,((e,t)=>{this._dispatchEvent(d.default.MessengerEvents.GetSubscriptionList,{users:e.object.subscriptions,initiator:Number(e.initiator),messengerAction:d.default.MessengerAction[e.on_incoming_event],requestUuid:t},t)}))}static getInstance(){return p.instance=p.instance||new p,p.instance}addEventListener(e,t){void 0===this.eventListeners[e]&&(this.eventListeners[e]=[]),this.eventListeners[e].push(t)}removeEventListener(e,t){if(void 0!==this.eventListeners[e])if("function"==typeof t){for(let n=0;n<this.eventListeners[e].length;n++)if(this.eventListeners[e][n]===t){this.eventListeners[e].splice(n,1);break}}else this.eventListeners[e]=[]}on(e,t){this.addEventListener(e,t)}off(e,t){this.removeEventListener(e,t)}_dispatchEvent(e,t,n){void 0!==this.eventListeners[e]&&this.eventListeners[e].forEach((e=>{"function"==typeof e&&e(t)})),n&&void 0!==this.awaitPromiseList[n]&&(e===d.default.MessengerEvents.Error&&"function"==typeof this.awaitPromiseList[n].reject&&this.awaitPromiseList[n].reject(t),"function"==typeof this.awaitPromiseList[n].resolve&&this.awaitPromiseList[n].resolve(t),window.clearTimeout(this.awaitPromiseList[n].expire)),void 0!==this.eventListeners[e]&&0!=this.eventListeners[e].length||i.LogManager.get().writeMessage(i.LogCategory.MESSAGING,"",i.LogLevel.INFO,"The ".concat(e," event dispatched, but no handler registered for this event type."))}_registerPromise(e,t,n){this.awaitPromiseList[e]={resolve:t,reject:n,expire:window.setTimeout(n,p.rejectTimeout)}}getConversation(e){return this.cm.getConversation(e)}getConversations(e){if(!(Array.isArray(e)&&e.length>30))return this.cm.getConversations(e);i.LogManager.get().writeMessage(i.LogCategory.MESSAGING,"Rate limit",i.LogLevel.ERROR,"you can get maximum 30 conversation in a single getConversations call")}getPublicConversations(){return this.cm.getPublicConversations()}getRawConversations(e){return this.cm.getConversations(e)}createConversation(e,t,n,r,i,a){return this.cm.createConversation(e,t,n,r,i,a)}createConversationFromCache(e){return e&&"object"==typeof e?l.Conversation.createFromCache(e):null}joinConversation(e){return new Promise(((t,n)=>{const r=this.signalling.sendWsMessage(f.MsgAction.joinConversation,{uuid:e});p.getInstance()._registerPromise(r,t,n)}))}leaveConversation(e){return new Promise(((t,n)=>{const r=this.signalling.sendWsMessage(f.MsgAction.leaveConversation,{uuid:e});p.getInstance()._registerPromise(r,t,n)}))}getMe(){return s.default.extractUserName(u.Authenticator.get().username())}getMyId(){return this.currentUserId?Promise.resolve(this.currentUserId):this.getUser(this.getMe()).then((e=>e.user.userId))}getUser(e){return new Promise(((t,n)=>{let r;const i=e=>{e.requestUuid===r&&(clearTimeout(o),this.off(d.default.MessengerEvents.GetUser,i),this.off(d.default.MessengerEvents.Error,a),e.user.userName===this.getMe()&&(this.currentUserId=Number(e.user.userId)),t(e))},a=e=>{e.requestUuid===r&&(clearTimeout(o),this.off(d.default.MessengerEvents.GetUser,i),this.off(d.default.MessengerEvents.Error,a),n(e))},o=setTimeout((()=>{p.getInstance().off(d.default.MessengerEvents.GetUser,i),p.getInstance().off(d.default.MessengerEvents.Error,a),p.getInstance().reject(d.default.MessengerError.Error_0,d.default.MessengerAction.getUser).catch(n)}),p.rejectTimeout);this.on(d.default.MessengerEvents.GetUser,i),this.on(d.default.MessengerEvents.Error,a),r=this.signalling.sendWsMessage(f.MsgAction.getUser,{user_name:e})}))}getUserById(e){return new Promise(((t,n)=>{const r=this.signalling.sendWsMessage(f.MsgAction.getUser,{user_id:e});p.getInstance()._registerPromise(r,t,n)}))}getUsers(e){if(!Array.isArray(e))return p.getInstance().reject(d.default.MessengerError.Error_0,d.default.MessengerAction.getUsers);let t;const n=Promise.all(e.map((e=>new Promise(((n,r)=>{const i=r=>{r.requestUuid===t&&r.user.userName===e&&(clearTimeout(o),p.getInstance().off(d.default.MessengerEvents.GetUser,i),p.getInstance().off(d.default.MessengerEvents.Error,a),n(r))},a=e=>{e.requestUuid===t&&(clearTimeout(o),p.getInstance().off(d.default.MessengerEvents.GetUser,i),p.getInstance().off(d.default.MessengerEvents.Error,a),r(e))},o=setTimeout((()=>{p.getInstance().off(d.default.MessengerEvents.GetUser,i),p.getInstance().off(d.default.MessengerEvents.Error,a),p.getInstance().reject(d.default.MessengerError.Error_0,d.default.MessengerAction.getUsers).catch(r)}),p.rejectTimeout);p.getInstance().on(d.default.MessengerEvents.GetUser,i),p.getInstance().on(d.default.MessengerEvents.Error,a)})))));return t=this.signalling.sendWsMessage(f.MsgAction.getUsers,{users:e.map((e=>({user_name:e})))}),n}getUsersById(e){if(!Array.isArray(e))return p.getInstance().reject(d.default.MessengerError.Error_0,d.default.MessengerAction.getUsers);let t;const n=Promise.all(e.map((e=>new Promise(((n,r)=>{const i=r=>{r.requestUuid===t&&r.user.userId===e&&(clearTimeout(o),p.getInstance().off(d.default.MessengerEvents.GetUser,i),p.getInstance().off(d.default.MessengerEvents.Error,a),n(r))},a=e=>{e.requestUuid===t&&(clearTimeout(o),p.getInstance().off(d.default.MessengerEvents.GetUser,i),p.getInstance().off(d.default.MessengerEvents.Error,a),r(e))},o=setTimeout((()=>{p.getInstance().off(d.default.MessengerEvents.GetUser,i),p.getInstance().off(d.default.MessengerEvents.Error,a),p.getInstance().reject(d.default.MessengerError.Error_0,d.default.MessengerAction.getUsers).catch(r)}),p.rejectTimeout);p.getInstance().on(d.default.MessengerEvents.GetUser,i),p.getInstance().on(d.default.MessengerEvents.Error,a)})))));return t=this.signalling.sendWsMessage(f.MsgAction.getUsers,{users:e.map((e=>({user_id:e})))}),n}editUser(e,t){let n={};return e&&(n.custom_data=e),t&&(n.private_custom_data=t),new Promise(((e,t)=>{const r=this.signalling.sendWsMessage(f.MsgAction.editUser,n);p.getInstance()._registerPromise(r,e,t)}))}setStatus(e){return new Promise(((t,n)=>{const r=this.signalling.sendWsMessage(f.MsgAction.setStatus,{online:e});p.getInstance()._registerPromise(r,t,n)}))}subscribe(e){return new Promise(((t,n)=>{const r=this.signalling.sendWsMessage(f.MsgAction.subscribe,{user_id:e});p.getInstance()._registerPromise(r,t,n)}))}unsubscribe(e,t){return new Promise(((n,r)=>{const i=this.signalling.sendWsMessage(f.MsgAction.unsubscribe,{user_id:e,all:t});p.getInstance()._registerPromise(i,n,r)}))}getSubscriptionList(){return new Promise(((e,t)=>{const n=this.signalling.sendWsMessage(f.MsgAction.getSubscriptionList,{});p.getInstance()._registerPromise(n,e,t)}))}manageNotification(e){return new Promise(((t,n)=>{const r=this.signalling.sendWsMessage(f.MsgAction.manageNotification,{notifications:e.map((e=>e===d.default.MessengerEvents.CreateConversation?o.MsgEvent.onCreateConversation:e===d.default.MessengerEvents.SendMessage?o.MsgEvent.onSendMessage:e===d.default.MessengerEvents.EditMessage?o.MsgEvent.onEditMessage:void 0))});p.getInstance()._registerPromise(r,t,n)}))}createMessageFromCache(e){return e&&"object"==typeof e?c.Message.createFromCache(e):null}reject(e,t){const n={code:e,description:h[e],initiator:this.currentUserId,messengerAction:t};return this._dispatchEvent(d.default.MessengerEvents.Error,n),Promise.reject(n)}msgEventToMessengerEvent(e){return e===o.MsgEvent.onCreateConversation?d.default.MessengerEvents.CreateConversation:e===o.MsgEvent.onSendMessage?d.default.MessengerEvents.SendMessage:e===o.MsgEvent.onEditMessage?d.default.MessengerEvents.EditMessage:e}_traceName(){return"Messenger"}}p.rejectTimeout=2e4,r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"addEventListener",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"removeEventListener",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"on",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"off",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"_dispatchEvent",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"_registerPromise",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"getConversation",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"getConversations",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"getPublicConversations",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"getRawConversations",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"createConversation",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"createConversationFromCache",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"joinConversation",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"leaveConversation",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"getMe",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"getMyId",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"getUser",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"getUserById",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"getUsers",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"getUsersById",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"editUser",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"setStatus",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"subscribe",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"unsubscribe",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"getSubscriptionList",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"manageNotification",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p.prototype,"createMessageFromCache",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],p,"getInstance",null),t.Messenger=p},6623:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MESSAGING_ERR_2=t.MESSAGING_ERR_1=void 0,t.MESSAGING_ERR_1="Error - use Client.getIM()",t.MESSAGING_ERR_2="Error - use ConversationManager.get()"},6968:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MsgPermissions=t.MsgService=void 0,n(249),function(e){e[e.Chat="chat"]="Chat"}(t.MsgService||(t.MsgService={})),function(e){e[e.none=0]="none",e[e.can_write=1]="can_write",e[e.can_edit=2]="can_edit",e[e.can_remove=4]="can_remove",e[e.can_manage_participants=8]="can_manage_participants",e[e.can_edit_all=16]="can_edit_all",e[e.can_remove_all=32]="can_remove_all",e[e.is_owner=32768]="is_owner",e[e.all=65535]="all"}(t.MsgPermissions||(t.MsgPermissions={}))},84:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.PCFactory=void 0;const i=n(6746),a=n(1150),o=n(308),s=n(4610),l=n(3869),c=n(4106),d=n(575),u=n(125),g=n(7272),f=n(8879),h=n(245),p=n(3902);class m{constructor(){this.iceConfig=null,this._peerConnections={},this.waitingPeerConnections={},this.logger=a.LogManager.get().createLogger(a.LogCategory.RTC,this._traceName()),this._requireMedia=!0,"firefox"===l.default.getWSVendor()&&(m.hasTransceivers=!0),h.default.setRPCHandler(d.RemoteEvent.createPC,((e,t)=>{this.rpcHandlerCreatePC(e,t)})),h.default.setRPCHandler(d.RemoteEvent.destroyPC,(e=>{this.rpcHandlerDestroyPC(e)})),h.default.addHandler(this)}get peerConnections(){return this._peerConnections}get requireMedia(){return this._requireMedia}set requireMedia(e){this._requireMedia=e}static get(){return null===this.inst&&(this.inst=new m),this.inst}static sdpOffersVideo(e){return{receiveVideo:-1!==e.indexOf("m=video"),sendVideo:!0}}setupDirectPC(e,t,n,r){let i=new p.TransreceiverPC(e,t,n);const a=o.CallManager.get().calls[e];if(i)return i.setHoldKey(r),u.Client.getInstance().config(),g.default.StreamManager.get().getCallStream(a).then((t=>(null!==t&&i.fastAddCustomMedia(t),this._peerConnections[e]=i,i.getLocalOffer()))).catch((e=>{throw i.close(),this.logger.error("Could not get stream during setupPC"),e}));o.CallManager.get().handleConnectionFailed(a.id(),1001,"",{})}incomeDirectPC(e,t,n,r,a){let s=new p.TransreceiverPC(e,i.PeerConnectionMode.P2P,t,a);return s.setHoldKey(r),s._setRemoteDescription(n).then((()=>{if(o.CallManager.get().calls[e])return this._peerConnections[e]=s,s;s.close()}))}getPeerConnect(e){return this._peerConnections[e]}onSignalingConnected(){}onSignalingClosed(){this.logger.info("Closing all peer connections because signaling connection has closed"),this.waitingPeerConnections={};for(let e in this._peerConnections)this._peerConnections[e].close();this._peerConnections={}}onSignalingConnectionFailed(e){}onMediaConnectionFailed(){}closeAll(){for(let e in this._peerConnections)this._peerConnections[e].close();this._peerConnections={}}setBandwidthParams(e){this._bandwidthParams=e}addBandwidthParams(e){return this._bandwidthParams&&(e.sdp=e.sdp.replace(/(a=mid:video.*\r\n)/g,"$1b=AS:"+this._bandwidthParams+"\r\n")),e}rpcHandlerCreatePC(e,t){this.logger.info("rpcHandlerCreatePC(), received SDP: \n".concat(t.replace("<br>","\n\r"))),t=f.SDPMuggle.addSetupAttribute(t);const n=m.sdpOffersVideo(t),r=i.PeerConnectionMode.CLIENT_SERVER_V1;h.default.callRemoteFunction(c.RemoteFunction.muteLocal,e,!1);const a=new p.TransreceiverPC(e,r,n);this._peerConnections[e]=a;let l=o.CallManager.get().calls[e];g.default.StreamManager.get().getCallStream(l).then((n=>{"__default"===e&&(t=t.replace("a=sendrecv","a=recvonly")),a.fastAddCustomMedia(n),a.processRemoteOffer(t).then((t=>{void 0===l||l.checkCallMode(s.CallMode.SERVER)?h.default.callRemoteFunction(c.RemoteFunction.confirmPC,e,t):h.default.callRemoteFunction(c.RemoteFunction.acceptCall,[e,o.CallManager.cleanHeaders(l.headers()),t]),"__default"!==e&&void 0!==o.CallManager.get().calls[e]&&(o.CallManager.get().calls[e].peerConnection=a)}))})).catch((e=>{void 0!==l?o.CallManager.get().handleConnectionFailed(l.id(),403,"Media access denied",{}):h.default.onConnectionFailedRPC()}))}rpcHandlerDestroyPC(e){this._peerConnections[e]&&("__default"===e?setTimeout((()=>{this._peerConnections[e].close(),delete this._peerConnections[e]}),200):(this._peerConnections[e].close(),delete this._peerConnections[e])),delete this.waitingPeerConnections[e]}_traceName(){return"PCFactory"}}m.inst=null,m.hasTransceivers=!1,r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m.prototype,"setupDirectPC",null),r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m.prototype,"incomeDirectPC",null),r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m.prototype,"getPeerConnect",null),r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m.prototype,"onSignalingConnected",null),r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m.prototype,"onSignalingClosed",null),r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m.prototype,"onSignalingConnectionFailed",null),r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m.prototype,"onMediaConnectionFailed",null),r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m.prototype,"closeAll",null),r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m.prototype,"setBandwidthParams",null),r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m.prototype,"addBandwidthParams",null),r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m.prototype,"rpcHandlerCreatePC",null),r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m.prototype,"rpcHandlerDestroyPC",null),r([a.LogManager.d_trace(a.LogCategory.PCFACTORY)],m,"sdpOffersVideo",null),t.PCFactory=m},6746:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.PeerConnection=t.PeerConnectionMode=t.PeerConnectionState=void 0;const i=n(1150),a=n(308),o=n(3385),s=n(4106),l=n(4265),c=n(125),d=n(7272),u=n(8707),g=n(4610),f=n(245),h=n(2282);var p,m;!function(e){e[e.IDLE=0]="IDLE",e[e.REMOTEOFFER=1]="REMOTEOFFER",e[e.LOCALOFFER=2]="LOCALOFFER",e[e.ESTABLISHING=3]="ESTABLISHING",e[e.ESTABLISHED=4]="ESTABLISHED",e[e.CLOSED=5]="CLOSED"}(p=t.PeerConnectionState||(t.PeerConnectionState={})),function(e){e[e.CLIENT_SERVER_V1=0]="CLIENT_SERVER_V1",e[e.P2P=1]="P2P",e[e.CONFERENCE=2]="CONFERENCE"}(m=t.PeerConnectionMode||(t.PeerConnectionMode={}));class v{constructor(e,t,n){this.id=e,this.mode=t,this.videoEnabled=n,this.onHold=!1,this.muteMicState=!1,this.SEND_CANDIDATE_DELAY=1e3,this.mediaRepository=[],this.candidateList=[],this.localCandidateTimer=-1,this.logger=i.LogManager.get().createLogger(i.LogCategory.RTC,"".concat(this._traceName()," ").concat(e)),this.logger.info("PC created"),this.state=p.IDLE,this.pendingCandidates=[],"_default"!==e&&a.CallManager.get().calls[e]&&(this.reInviteQ=new l.ReInviteQ(a.CallManager.get().calls[e],this._canReInvite))}get remoteStreams(){return this._remoteStreams}getId(){return this.id}getState(){return this.state}processRemoteAnswer(e,t){return this.state=p.ESTABLISHING,this._processRemoteAnswer(e,t)}getLocalOffer(){return this.state===p.IDLE||this.state===p.ESTABLISHED||p.LOCALOFFER?(this.logger.info("getLocalOffer()"),this.state=p.LOCALOFFER,this._getLocalOffer()):(this.logger.error("getLocalOffer() in state "+p[this.state]),new Promise(((e,t)=>{t("Invalid state")})))}getLocalAnswer(){return this._getLocalAnswer()}processRemoteOffer(e){return this.state===p.IDLE||this.state===p.ESTABLISHED?(this.state=p.ESTABLISHING,this._processRemoteOffer(e)):(this.logger.error("processRemoteOffer() in state "+p[this.state]),new Promise(((e,t)=>{t("Invalid state")})))}close(){this.logger.info("close()"),this._close()}addRemoteCandidate(e,t){return this.logger.info("addRemoteCandidate(".concat(e,", ").concat(t,")")),this._addRemoteCandidate(e,t)}handleReinvite(e,t,n){return this._handleReinvite(e,t,n)}handleRemoteOffer(e,t,n){return this._handleRemoteOffer(e,t,n)}addCandidateToSend(e,t){this.pendingCandidates.push([t,e]),this.canSendCandidates&&this.startCandidateSendTimer()}canStartSendingCandidates(){this.canSendCandidates=!0,this.startCandidateSendTimer()}sendDTMF(e){this._sendDTMF(e,500,50)}setVideoEnabled(e){const t=this.videoEnabled.receiveVideo;this.videoEnabled=e,t!=e.receiveVideo&&this._hold(this.onHold)}setVideoFlags(e){this.videoEnabled=e}getDirections(){return this._getDirections()}setHoldKey(e){this.onHold=e}getMidKinds(){if(this._call){const e={},t=this.getTransceivers(),n=d.default.StreamManager.get()._getScreenSharing(this._call)||[];let r=[];return n.forEach((e=>{r=[...r,...e.stream.getTracks().map((e=>e.id))]})),t.forEach((t=>{t.sender&&t.sender.track&&t.sender.track.kind&&("video"===t.sender.track.kind&&r.length&&~r.indexOf(t.sender.track.id)?e[t.mid]="sharing":e[t.mid]=t.sender.track.kind)})),e}return{}}getTrackKind(e){if(this._call){const t=d.default.StreamManager.get()._getTracksKind(this._call),n=this.getTransceivers(),r=u.default.parse(e);let i=[];for(const e in t)if(t.hasOwnProperty(e)){const t=n.find((t=>!(t.stopped||"stopped"===t.direction||"stopped"===t.currentDirection)&&t.sender&&t.sender.track&&t.sender.track.id===e));if(t){const n=r.media.find((e=>e.attr.some((e=>"mid"===e.name&&e.value===t.mid))));if(n){const t=n.attr.find((e=>"msid"===e.name));if(t){const n=t.value.split(" ");if(n.length>1){const t=n[1];t!=e&&i.push({from:e,to:t})}}}}}let a=Object.assign({},t);return i.forEach((e=>{const t=a[e.from];delete a[e.from],a[e.to]=t})),a}return{}}sendMedia(e,t){return new Promise(((e,t)=>{this.onHold?t({result:!1,call:this._call}):this.reInviteQ.add({fx:()=>{c.Client.getInstance().config(),d.default.StreamManager.get().updateCallStream(this._call)},reject:t,resolve:t=>{this.restoreMute(),e(t)}})}))}hold(e){return new Promise(((t,n)=>{this.onHold===e&&t({call:this._call,name:h.CallEvents.Updated,result:!0}),this.reInviteQ.add({fx:()=>{this._hold(e)},reject:n,resolve:e=>{this.restoreMute(),t(e)}})}))}hdnFRS(){return new Promise(((e,t)=>{this.onHold?t({result:!1,call:this._call}):this.reInviteQ.add({fx:()=>{this._hdnFRS()},reject:t,resolve:t=>{this.restoreMute(),e(t)}})}))}getMicrophoneState(){return this.muteMicState}muteMicrophone(e){this.muteMicState!==e?(this.muteMicState=e,this.onHold?this.logger.warning("Can't change the microphone state to ".concat(e,": the call is on hold.")):this.getTransceivers().forEach((e=>{var t,n;const r=e.sender&&e.sender.track?e.sender.track.kind:null;"audio"===r&&"live"===e.sender.track.readyState?(this.logger.warning("Change track ".concat(e.mid," with kind ").concat(r,".")),e.sender.track.enabled=!this.muteMicState):this.logger.warning("Skip track ".concat(e.mid," with kind ").concat(r," in the ").concat(null===(n=null===(t=e.sender)||void 0===t?void 0:t.track)||void 0===n?void 0:n.readyState," state."))}))):this.logger.warning("Can't change the microphone state to ".concat(e,": already in the state."))}restoreMute(){this._call.settings.active&&setTimeout((()=>{this._call.settings.state!==g.CallState.ENDED&&(this._call.restoreRMute(),this.getTransceivers().forEach((e=>{"audio"===(e.sender&&e.sender.track?e.sender.track.kind:null)&&"live"===e.sender.track.readyState&&(e.sender.track.enabled=!this.muteMicState)})))}),100)}restoreVideoSending(){}addCustomMedia(e){return new Promise(((t,n)=>{this.reInviteQ.add({fx:()=>{this._addCustomMedia(e)},reject:n,resolve:e=>{this.restoreMute(),t()}})}))}fastAddCustomMedia(e){this._addCustomMedia(e)}fastRemoveCustomMedia(e){this._removeCustomMedia(e)}removeCustomMedia(e){return new Promise(((t,n)=>{this.reInviteQ.add({fx:()=>{this._removeCustomMedia(e)},reject:n,resolve:e=>{this.restoreMute(),t()}})}))}updateMediaTracks(e){this.updateMediaTracks(e)}updateCustomMedia(e){this._updateCustomMedia(e)}replaceSharingToVideo(e,t){return this._replaceSharingToVideo(e,t)}setEncodingsParams(e,t){this._setEncodingsParams(e,t)}_traceName(){return"PeerConnection"}setState(e){this.logger.info("Transmitting from "+p[this.state]+" to "+p[e]),this.state=e}sendLocalCandidateToPeer(e,t){this._call=a.CallManager.get().calls[this.id],this.mode===m.CLIENT_SERVER_V1?f.default.callRemoteFunction(s.RemoteFunction.addCandidate,this.id,e,t):(this.candidateList.push([t,e]),this.localCandidateTimer<=0&&(this.localCandidateTimer=window.setTimeout((()=>{window.clearTimeout(this.localCandidateTimer),this.localCandidateTimer=-1,a.CallManager.get().calls[this.id]&&a.CallManager.get().calls[this.id].sendInfo(o.Constants.P2P_SPD_FRAG_MIME_TYPE,JSON.stringify(this.candidateList),{}),this.candidateList=[]}),200)))}startCandidateSendTimer(){null!==this.candidateSendTimer&&void 0!==this.candidateSendTimer||(this.candidateSendTimer=setTimeout((()=>{this.candidateSendTimer=null,this.pendingCandidates.length>0&&a.CallManager.get().calls[this.id]&&a.CallManager.get().calls[this.id].sendInfo(o.Constants.P2P_SPD_FRAG_MIME_TYPE,JSON.stringify(this.pendingCandidates),{}),this.pendingCandidates=[]}),this.SEND_CANDIDATE_DELAY))}}r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"getState",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"processRemoteAnswer",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"getLocalOffer",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"getLocalAnswer",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"processRemoteOffer",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"close",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"addRemoteCandidate",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"handleReinvite",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"handleRemoteOffer",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"addCandidateToSend",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"canStartSendingCandidates",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"sendDTMF",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"setVideoEnabled",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"setVideoFlags",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"setHoldKey",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"getTrackKind",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"sendMedia",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"hold",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"hdnFRS",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"muteMicrophone",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"restoreMute",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"restoreVideoSending",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"addCustomMedia",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"fastAddCustomMedia",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"fastRemoveCustomMedia",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"removeCustomMedia",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"updateMediaTracks",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"updateCustomMedia",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"replaceSharingToVideo",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"setEncodingsParams",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"setState",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"sendLocalCandidateToPeer",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],v.prototype,"startCandidateSendTimer",null),t.PeerConnection=v},4265:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ReInviteQ=void 0;const i=n(2282),a=n(1150);class o{constructor(e,t){this._pcStatus=t,this._q=[],e.on(i.CallEvents.Updated,(e=>{if(a.LogManager.get().writeMessage(a.LogCategory.REINVITEQ,"CallEvent",a.LogLevel.TRACE,"Updated with result ".concat(e.result)),o._currentReinvite){const t=o._currentReinvite;e.result?t.resolve(e):t.reject(e),o._currentReinvite=void 0}this.runNext()})),e.on(i.CallEvents.PendingUpdate,(e=>{a.LogManager.get().writeMessage(a.LogCategory.REINVITEQ,"CallEvent",a.LogLevel.TRACE,"IncomingUpdate. Local RI=="+typeof o._currentReinvite),o._currentReinvite&&(e.result?o._currentReinvite.resolve(e):o._currentReinvite.reject(e),o._currentReinvite=void 0)})),e.on(i.CallEvents.UpdateFailed,(e=>{a.LogManager.get().writeMessage(a.LogCategory.REINVITEQ,"CallEvent",a.LogLevel.TRACE,"UpdateFailed"),o._currentReinvite&&(o._currentReinvite.reject(),o._currentReinvite=void 0)}))}runNext(){void 0===o._currentReinvite&&this._q.length>0&&this._pcStatus()&&(o._currentReinvite=this._q.splice(0,1)[0],o._currentReinvite.fx())}add(e){this._q.push(e),this.runNext()}clear(){this._q.forEach((e=>{e.reject()}))}_traceName(){return"ReInviteQ"}}r([a.LogManager.d_trace(a.LogCategory.REINVITEQ)],o.prototype,"runNext",null),r([a.LogManager.d_trace(a.LogCategory.REINVITEQ)],o.prototype,"add",null),r([a.LogManager.d_trace(a.LogCategory.REINVITEQ)],o.prototype,"clear",null),t.ReInviteQ=o},6127:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodecSorter=void 0;const r=n(8707);class i{constructor(e){this.originalSDP=e}getUserCodecList(){void 0===this.originalCodecList&&(this.originalCodecList=r.default.parse(this.originalSDP));let e={sections:[]};return e.sections=this.originalCodecList.media.filter((e=>"video"===e.descr.media||"audio"===e.descr.media)).map(((e,t,n)=>{let r=/(rtx|red|ulpfec)/,i=e.attr.filter((e=>"rtpmap"===e.name&&!e.value.find((e=>e.value.match(r)))));return{kind:e.descr.media,codec:i}})),e}setUserCodecList(e){void 0===this.originalCodecList&&(this.originalCodecList=r.default.parse(this.originalSDP));for(let t=0;t<e.sections.length;t++)if(e.sections[t].kind===this.originalCodecList.media[t].descr.media){let n=i.resortSection(e.sections[t].codec,this.originalCodecList.media[t].attr,this.originalCodecList.media[t].descr.media);this.originalCodecList.media[t].attr=n.codecs,this.originalCodecList.media[t].descr.fmt=n.order,this.originalCodecList.media[t].descr.fmtCount=n.order.length}}static resortSection(e,t,n){let r=[],i=[],a=[],o=[];t.forEach((e=>"rtpmap"===e.name?a.push(e):"ssrc"===e.name?i.push(e):void r.push(e)));let s=e.map((e=>{let t=e.value.find((e=>"rtpmap"===e.name)).value,n=a.find((e=>e.value.find((e=>!!~e.value.indexOf(t)))));if(n)return o.push(t.split(" ")[0]),n})).filter(Boolean);if("video"===n.toLowerCase()){let e=[],t=[],n=a.filter((e=>e.value.find((e=>!!~e.value.indexOf("rtx"))))),o=a.filter((e=>e.value.find((e=>e.value.match(/(red|ulpfec)/)))));return s=s.concat(o),s.forEach((r=>{e.push(r),t.push(r.value.find((e=>"rtpmap"===e.name)).value.split(" ")[0]);let i=this.matchRtx(r,n);i&&(e.push(i),t.push(i.value.find((e=>"rtpmap"===e.name)).value.split(" ")[0]))})),{codecs:[...r,...e,...i],order:t}}return{codecs:[...r,...s,...i],order:o}}static matchRtx(e,t){let n=e.value.find((e=>"rtpmap"===e.name)).value.split(" ")[0],r=t.find((e=>e.value.find((e=>!!~e.value.indexOf("apt=".concat(n))))));return r}getSDP(){return this.originalCodecList.toString()}_traceName(){return"CodecSorter"}}t.CodecSorter=i},3421:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.CodecSorterHelpers=void 0;const i=n(1150);class a{static H264Sorter(e){return new Promise((t=>{for(let n=0;n<e.sections.length;n++)"video"==e.sections[n].kind.toLowerCase()&&e.sections[n].codec.sort(((e,t)=>{let n=e.value.findIndex((e=>"rtpmap"===e.name)),r=t.value.findIndex((e=>"rtpmap"===e.name));return-1!=e.value[n].value.toLowerCase().indexOf("h264")&&-1==e.value[n].value.toLowerCase().indexOf("uc")?-1:-1!=t.value[r].value.toLowerCase().indexOf("h264")&&-1==t.value[r].value.toLowerCase().indexOf("uc")?1:0}));t(e)}))}static H264ConfSorter(e,t){return new Promise(t?t=>{for(let n=0;n<e.sections.length;n++)if("video"==e.sections[n].kind.toLowerCase()){let t=e.sections[n].codec.filter((e=>{let t=e.value.findIndex((e=>"rtpmap"===e.name));return-1!=e.value[t].value.toLowerCase().indexOf("h264")&&-1==e.value[t].value.toLowerCase().indexOf("uc")}));t.length&&(e.sections[n].codec=t)}t(e)}:t=>{for(let n=0;n<e.sections.length;n++)"video"==e.sections[n].kind.toLowerCase()&&(e.sections[n].codec.sort(((e,t)=>{let n=e.value.findIndex((e=>"rtpmap"===e.name)),r=t.value.findIndex((e=>"rtpmap"===e.name));return-1!=e.value[n].value.toLowerCase().indexOf("h264")&&-1==e.value[n].value.toLowerCase().indexOf("uc")?-1:-1!=t.value[r].value.toLowerCase().indexOf("h264")&&-1==t.value[r].value.toLowerCase().indexOf("uc")?1:0})),e.sections[n].codec.sort(((e,t)=>{e.value.findIndex((e=>"rtpmap"===e.name)),t.value.findIndex((e=>"rtpmap"===e.name));let n=e.value.findIndex((e=>"fmtp"===e.name)),r=t.value.findIndex((e=>"fmtp"===e.name));return e.value[n]&&t.value[r]?-1!==e.value[n].value.toLowerCase().indexOf("profile-level-id=42e01f")&&-1!==e.value[n].value.toLowerCase().indexOf("packetization-mode=1")?-1:-1!==t.value[r].value.toLowerCase().indexOf("profile-level-id=42e01f")&&-1!==e.value[n].value.toLowerCase().indexOf("packetization-mode=1")?1:0:0})));t(e)})}_traceName(){return"CodecSorterHelpers"}}r([i.LogManager.d_trace(i.LogCategory.RTC)],a,"H264Sorter",null),r([i.LogManager.d_trace(i.LogCategory.RTC)],a,"H264ConfSorter",null),t.CodecSorterHelpers=a},8707:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.attrCount=0,this.bandwCount=0,this.mediaCount=0,this.dummyLines=[]}static parse(e){const t=new n;return n.splitLines(e).forEach(((e,r)=>{switch(e.trim().charAt(0)){case"a":const i=n.parseAttr(e,r);if(i)if(t.mediaCount){if(!(t.media[t.mediaCount-1].attrCount<260))throw new Error("Error adding media attribute, attribute is ignored");t.addMediaAttribute(i,t.mediaCount-1)}else{if(!(t.attrCount<260))throw new Error("Error adding media attribute, attribute is ignored");t.addSessionAttribute(i)}break;case"o":t.origin=n.parseOrigin(e,r);break;case"s":t.name=n.parseGenericLine(e,r);break;case"c":const a=n.parseConnectionInfo(e,r);t.mediaCount?t.media[t.mediaCount-1].conn=a:t.conn=a;break;case"t":t.time=n.parseTime(e,r);break;case"m":const o=n.parseMedia(e,r);if(void 0===t.media&&(t.media=[]),!(t.mediaCount<256))throw new Error("Error adding media, media is ignored");t.media[t.mediaCount]=o,t.mediaCount++;break;case"v":n.parseVersion(e,r);break;case"b":const s=n.parseBandwidthInfo(e,r);if(t.mediaCount){if(!(t.media[t.mediaCount-1].bandwCount<8))throw new Error("Error adding session bandwidth info, info is ignored");t.media[t.mediaCount-1].bandw.push(s),t.media[t.mediaCount-1].bandwCount++}else{if(!(t.bandwCount<8))throw new Error("Error adding session bandwidth info, info is ignored");void 0===t.bandw&&(t.bandw=[]),t.bandw[t.bandwCount]=s,t.bandwCount++}break;default:t.dummyLines.push(n.parseGenericLine(e,r))}})),t}static parseAttr(e,t){0!==e.indexOf("a=")&&n.scannerError(e,t);const r=n.chopLine(e).split(":");return{name:r[0],value:r.slice(1).join(":")}}static splitLines(e){return e.split(/(\r\n|\r|\n)/).filter((e=>e.length>0)).filter(RegExp.prototype.test.bind(/^([a-z])=(.*)/))}static parseGenericLine(e,t){return 1!==e.indexOf("=")&&n.scannerError(e,t),e.substr(2)}static parseOrigin(e,t){0!==e.indexOf("o=")&&n.scannerError(e,t);const r=n.chopLine(e).split(/[\s\t]+/);return{user:r[0],id:r[1],version:r[2],netType:r[3],addrType:r[4],addr:r[5]}}static parseVersion(e,t){0!==e.indexOf("v=0")&&n.scannerError(e,t)}static parseTime(e,t){0!==e.indexOf("t=")&&n.scannerError(e,t);const r=n.chopLine(e).split(/[\s\t]+/);return{start:parseInt(r[0]),stop:parseInt(r[1])}}static parseConnectionInfo(e,t){0!==e.indexOf("c=")&&n.scannerError(e,t);const r=n.chopLine(e).split(/[\s\t]+/);return{netType:r[0],addrType:r[1],addr:r[2]}}static parseBandwidthInfo(e,t){0!==e.indexOf("b=")&&n.scannerError(e,t);const r=n.chopLine(e).split(/[:]+/);return{modifier:r[0],value:parseInt(r[1])}}static scannerError(e,t){throw new Error("Error parsing sdp in line ".concat(t,': "').concat(e,'" is not valid sdp line'))}static chopLine(e){return e.substr(2)}static parseMedia(e,t){0!==e.indexOf("m=")&&n.scannerError(e,t);const r=n.chopLine(e).split(/[\s\t]+/),i=r[1].split("/");return{descr:{media:r[0],port:parseInt(i[0]),portCount:parseInt(i[1]||"0"),transport:r[2],fmtCount:r.length-3,fmt:r.slice(3)},attrCount:0,bandwCount:0,attr:[],bandw:[]}}addSessionAttribute(e){void 0===this.attr&&(this.attr=[]),this.attr.push(e),this.attrCount++}addMediaAttribute(e,t){void 0===this.media[t].attr&&(this.media[t].attr=[]);let n=e.value.split(" ")[0];~["rtcp","ice-ufrag","ice-pwd","ice-options","fingerprint","setup"].indexOf(e.name)?this.addAttr(t,e,"ice"):~["rtpmap","rtcp-fb","fmtp"].indexOf(e.name)?this.addAttr(t,e,"rtpmap",n):~["extmap"].indexOf(e.name)?this.addAttr(t,e,"extmap"):~["ssrc"].indexOf(e.name)?this.addAttr(t,e,"ssrc"):this.media[t].attr.push(e),this.media[t].attrCount++}addAttr(e,t,n,r){let i=this.media[e].attr.findIndex((e=>r?e.name===n&&e.value[0].value.split(" ")[0]===r:e.name===n));-1!==i?this.media[e].attr[i].value.push(t):this.media[e].attr.push({name:n,value:[t]})}toString(){const e=[];e.push("v=0"),e.push("o=".concat(this.origin.user," ").concat(this.origin.id," ").concat(this.origin.version," ").concat(this.origin.netType," ").concat(this.origin.addrType," ").concat(this.origin.addr)),e.push("s=".concat(this.name)),this.conn&&e.push(n.printConnectionInfo(this.conn));for(let t=0;t<this.bandwCount;t++)e.push(n.printBandwidthInfo(this.bandw[t]));e.push("t=".concat(this.time.start," ").concat(this.time.stop));for(let t=0;t<this.attrCount;t++)e.push(n.printAttrInfo(this.attr[t]));for(let t=0;t<this.mediaCount;t++){const r=this.media[t];let i="m=".concat(r.descr.media," ").concat(r.descr.port).concat(r.descr.portCount?"/"+r.descr.portCount:""," ").concat(r.descr.transport);for(let e=0;e<r.descr.fmtCount;e++)i+=" "+r.descr.fmt[e];e.push(i),r.conn&&e.push(n.printConnectionInfo(r.conn));for(let t=0;t<r.bandwCount;t++)e.push(n.printBandwidthInfo(r.bandw[t]));const a=["sendrecv","sendonly","recvonly","inactive"],o=r.attr.find((e=>!!~a.indexOf(e.name)));o&&e.push(n.printAttrInfo(o));const s=r.attr.find((e=>"ice"===e.name));s&&s.value.forEach((t=>{e.push(n.printAttrInfo(t))}));let l=r.attr.filter((e=>"ice"!==e.name&&!~a.indexOf(e.name)));for(let t=0;t<l.length;t++)Array.isArray(l[t].value)?l[t].value.forEach((t=>{e.push(n.printAttrInfo(t))})):e.push(n.printAttrInfo(l[t]))}return e.join("\r\n")+"\r\n"}static printConnectionInfo(e){return"c=".concat(e.netType," ").concat(e.addrType," ").concat(e.addr)}static printBandwidthInfo(e){return"b=".concat(e.modifier,":").concat(e.value)}static printAttrInfo(e){return"a=".concat(e.name).concat(e.value?":"+e.value:"")}}t.default=n,n.SDP_EINSDP="Wrong sdp lines"},8879:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SDPMuggle=void 0;const r=n(125),i=n(1206),a=n(8707);class o{static getSDPLines(e){return e.split(/(\r\n|\r|\n)/).filter(o.validLine)}static createSDPFrom(e,t){return new RTCSessionDescription({sdp:e.join("\r\n")+"\r\n",type:t})}static detectDirections(e){let t=[],n=e.split(/(\r\n|\r|\n)/).filter(o.validLine),r="";return n.forEach((e=>{if(0===e.indexOf("m=")){let t=e.substr(2);r=t.split(" ")[0]}""===r||"a=sendrecv"!==e&&"a=sendonly"!==e&&"a=recvonly"!==e&&"a=inactive"!==e||(t.push({type:r,direction:e.substr(2)}),r="")})),t}static checkIsVimsSectionExistsIn(e){return e.includes("VIMS")}static removeTelephoneEvents(e){if(-1!==e.sdp.indexOf("a=rtpmap:127 telephone-event/8000")){let t=e.sdp.split(/(\r\n|\r|\n)/).filter(o.validLine),n=-1;for(let e=0;e<t.length;e++){if(-1!==t[e].indexOf("m=audio")){let n=t[e];"string"==typeof n&&(t[e]=n.replace(" 127",""))}-1!==t[e].indexOf("a=rtpmap:127 telephone-event/8000")&&(n=e)}return t.splice(n,1),new RTCSessionDescription({sdp:t.join("\r\n")+"\r\n",type:e.type})}return e}static removeDoubleOpus(e){if(-1!==e.sdp.indexOf("a=rtpmap:109 opus")&&-1!==e.sdp.indexOf("a=rtpmap:111 opus")){let t=e.sdp.split(/(\r\n|\r|\n)/).filter(o.validLine),n=-1;for(let e=0;e<t.length;e++){if(-1!==t[e].indexOf("m=audio")){let n=t[e];"string"==typeof n&&(t[e]=n.replace(" 109",""))}-1!==t[e].indexOf("a=rtpmap:109 opus")&&(n=e)}return t.splice(n,1),new RTCSessionDescription({sdp:t.join("\r\n")+"\r\n",type:e.type})}return e}static removeDoublePT(e){let t=e.sdp.split(/(\r\n|\r|\n)/).filter(o.validLine),n=[];for(let r=0;r<t.length;r++){let e=t[r];0===e.indexOf("m=video")&&(n=e.split(" "),t[r]=n.filter(((e,t)=>{if(0===t)return!0;for(let r=t-1;r>=2;r--)if(n[r]===e)return!1;return!0})).join(" "))}return new RTCSessionDescription({sdp:t.join("\r\n")+"\r\n",type:e.type})}static getSdpCodecs(e){return e.match(/a=rtpmap:\d+/g)}static removeDoubleCodecsInactiveSections(e){let t=e.sdp.split("m=");for(let n=0;n<t.length;n+=1){if(-1===t[n].indexOf("a=inactive"))continue;const e=o.getSdpCodecs(t[n]);e&&e.filter(((t,n)=>e.indexOf(t)!==n)).forEach((e=>{const r=new RegExp("".concat(e," .+\r\n"));t[n]=t[n].replace(r,"")}))}return new RTCSessionDescription({sdp:t.join("m="),type:e.type})}static removeTransportCC(e){if(-1!==e.sdp.indexOf("http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")){let t=e.sdp.split(/(\r\n|\r|\n)/).filter(o.validLine),n=[];return t.forEach(((e,t)=>{-1!==e.indexOf("http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")&&n.unshift(t)})),n.forEach((e=>t.splice(e,1))),new RTCSessionDescription({sdp:t.join("\r\n")+"\r\n",type:e.type})}return e}static removeTIAS(e){if(-1!==e.sdp.indexOf("b=TIAS:13888000")||-1!==e.sdp.indexOf("b=AS:13888")){let t=e.sdp.split(/(\r\n|\r|\n)/).filter(o.validLine),n=[];t.forEach(((e,t)=>{-1===e.indexOf("b=TIAS:13888000")&&-1===e.indexOf("b=AS:13888")||n.unshift(t)})),n.forEach((e=>t.splice(e,1))),e={type:e.type,sdp:t.join("\r\n")+"\r\n"}}return e}static fixVideoRecieve(e,t){if(-1!==e.sdp.indexOf("m=video")&&!t){let t=e.sdp.split(/(\r\n|\r|\n)/).filter(o.validLine),n=null;return t=t.map(((e,t)=>(null===n?-1!==e.indexOf("m=video")&&(n=t):"a=sendrecv"===e?e="a=sendonly":"a=recvonly"===e&&(e="a=inactive"),e))),new RTCSessionDescription({sdp:t.join("\r\n")+"\r\n",type:e.type})}return e}static addSetupAttribute(e){return-1==e.indexOf("a=setup:")&&(e+="a=setup:actpass\r\n"),e}static findTrackByMid(e,t){let n=e.split(/(\r\n|\r|\n)/).filter(o.validLine),r=-1;for(let i=0;i<n.length&&(-1===n[i].indexOf("a=mid:")||-1===r);i++)if(-1!==n[i].indexOf("a=mid:".concat(t))&&(r=i),-1!==n[i].indexOf("msid:")&&-1!==r)return n[i].split(" ").slice(-1).pop();return""}static addXAS(e){if(r.Client.getInstance().config().experiments.xas&&r.Client.getInstance().config().experiments.xas){let t=e.sdp;const n=r.Client.getInstance().config().experiments.xas;return void 0!==n.as&&-1!==n.as&&(t=t.replace(/(a=mid:video.*\r\n)/g,"$1b=AS:"+n.as+"\r\n")),void 0!==n.tias&&-1!==n.tias&&(t=t.replace(/(a=mid:video.*\r\n)/g,"$1b=TIAS:"+n.as+"\r\n")),new RTCSessionDescription({sdp:t,type:e.type})}return e}static fixFFMIDBug(e){if(-1==e.sdp.indexOf("a=mid")){const t=e.sdp.replace(/(m=audio.*\r\n)/g,"$1a=mid:0\r\n");return new RTCSessionDescription({sdp:t,type:e.type})}return e}static fixFMTP(e){let t=e.sdp.split(/(\r\n|\r|\n)/).filter(o.validLine),n=[];return t=t.filter((t=>{if(0==t.indexOf("a=fmtp")){let r=t.split(" ")[1],i=r.replace("apt=","");return-1!==e.sdp.indexOf("a=rtpmap:".concat(i))||(n.push(r[0].replace("a=fmtp:","")),!1)}return!0})).filter((e=>-1===e.indexOf("a=rtpmap:")||-1===n.indexOf(e.split(" ")[0].replace("a=rtpmap:","")))).map((e=>-1!==e.indexOf("m=")?e.split(" ").filter((e=>-1===n.indexOf(e))).join(" "):e)),{sdp:t.join("\r\n")+"\r\n",type:e.type}}static trimMediaAttr(e){let t=e.sdp.split(/(\r\n|\r|\n)/).filter(o.validLine);return t=t.map((e=>(e.includes("a=fmtp")&&(e=e.split(";").map((e=>e.trim())).join(";")),e))),new RTCSessionDescription({sdp:t.join("\r\n")+"\r\n",type:e.type})}static fixSetupSection(e){return!i.getParser(window.navigator.userAgent).satisfies({chrome:">94.00.0"})||navigator.userAgent.match(/BitrixDesktop/i)?e:this.getSDPLines(e).map((e=>e.includes("a=setup:")?e.replace(/:.+$/,":active"):e)).join("\r\n")+"\r\n"}static forcePassiveSetupSection(e){if(!i.getParser(window.navigator.userAgent).satisfies({chrome:">94.00.0"})||navigator.userAgent.match(/BitrixDesktop/i))return e;const t=this.getSDPLines(e.sdp).map((e=>e.includes("a=setup:")?e.replace(/:.+$/,":passive"):e));return Object.assign(Object.assign({},e),{sdp:t.join("\r\n")+"\r\n"})}static reduceCodecs(e,t){let n=a.default.parse(e.sdp),r=!1,i=!1;return n.media.forEach(((e,a)=>{var s,l;if(!e.attr.find((e=>"inactive"===e.name))){let c=[],d=[],u=[],g=[];if(e.attr.forEach((e=>"rtpmap"===e.name?u.push(e):"ssrc"===e.name?d.push(e):void c.push(e))),"audio"===e.descr.media){if(!(null===(s=t.audio)||void 0===s?void 0:s.length))return;let e=o.reduceAudioCodecs(u,t.audio);g.push(...e.reducedCodecs),i=e.isAudio}else if("video"===e.descr.media){if(!(null===(l=t.video)||void 0===l?void 0:l.length))return;let e=o.reduceVideoCodecs(u,t.video);g.push(...e.reducedCodecs),r=e.isVideo}g.length?(n.media[a].attr=[...c,...g,...d],n.media[a].descr.fmtCount=g.length,n.media[a].descr.fmt=g.map((e=>e.value[0].value.split(" ")[0])),n.media[a].attrCount=n.media[a].attr.length):(delete n.media[a],n.mediaCount--)}})),{sdp:{type:e.type,sdp:n.toString()},isVideo:r,isAudio:i}}static recoverVideoFmts(e,t){var n,r;null==t||t.info("SDPMuggle.recoverVideoFmts(): parsing SDP\n".concat(e));const i=a.default.parse(e),o=null===(n=i.media)||void 0===n?void 0:n[1];if(!o)return null==t||t.info("SDPMuggle.recoverVideoFmts(): video description is undefined"),e;const s=(null===(r=o.attr)||void 0===r?void 0:r.filter((e=>{let{name:t}=e;return"rtpmap"===t})))||[];if(o.descr.fmtCount===(null==s?void 0:s.length))return null==t||t.info("SDPMuggle.recorverVideoFmts(): fmts count and rtpmaps count are equal"),e;const l=s.map((e=>{let{value:t}=e;var n;const r=t[0],[i]=(null===(n=null==r?void 0:r.value)||void 0===n?void 0:n.split(" "))||[];return i})),c=((e,t)=>{const n=new Set(e);for(const r of t)n.delete(r);return Array.from(n.values())})(l,o.descr.fmt);null==t||t.info("SDPMuggle.recorverVideoFmts(): fmts are missed ".concat(c)),o.descr.fmt.push(...c),o.descr.fmtCount=o.descr.fmt.length;const d=i.toString();return null==t||t.info("SDPMuggle.recorverVideoFmts(): SDP is recovered\n".concat(d)),d}static reduceVideoCodecs(e,t){const n=[];let r=!1;const i=e.filter((e=>e.value.find((e=>!!~e.value.indexOf("rtx")))));return e.forEach((e=>{var a;const o=e.value.find((e=>"rtpmap"===e.name)).value,s=t.filter((e=>!!~o.indexOf(e.name)));if(s.length){const t=null===(a=e.value.find((e=>"fmtp"===e.name)))||void 0===a?void 0:a.value;s.forEach((a=>{let o=Object.keys(a.params||{}).length;for(const e in a.params)~t.indexOf("".concat(e,"=").concat(a.params[e]))&&o--;if(0===o&&(a.optional||r||(r=!0),n.push(e),i.length)){let t=((e,t)=>{const n=e.value.find((e=>"rtpmap"===e.name)).value.split(" ")[0];return t.find((e=>e.value.find((e=>!!~e.value.indexOf("apt=".concat(n))))))})(e,i);t&&n.push(t)}}))}})),{reducedCodecs:n,isVideo:r}}static reduceAudioCodecs(e,t){const n=[];let r=!1;return e.forEach((e=>{var i;const a=e.value.find((e=>"rtpmap"===e.name)).value,o=t.filter((e=>!!~a.indexOf(e.name)));if(o.length){const t=null===(i=e.value.find((e=>"fmtp"===e.name)))||void 0===i?void 0:i.value;o.forEach((i=>{let a=Object.keys(i.params||{}).length;for(const e in i.params)~t.indexOf("".concat(e,"=").concat(i.params[e]))&&a--;0===a&&(i.optional||r||(r=!0),n.push(e))}))}})),{reducedCodecs:n,isAudio:r}}_traceName(){return"SDPMuggle"}}t.SDPMuggle=o,o.validLine=RegExp.prototype.test.bind(/^([a-z])=(.*)/)},3902:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.TransreceiverPC=t.RTCSdpType=void 0;const i=n(6746),a=n(3869),o=n(84),s=n(1150),l=n(9551),c=n(308),d=n(4106),u=n(6127),g=n(2282),f=n(8879),h=n(125),p=n(4265),m=n(7272),v=n(2957),y=n(245);var C=m.default.StreamManager;const _=n(6665),S=n(8552),E=n(8237);var b,M,w;!function(e){e[e.offer="offer"]="offer",e[e.answer="answer"]="answer",e[e.pranswer="pranswer"]="pranswer",e[e.rollback="rollback"]="rollback"}(b=t.RTCSdpType||(t.RTCSdpType={})),function(e){e[e.controlling="controlling"]="controlling",e[e.controlled="controlled"]="controlled"}(M||(M={})),function(e){e.alreadyInProgress="alreadyInProgress"}(w||(w={}));class R extends i.PeerConnection{constructor(e,t,n,r){super(e,t,n),this.candidatePool=[],this.candidateQueueMap=new Map([["local",[]],["remote",[]]]),this.iceTimer=null,this.needTransportRestart=!0,this.ICE_TIMEOUT=2e4,this._needIceRestart=!1,this.streamCache=[],this._canReInvite=()=>"connected"===this.impl.iceConnectionState||"completed"===this.impl.iceConnectionState,this._TransceiverEncoderMap=new WeakMap;let i=o.PCFactory.get().iceConfig;null==i&&(i={gatherPolicy:"all",iceServers:[]}),r&&(i.iceServers=r),i.bundlePolicy="balanced",this._createImpl(i)}_getLocalOfferRegular(){return this.iceRole=M.controlling,new Promise(((e,t)=>{let n={};this._call&&(a.default.isIphone()||!this._call.settings.isConference&&!this._call.settings.isAudio)&&(n=this.getReceiveOptions()),this.resetEncodings().then((()=>(this.logger.info("_getLocalOfferRegular(), start create local SDP"),this.impl.createOffer(n)))).then((e=>{this.logger.info("_getLocalOfferRegular(), created local SDP: \n".concat(e.sdp));let t={type:e.type,sdp:e.sdp};return t=o.PCFactory.get().addBandwidthParams(t),t=f.SDPMuggle.removeDoublePT(t),t=this._reduceCodecs(t),t=f.SDPMuggle.trimMediaAttr(t),this.codecRearrange(t)})).then((e=>(this.srcLocalSDP=e.sdp,this.logger.info("_getLocalOfferRegular(), set local SDP: \n".concat(e.sdp)),this._call&&this._call.dispatchEvent({name:"SDP",origin:"getLocalOffer",sdp:e}),this.impl.setLocalDescription(e)))).then((()=>{e(this.impl.localDescription)})).catch((e=>{this._call&&this._call.dispatchEvent({name:"SDP",origin:"_getLocalOfferRegular",sdp:this.impl.localDescription,description:"offer_reject: ".concat(e.message)}),t(e)}))}))}updateHoldState(){this.impl.getTransceivers().forEach((e=>{e.sender.track&&("audio"===e.sender.track.kind?e.sender.track.enabled=!this.onHold&&!this.muteMicState:e.sender.track.enabled=!this.onHold)}))}_processRemoteAnswer(e,t){if(0===t.length&&this._call)return this.logger.error("Empty SDP from server. Call will be terminated."),void this._call.hangup({"X-WebRTCError":"no sdp"});if("stable"===this.impl.signalingState)return;let n={sdp:t,type:b.answer};return this.srcRemoteSDP=t,n=f.SDPMuggle.removeTIAS(n),n=f.SDPMuggle.trimMediaAttr(n),this.logger.info("_processRemoteAnswer(), set remote SDP: \n".concat(n.sdp)),this._call&&this._call.dispatchEvent({name:"SDP",origin:"processRemoteAnswer",sdp:n}),this.impl.setRemoteDescription(n).then((()=>this.impl.getTransceivers().forEach(this.stopInactiveTransceiver.bind(this)))).then((e=>{this._needIceRestart&&(this._call.settings.isDirect&&this._call.settings.incoming||this._runReinvite(!0))})).catch((e=>{this._call&&this._call.dispatchEvent({name:"SDP",origin:"_processRemoteAnswer",sdp:this.impl.localDescription,description:"answer_reject: ".concat(e.message)})}))}_getLocalOffer(){return"firefox"===a.default.getWSVendor()&&this.impl.remoteDescription&&this.impl.remoteDescription.sdp&&-1===this.impl.remoteDescription.sdp.indexOf("VIMS")?this._getLocalOfferFF():this._getLocalOfferRegular()}_getLocalOfferFF(){return this.iceRole=M.controlling,new Promise(((e,t)=>{let n={};!this._call||!a.default.isIphone()&&this._call.settings.isConference||(n=this.getReceiveOptions()),this.resetEncodings().then((()=>this.impl.createOffer(n))).then((e=>{this.logger.info("_getLocalOfferFF(), created local SDP: \n".concat(e.sdp));let t={type:e.type,sdp:e.sdp};return t=o.PCFactory.get().addBandwidthParams(t),t=f.SDPMuggle.removeDoublePT(t),t=this._reduceCodecs(t),t=f.SDPMuggle.trimMediaAttr(t),this.codecRearrange(t)})).then((t=>{this.srcLocalSDP=t.sdp,this._pendingOffer=t,e(t)})).catch((e=>{this._call&&this._call.dispatchEvent({name:"SDP",origin:"_getLocalOfferFF",sdp:this._pendingOffer,description:"offer_reject: ".concat(e.message)}),t(e)}))}))}_getLocalAnswer(){return this.iceRole=M.controlled,new Promise(((e,t)=>{let n={mandatory:{}};!this._call||!a.default.isIphone()&&this._call.settings.isConference||(n={mandatory:this.getReceiveOptions()}),this.resetEncodings().then((()=>this.impl.createAnswer(n))).then((e=>{this.logger.info("_getLocalAnswer(), created local SDP: \n".concat(e.sdp));let t={type:e.type,sdp:e.sdp};return t=o.PCFactory.get().addBandwidthParams(t),t=f.SDPMuggle.removeDoublePT(t),t=f.SDPMuggle.fixVideoRecieve(t,this._call.settings.videoDirections.receiveVideo),t=this._reduceCodecs(t),t=f.SDPMuggle.trimMediaAttr(t),this._call&&this._call.settings.incoming&&(t=f.SDPMuggle.forcePassiveSetupSection(t)),this.codecRearrange(t)})).then((e=>(this.srcLocalSDP=e.sdp,this.logger.info("_getLocalAnswer(), set local SDP: \n".concat(e.sdp)),this._call&&this._call.dispatchEvent({name:"SDP",origin:"getLocalAnswer",sdp:e}),this.impl.setLocalDescription(Object.assign(Object.assign({},e),{type:"answer"}))))).then((()=>{e({type:b.answer,sdp:this.impl.localDescription.sdp})})).catch((e=>{this._call&&this._call.dispatchEvent({name:"SDP",origin:"_getLocalAnswer",sdp:this.impl.localDescription,description:"answer_reject: ".concat(e.message)}),t(e)}))}))}_processRemoteOffer(e){return 0===e.length&&this._call?(this.logger.error("Empty SDP from server. Call will be terminated."),void this._call.hangup({"X-WebRTCError":"no sdp"})):(this.iceRole=M.controlled,new Promise(((t,n)=>{let r=new RTCSessionDescription({sdp:e,type:b.offer});this.srcRemoteSDP=e,r=f.SDPMuggle.removeTIAS(r),r=f.SDPMuggle.fixFFMIDBug(r),r=f.SDPMuggle.trimMediaAttr(r),this.logger.info("_processRemoteOffer(), set remote SDP: \n".concat(r.sdp)),this._call&&this._call.dispatchEvent({name:"SDP",origin:"processRemoteOffer",sdp:r}),this.resetEncodings().then((()=>this.impl.setRemoteDescription(r))).then((()=>{let e={mandatory:{}};return!this._call||!a.default.isIphone()&&this._call.settings.isConference||(e={mandatory:this.getReceiveOptions()}),this.impl.createAnswer(e)})).then((e=>(this.logger.info("_processRemoteOffer(), created local SDP: \n".concat(e.sdp)),e=f.SDPMuggle.removeDoublePT(e),e=this._reduceCodecs(e),e=f.SDPMuggle.trimMediaAttr(e),this.codecRearrange(e)))).then((e=>(this.srcLocalSDP=e.sdp,this.logger.info("_processRemoteOffer(), set local SDP: \n".concat(e.sdp)),this._call&&this._call.dispatchEvent({name:"SDP",origin:"processRemoteOffer",sdp:e}),this.impl.setLocalDescription(e)))).then((()=>{t(this.impl.localDescription.sdp)})).catch((e=>{this._call&&this._call.dispatchEvent({name:"SDP",origin:"_processRemoteOffer",sdp:this.impl.localDescription,description:"answer_reject: ".concat(e.message)}),n(e)}))})))}_setRemoteDescription(e){if(0===e.length&&this._call)return this.logger.error("Empty SDP from server. Call will be terminated."),void this._call.hangup({"X-WebRTCError":"no sdp"});let t=new RTCSessionDescription({sdp:e,type:b.offer});return t=f.SDPMuggle.removeTIAS(t),t=f.SDPMuggle.trimMediaAttr(t),this.srcRemoteSDP=e,this.logger.info("_setRemoteDescription(), set remote SDP: \n".concat(t.sdp)),this._call&&this._call.dispatchEvent({name:"SDP",origin:"setRemoteDescription",sdp:t}),this.impl.setRemoteDescription(t)}_handleRemoteOffer(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.renegotiationInProgress=!0,0===t.length&&this._call?(this.logger.error("Empty SDP from server. Call will be terminated."),void this._call.hangup({"X-WebRTCError":"no sdp"})):new Promise(((r,i)=>{const o=new RTCSessionDescription({sdp:t,type:"offer"});"safari"!==a.default.getWSVendor()&&"stable"!==this.impl.signalingState?(this.logger.info("signalingState: ".concat(this.impl.signalingState,", local description will set with 'rollback' type")),this.resetEncodings().then((()=>Promise.all([this.impl.setLocalDescription({type:"rollback"}),this.impl.setRemoteDescription(o)]))).then((()=>this.impl.createAnswer())).then((t=>{let n={sdp:t.sdp,type:t.type};n=f.SDPMuggle.removeDoubleOpus(n),n=f.SDPMuggle.removeDoublePT(n),n=f.SDPMuggle.fixVideoRecieve(n,this.videoEnabled.receiveVideo),n=f.SDPMuggle.trimMediaAttr(n),n=this._reduceCodecs(n),this.impl.setLocalDescription(n).then((()=>{this.renegotiationInProgress=!1,this.updateHoldState();const t={mids:this.getMidKinds()};y.default.callRemoteFunction(d.RemoteFunction.acceptReInvite,this._call.id(),e,n.sdp,t),this._call&&this._call.dispatchEvent({name:g.CallEvents.Updated,result:!0,call:this._call}),r()}))})).catch((r=>{n?console.error(r):setTimeout((()=>{this._handleRemoteOffer(e,t,!0)}),300)}))):(this.logger.info("signalingState: ".concat(this.impl.signalingState,", local description will set without 'rollback' type")),this.resetEncodings().then((()=>this.impl.setRemoteDescription(o))).then((()=>this.impl.createAnswer())).then((t=>{let n={sdp:t.sdp,type:t.type};n=this._reduceCodecs(n),n=f.SDPMuggle.trimMediaAttr(n),this.impl.setLocalDescription(n).then((()=>{const t={mids:this.getMidKinds()};this.impl.getTransceivers().forEach(this.stopInactiveTransceiver.bind(this)),y.default.callRemoteFunction(d.RemoteFunction.acceptReInvite,this._call.id(),e,n.sdp,t),this.renegotiationInProgress=!1,this._call&&this._call.dispatchEvent({name:g.CallEvents.Updated,result:!0,call:this._call}),this.updateHoldState(),r()}))})).catch((e=>this.logger.error(e))))}))}_handleReinvite(e,t){if(0===t.length&&this._call){const e="Empty SDP from server. Call will be terminated.";return this.logger.error(e),E.CallPromiseResolver.reject(this._call,e),this._call.hangup({"X-WebRTCError":"no sdp"}),Promise.reject(e)}return new Promise(((e,n)=>{const r=e=>{const t="answer_reject: ".concat(e.message);this._call&&(this._call.dispatchEvent({name:"SDP",origin:"_handleReinvite",sdp:this.impl.localDescription,description:t}),E.CallPromiseResolver.reject(this._call,t)),n(e)};if(this.banReinviteAnswer){const e="Reinvite answer is banned";return E.CallPromiseResolver.reject(this._call,e),n(new Error(e))}if(!1===this.renegotiationInProgress)return E.CallPromiseResolver.resolve(this._call),e();if(!0===this.renegotiationInProgress){let n={sdp:t,type:b.answer};this.renegotiationInProgress=!1,this.srcRemoteSDP=t,n=f.SDPMuggle.removeTIAS(n),n=f.SDPMuggle.trimMediaAttr(n),this.impl.setRemoteDescription(n).then((()=>{this._call&&E.CallPromiseResolver.resolve(this._call),this.updateHoldState(),this.impl.getTransceivers().forEach(this.stopInactiveTransceiver.bind(this)),this.cleanStreamCache(),e()})).catch((e=>{this.renegotiationInProgress=!1,r(e),this.logger.error(JSON.stringify(e)),this.stopStreamsFromCache()})),clearTimeout(this.renegotiationTimer)}else{const e="Unreachable code for handling reinvite has reached";E.CallPromiseResolver.reject(this._call,e),n(new Error(e))}}))}_close(){clearInterval(this.rtcCollectingCycle),this.impl.onnegotiationneeded=null,h.Client.getInstance().config(),S.unregisterPeerConnection(this.impl),this.impl.close(),this._localStream=null,this._remoteStreams=null,this.logger.info("Peer Connection was closed.")}_addRemoteCandidate(e,t){return new Promise(((n,r)=>{try{const r=new RTCIceCandidate({candidate:e.substring(2),sdpMLineIndex:t});this.candidatePool.push(r),this._addIceCandidateToQueue(r,"remote").then(n)}catch(e){n()}}))}async _addIceCandidatesFromQueue(){if(this.logger.info("Adding ICE candidates from pool in state ".concat(this.impl.signalingState)),"stable"!==this.impl.signalingState)return;const e="remote",t=this.candidateQueueMap.get(e);this.candidateQueueMap.set(e,[]),this.logger.info("Adding ICE candidates ".concat(t.length?t:"[]")),t.forEach((e=>{this.impl.addIceCandidate(e)}))}async _addIceCandidateToQueue(e,t){var n;if(this.logger.info("Adding ".concat(t," candidate ").concat(e.candidate," in state ").concat(this.impl.signalingState)),"stable"===this.impl.signalingState)try{await this.impl.addIceCandidate(e)}catch(e){this.logger.error("Error on adding ICE candidate: ".concat(e))}else null===(n=this.candidateQueueMap.get(t))||void 0===n||n.push(e)}setConfiguration(e){this.impl&&setTimeout((()=>{if(this.srcRemoteSDP&&-1===this.srcRemoteSDP.indexOf("VIMS")||window.__VIIceServer__)if(this.impl&&this.impl.setConfiguration)this.impl.setConfiguration(e),this.renegotiationInProgress=!1,this._runReinvite(!0),setTimeout((()=>{this.candidatePool.forEach((e=>{this.impl.addIceCandidate(e).catch((()=>{}))}))}),2e3);else if(this._pendingOffer){let t=[];this.impl.getTransceivers().map((e=>{e.sender.track&&t.push(e.sender.track)})),this._createImpl(e),t.forEach((e=>{this.impl.addTrack(e,new MediaStream([e]))})),this.impl.createOffer().then((e=>(this.logger.info("setConfiguration(), created local SDP: \n".concat(e.sdp)),this._needIceRestart=!0,this.logger.info("setConfiguration(), set local SDP: \n".concat(this._pendingOffer.sdp)),this.impl.setLocalDescription(this._pendingOffer)))).then((()=>{this._pendingOffer=void 0})).catch((e=>{this._call&&this._call.dispatchEvent({name:"SDP",origin:"setConfiguration",sdp:this.impl.localDescription,description:"answer_reject: ".concat(e.message)}),console.error(e)}))}}),800)}_sendDTMF(e,t,n){try{this.dtmfSender.insertDTMF(e,t,n)}catch(r){this.dtmfSender=new l.SignalingDTMFSender(this._call.id()),this.dtmfSender.insertDTMF(e,t,n)}}_hdnFRSPrep(){this.banReinviteAnswer=!0}_hdnFRS(){this.renegotiationInProgress=!1,this.onRenegotiation()}_traceName(){return"TransreceiverPC"}hasLocalAudio(){return this.impl.getLocalStreams().some((e=>!!e.getAudioTracks().length))}enableVideo(e){let t=[];this._call&&(t=m.default.StreamManager.get()._getScreenSharing(this._call)||[]);const n=[];t.forEach((e=>e.stream.getTracks().forEach((e=>n.push(e.id))))),e?(this._call.settings.videoDirections.sendVideo=!0,m.default.StreamManager.get().getCallStream(this._call,!0).then((e=>{if(!e)throw new Error("Could not get call stream");this.addStreamToCache(e);let t=[];if(a.default.isIphone()||a.default.isIpad()){let n=e.getAudioTracks(),r=this._call.peerConnection.getTransceivers().find((e=>e.sender.track&&"audio"===e.sender.track.kind));t.push(this.__replaceTrack(r,n[0]))}let n=e.getVideoTracks();return n.length&&(this._call.settings.isConference?t.push(this._addVideoTransceiver(n[0],e,"video")):t.push(this._addNewVideoTransceiver(n[0],e,"video"))),Promise.all(t)})).then((e=>{const t=e.reduce(((e,t)=>(t===w.alreadyInProgress&&(e=!0),e)),!1);this.logger.info("Renegotiation was in progress: ".concat(t)),t?this.revertEnablingVideo():(m.default.StreamManager.get().updateLocalVideo(),this.updateSenderTrackTransformers())})).catch((e=>{this.revertEnablingVideo(),this.logger.error("Error during enableVideo(true): ".concat(e.message))}))):(t.length&&t.forEach((e=>{m.default.StreamManager.get()._clearScreenSharing(this._call,e)})),this.impl.getTransceivers().forEach((e=>{e.stopped||"sendrecv"!==e.currentDirection&&"sendonly"!==e.currentDirection&&"inactive"!==e.currentDirection||!e.sender.track||"video"!==e.sender.track.kind||this.__replaceTrack(e,null).then((()=>("sendonly"!==e.currentDirection||this._call.settings.isConference?e.direction="recvonly":e.stop(),this._call.settings.videoDirections.sendVideo=!1,this.onRenegotiation()))).catch((e=>{this.logger.warning("Wrong transceiver on replace")}))})))}revertEnablingVideo(){0!==this.streamCache.length&&(this.logger.info("Revert enableVideo in progress"),this._call.settings.videoDirections.sendVideo=!1,this.impl.getTransceivers().forEach((e=>{null!==e.mid&&null!==e.currentDirection||!e.sender.track||"video"!==e.sender.track.kind||this.__replaceTrack(e,null).then((()=>{if(this.renegotiationInProgress)throw new Error("Renegotiation in progress, it is forbidden to revert transceivers. Please rejoin to call to avoid unexpected results.");return this.onRenegotiation()})).then((()=>{e.stop(),this.logger.info("New call transceiver was stopped")})).catch((e=>{this.logger.error(e.message)})),this._call.settings.isConference&&null!==e.mid&&("sendrecv"===e.direction||"sendonly"===e.direction)&&e.sender.track&&"video"===e.sender.track.kind&&this.__replaceTrack(e,null).then((()=>{e.direction="recvonly",this.logger.info("Direction in conference transceiver was changed to `recvonly`")})).catch((e=>{this.logger.warning("Could not revet enabling video process after error. Reason: ".concat(e.message))}))})),this.stopStreamsFromCache(),this.logger.info("New streams were stopped. Revert enableVideo finished"))}_addNewVideoTransceiver(e,t,n){return new Promise(((r,i)=>{var a;const o=c.CallManager.get().getEndpointManager(this._call),s={direction:this._getDefaultDirection(),streams:[t]},l=e.getSettings();if(this.isSimulcast())s.sendEncodings=v.Utils.buildSimulcastLayers({trackSettings:l,trackType:n,profileName:null===(a=this._call)||void 0===a?void 0:a.settings.simulcastProfileName});else{const t=e.getSettings();s.sendEncodings=v.Utils.buildNotSimulcastLayers({trackSettings:t,trackType:n}),this.logger.info("New encodings params were applied for ".concat(n," track: ").concat(JSON.stringify(s.sendEncodings)))}let d=this.impl.addTransceiver(e,s);this.updateTransceiver(o,d),this.onRenegotiation().then(r).catch(i)}))}_replaceSharingToVideo(e,t){return new Promise((n=>{var r;const i=this.getTransceivers().filter((e=>e.sender.track&&"video"===e.sender.track.kind));if(i&&i.length){if(this.isSimulcast()){const n=v.Utils.buildSimulcastLayers({trackSettings:e.getSettings(),trackType:t,profileName:null===(r=this._call)||void 0===r?void 0:r.settings.simulcastProfileName});this._setEncodingsParams(i[0],n)}else{const n=v.Utils.buildNotSimulcastLayers({trackSettings:e.getSettings(),trackType:t});this.logger.info("New encodings params were applied for ".concat(t," track: ").concat(JSON.stringify(n))),this._setEncodingsParams(i[0],n)}this.__replaceTrack(i[0],e).then((()=>{m.default.StreamManager.get().isLocalVideoRequested&&m.default.StreamManager.get().updateLocalVideo(),this._runReinvite(),n()}))}else n()}))}getTransceivers(){return this.impl.getTransceivers?this.impl.getTransceivers():[]}getRemoteDescription(){return this.impl.remoteDescription&&this.impl.remoteDescription.sdp?this.impl.remoteDescription.sdp:""}_addCustomMedia(e){var t;if(!e||"closed"===this.impl.signalingState)return;let n="video";m.default.StreamManager.get()._getScreenSharing(this._call).forEach((t=>{t.stream.id===e.id&&(n="sharing")}));const r=c.CallManager.get().getEndpointManager(this._call),i=e.getAudioTracks(),o=this._getDefaultDirection();if(i.length)i.forEach((t=>{let n=this.getEmptyTransceiverForKind("audio");n?("inactive"!==n.direction&&"recvonly"!==n.direction||(n.direction=this._getDefaultDirection()),this.impl.addTrack(t,e),this.onRenegotiation()):(n=this.impl.addTransceiver(t,{direction:o,streams:[e]}),this.onRenegotiation()),this.updateTransceiver(r,n)}));else if("sharing"!==n){const e=this.impl.addTransceiver("audio",{direction:"recvonly"});this.onRenegotiation(),this.updateTransceiver(r,e)}const s=e.getVideoTracks();if(s.length){const t=this.impl.getTransceivers().filter((e=>"video"===e.receiver.track.kind&&!("inactive"===e.direction||"stopped"===e.direction)&&"inactive"!==e.currentDirection&&!e.stopped));"sharing"!==n&&t.length?s.forEach((t=>{this._addVideoTransceiver(t,e,n)})):s.forEach((t=>{this._addNewVideoTransceiver(t,e,n)}))}else{if(!this._call.settings.isConference&&this.impl.getTransceivers().filter((e=>"video"===e.receiver.track.kind)).length)return;if(this._call.settings.isAudio)return;const i={direction:"recvonly",streams:[e]};this.isSimulcast()?i.sendEncodings=v.Utils.buildSimulcastLayers({trackSettings:null,trackType:n,profileName:null===(t=this._call)||void 0===t?void 0:t.settings.simulcastProfileName}):(i.sendEncodings=v.Utils.buildNotSimulcastLayers({trackSettings:null,trackType:n}),this.logger.info("New encodings params were applied for ".concat(n," track: ").concat(JSON.stringify(i.sendEncodings))));const a=this.impl.addTransceiver("video",i);this.onRenegotiation(),this.updateTransceiver(r,a)}if(!this.dtmfSender&&this._call){const e=a.default.getDTMFSender(this.impl,this._call.id());e&&(this.dtmfSender=e)}setTimeout((()=>{this.updateSenderTransformers(),this.updateSenderTrackTransformers()}),2e3)}getEmptyTransceiverForKind(e){return this._call&&this._call.settings.isConference?this.impl.getTransceivers().find((t=>"safari"===a.default.getWSVendor()?!isNaN(Number(t.mid))&&"recvonly"===t.direction&&t.receiver.track.kind===e&&!t.sender.track:!(isNaN(Number(t.mid))||"recvonly"!==t.direction&&"inactive"!==t.direction||t.receiver.track.kind!==e||t.sender.track||t.stopped))):this.impl.getTransceivers().find((t=>t.receiver.track.kind===e&&!t.sender.track&&!t.stopped))}updateTransceiver(e,t){e.updateTransceiver(t)}_removeCustomMedia(e){if(!e)return;this.renegotiationInProgress=!0;const t=this.impl.getTransceivers();e.getTracks().forEach((e=>{let n;n=this._call.settings.isConference?t.find((t=>!isNaN(Number(t.mid))&&t.sender.track&&t.sender.track===e)):t.find((t=>t.sender.track&&t.sender.track===e)),n&&this.__replaceTrack(n,null).then((()=>{"sendonly"!==n.currentDirection||this._call.settings.isConference||n.stop(),this.renegotiationInProgress=!1,this._runReinvite()}))}))}async _updateCustomMedia(e){const t=await this.updateMediaTracks(e);t&&t.length&&(this.updateSenderTrackTransformers(),this._runReinvite())}async updateMediaTracks(e){if(!e||"closed"===this.impl.signalingState)return;const t=[];return e.getTracks().forEach((e=>{const n=this.impl.getTransceivers().find((t=>t.sender.track&&t.sender.track.kind===e.kind));n&&t.push(this.__replaceTrack(n,e))})),await Promise.all(t)}_fixFFSoundBug(){"firefox"===a.default.getWSVendor()&&o.PCFactory.hasTransceivers&&setTimeout((()=>{this.impl.getSenders&&this.impl.getSenders().forEach((e=>{if(e.replaceTrack){const t=e.track;e.replaceTrack(t)}}))}),1e3)}getConfiguration(){return this.impl?this.impl.getConfiguration():null}_hold(e){this.onHold=e,this.impl.getTransceivers().forEach((t=>{t.stopped||"stopped"===t.direction||"stopped"===t.currentDirection||(t.direction=e?"sendonly":"sendrecv")})),this._runReinvite()}_getDirections(){let e={};return e.local=f.SDPMuggle.detectDirections(this.impl.localDescription.sdp),e.remote=f.SDPMuggle.detectDirections(this.impl.remoteDescription.sdp),e}_createImpl(e){if(h.Client.getInstance().config()&&h.Client.getInstance().config().experiments&&h.Client.getInstance().config().experiments.relayOnly&&(e=Object.assign(Object.assign({},e),{iceTransportPolicy:"relay"})),h.Client.getInstance().isInsertableStreamsSupported()&&(this.logger.warning("encodedInsertableStreams is enabled"),e=Object.assign(Object.assign({},e),{encodedInsertableStreams:!0})),this.mode===i.PeerConnectionMode.CONFERENCE&&"chrome"===a.default.getWSVendor()){const t={mandatory:{},optional:[]},n=RTCPeerConnection;this.impl=new n(e,t)}else this.impl=new RTCPeerConnection(e);this._call=c.CallManager.get().calls[this.id],_.registerSource(this.impl,(e=>{if(this._call){const t={};this._call.getEndpoints().forEach((e=>{e.mediaRenderers.forEach((n=>{n.transceivers[0]&&n.transceivers[0].receiver&&n.transceivers[0].receiver.track&&(t[n.transceivers[0].receiver.track.id]={mr:n.id,ep:e.id})}))}));const n={};for(let r in e.inbound)t[r]?(n[t[r].mr]=e.inbound[r],n[t[r].mr].endpoint=t[r].ep):n[r]=e.inbound[r];e.inbound=n,this._call.dispatchEvent({name:g.CallEvents.CallStatsReceived,stats:e})}}),null,this._call),this.impl.getTransceivers&&"firefox"===a.default.getWSVendor()&&(o.PCFactory.hasTransceivers=!0),this.impl.addEventListener("track",(e=>this.onAddTrack(e))),this.impl.onicecandidate=e=>{this.onICECandidate(e.candidate)},this.renegotiationInProgress=!1,this.impl.onsignalingstatechange=e=>this.onSignalingStateChange(),this.impl.oniceconnectionstatechange=e=>this.onConnectionChange(),this.impl.onconnectionstatechange=e=>{this._call&&this._call.dispatchEvent({name:"SDP",origin:"onconnectionstatechange",description:this.impl.connectionState})},this.impl.onicegatheringstatechange=e=>{this._call&&this._call.dispatchEvent({name:"SDP",origin:"onicegatheringstatechange",description:this.impl.iceGatheringState})},this.iceRole=M.controlling,this._remoteStreams=[],this.banReinviteAnswer=!1,void 0!==this._call?this.onHold=!this._call.active():this.onHold=!1,this.needTransportRestart=!1,"_default"!==this.id&&c.CallManager.get().calls[this.id]&&(this.reInviteQ=new p.ReInviteQ(c.CallManager.get().calls[this.id],this._canReInvite))}onSignalingStateChange(){this._call&&this._call.dispatchEvent({name:"SDP",origin:"onsignalingstatechange",description:this.impl.signalingState}),this.logger.info("Signal state changed to "+this.impl.signalingState+" for PC: "+this.id),"stable"===this.impl.signalingState&&(this.reInviteQ&&this.reInviteQ.runNext(),this._addIceCandidatesFromQueue())}onConnectionChange(){this.logger.info("PCS: ".concat(this.impl.connectionState," ").concat(this.impl.iceConnectionState)),this._call&&this._call.dispatchEvent({name:"SDP",origin:"oniceconnectionstatechange",description:this.impl.iceConnectionState}),"failed"!==this.impl.iceConnectionState&&"disconnected"!==this.impl.iceConnectionState||c.CallManager.get().icerestart(),"closed"===this.impl.connectionState&&this._call&&C.get().remCallStream(this._call),"completed"===this.impl.iceConnectionState&&void 0!==this._call&&(this._call.dispatchEvent({name:"ICECompleted",call:this._call}),clearTimeout(this.iceTimer)),"completed"!==this.impl.iceConnectionState&&"connected"!==this.impl.iceConnectionState||(this.iceTimer&&clearTimeout(this.iceTimer),this.iceTimer=null,this.reInviteQ&&this.reInviteQ.runNext())}async onRenegotiation(){if(this._call&&this._call.dispatchEvent({name:"SDP",origin:"negotiationneeded",description:"negotiationneeded"}),void 0===this.impl)throw new Error("PeerConnection is not configured");if("disconnected"===this.impl.connectionState||"failed"===this.impl.connectionState)throw this.logger.info("Renegotiation requested on closed PeerConnection"),new Error("Renegotiation requested on closed PeerConnection");if(null!==this.impl.localDescription){if("connected"!==this.impl.iceConnectionState&&"completed"!==this.impl.iceConnectionState)return this.logger.info("Renegotiation requested while ice state is "+this.impl.iceConnectionState+". Postponing"),void setTimeout(this.onRenegotiation,100);if(this.renegotiationInProgress)return this.logger.info("Renegotiation in progress. Queueing"),w.alreadyInProgress;this.logger.info("Renegotiation started"),await this._runReinvite()}else this.logger.info("Renegotiation needed, but no local SDP. Skipping")}getReceiveOptions(){return{offerToReceiveAudio:!this.onHold,offerToReceiveVideo:!this.onHold,voiceActivityDetection:!0}}onICECandidate(e){e&&""!==e.candidate?this.sendLocalCandidateToPeer("a="+e.candidate,e.sdpMLineIndex):this.logger.info("End of candidates")}onAddTrack(e){if(this._call){const t=c.CallManager.get().getEndpointManager(this._call);this._call.settings.isConference||"inactive"!==e.transceiver.direction||(e.transceiver.direction="recvonly"),this.updateTransceiver(t,e.transceiver)}}_runReinvite(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise(((t,n)=>{if(!1===this.renegotiationInProgress){this.renegotiationInProgress=!0;let r={};!a.default.isIphone()&&(this._call.settings.isConference||this.impl.getTransceivers&&"firefox"===a.default.getWSVendor())||(r=this.getReceiveOptions()),e&&(r.iceRestart=!0),this.logger.trace(JSON.stringify(r)),this.updateHoldState(),this.resetEncodings().then((()=>this.impl.createOffer(r))).then((e=>(this.logger.info("_runReinvite(), created local SDP: \n".concat(e.sdp)),this.codecRearrange(e)))).then((e=>{let t={type:e.type,sdp:e.sdp};return t=o.PCFactory.get().addBandwidthParams(t),t=f.SDPMuggle.removeTelephoneEvents(t),t=f.SDPMuggle.removeDoubleOpus(t),t=f.SDPMuggle.removeDoublePT(t),t=f.SDPMuggle.trimMediaAttr(t),t=f.SDPMuggle.removeDoubleCodecsInactiveSections(t),t=this._reduceCodecs(t),t})).then((t=>(this.srcLocalSDP=t.sdp,this.impl.setLocalDescription(t).then((()=>{this.logger.info("_handleReinvite(), set remote SDP: \n".concat(t.sdp)),this._call&&this._call.dispatchEvent({name:"SDP",origin:"handleReinviteInProgress",sdp:t.sdp});let n={mids:this.getMidKinds(),iceRestart:e};y.default.callRemoteFunction(d.RemoteFunction.reInvite,this._call.id(),{},t.sdp,n)}))))).then(t).catch((e=>{if(this._call){const t="offer_reject: Error when renegotiation start ".concat(e.message);this._call.dispatchEvent({name:"SDP",origin:"_runReinvite",sdp:this.impl.localDescription,description:t}),E.CallPromiseResolver.reject(this._call,t)}this.renegotiationInProgress=!1,this.logger.error("Error when renegotiation start "+e.message),n(e)}))}else{const e="Another renegotiation in progress";E.CallPromiseResolver.reject(this._call,e),this.logger.error(e),n(new Error(e))}}))}codecRearrange(e){return new Promise(((t,n)=>{let r=c.CallManager.get().calls[this.id];if(void 0!==r){let i=new u.CodecSorter(e.sdp),a=i.getUserCodecList();void 0!==r.rearangeCodecs?r.rearangeCodecs(a,r.settings.incoming).then((n=>{i.setUserCodecList(n),t({type:e.type,sdp:i.getSDP()})}),(e=>{this.logger.error(JSON.stringify(e)),this._call&&this._call.dispatchEvent({name:"SDP",origin:"codecRearrange",sdp:this.impl.localDescription,description:"reject: ".concat(e.message)}),n(e)})):(i.setUserCodecList(a),this.logger.info("No sdp codecs transformer registered"),t({type:e.type,sdp:i.getSDP()}))}else t(e)}))}__replaceTrack(e,t){return new Promise(((n,r)=>{const i=e.sender.track;a.default.isIpad()&&!t?(this.impl.removeTrack(e.sender),n()):e.sender.replaceTrack(t).then((()=>{!i||t&&i.id===t.id||a.default.isIphone()||a.default.isIpad()||(i.enabled=!1,i.onended=null,i.onmute=null,i.stop()),n()})).catch((t=>{this.logger.warning("The attempt to replace track for ".concat(e.mid," failed")),r()}))}))}_setEncodingsParams(e,t){if(this.isSimulcast()){let n=e.sender.getParameters();n&&n.encodings&&n.encodings.length>1&&n.encodings.forEach((e=>{let n=t.find((t=>t.rid===e.rid));(null==n?void 0:n.maxBitrate)&&(e.maxBitrate=n.maxBitrate),(null==n?void 0:n.maxFramerate)&&(e.maxFramerate=n.maxFramerate),(null==n?void 0:n.scaleResolutionDownBy)&&(e.scaleResolutionDownBy=n.scaleResolutionDownBy)})),e.sender.setParameters(n)}else{let n=e.sender.getParameters();n&&n.encodings&&n.encodings[0]&&t[0]&&(t[0].maxBitrate&&(n.encodings[0].maxBitrate=t[0].maxBitrate),t[0].maxFramerate&&(n.encodings[0].maxFramerate=t[0].maxFramerate),t[0].scaleResolutionDownBy&&(n.encodings[0].scaleResolutionDownBy=t[0].scaleResolutionDownBy)),e.sender.setParameters(n)}}_getDefaultDirection(){return this._call&&this._call.settings.isConference&&this._call.settings.simulcast?"sendonly":"sendrecv"}_addVideoTransceiver(e,t,n){return new Promise(((r,i)=>{var a,o;const s=c.CallManager.get().getEndpointManager(this._call),l={direction:this._getDefaultDirection(),streams:[t]};let d=this.getEmptyTransceiverForKind("video");const u=e.getSettings();if(d){if("inactive"!==d.direction&&"recvonly"!==d.direction||(d.direction=this._getDefaultDirection()),this.isSimulcast()){const e=v.Utils.buildSimulcastLayers({trackSettings:u,trackType:n,profileName:null===(a=this._call)||void 0===a?void 0:a.settings.simulcastProfileName});this._setEncodingsParams(d,e)}this.onHold&&(d.direction="sendonly"),this.__replaceTrack(d,e).then((()=>(this.updateTransceiver(s,d),this.onRenegotiation()))).then(r).catch(i)}else{if(this.isSimulcast())l.sendEncodings=v.Utils.buildSimulcastLayers({trackSettings:u,trackType:n,profileName:null===(o=this._call)||void 0===o?void 0:o.settings.simulcastProfileName});else{const t=e.getSettings();l.sendEncodings=v.Utils.buildNotSimulcastLayers({trackSettings:t,trackType:n}),this.logger.info("New encodings params were applied for ".concat(n," track: ").concat(JSON.stringify(l.sendEncodings)))}d=this.impl.addTransceiver(e,l),this.updateTransceiver(s,d),this.onRenegotiation().then(r).catch(i)}}))}_reduceCodecs(e){const t=[{name:"H264",params:{"profile-level-id":"42e0"}},{name:"VP8"},{name:"red",optional:!0},{name:"ulpfec",optional:!0}],n=[{name:"telephone-event/8000"},{name:"opus"}],r=h.Client.getInstance().limitVCodecs||t,i=h.Client.getInstance().limitACodecs||n;if(h.Client.getInstance().limitVCodecs||h.Client.getInstance().limitACodecs){const t=f.SDPMuggle.reduceCodecs(e,{video:r,audio:i}).sdp;return this.logger.info("_reduceCodecs(), SDP after codec was reduced: \n".concat(t.sdp)),t}if(!this._call.settings.isConference)return e;const a=f.SDPMuggle.reduceCodecs(e,{audio:n,video:t}).sdp;return this.logger.info("_reduceCodecs(), SDP after codec was reduced: \n".concat(a.sdp)),a}isSimulcast(){return this._call&&!a.default.isIphone()&&this._call.settings.isConference&&this._call.settings.simulcast}updateSenderTransformers(){h.Client.getInstance().isInsertableStreamsSupported()&&this._call&&this.impl.getTransceivers().forEach((e=>{var t;if(null===(t=e.sender)||void 0===t?void 0:t.track){let t;this._TransceiverEncoderMap.has(e)?t=this._TransceiverEncoderMap.get(e):(t=e.sender.createEncodedStreams(),this._TransceiverEncoderMap.set(e,t));const n="audio"===e.sender.track.kind?this._call.audioSenderTransform:this._call.videoSenderTransform;t.readable.pipeThrough(n).pipeTo(t.writable)}}))}updateSenderTrackTransformers(){if(!h.Client.getInstance().isMediaTrackInsertableStreamSupported()||!this._call)return;let e=[];e=m.default.StreamManager.get()._getScreenSharing(this._call)||[];const t=[];e.forEach((e=>e.stream.getTracks().forEach((e=>t.push(e.id))))),this.impl.getTransceivers().forEach((async e=>{var n;if((null===(n=e.sender)||void 0===n?void 0:n.track)&&!t.includes(e.sender.track.id)){let t;const n=e.sender.track;"audio"===n.kind&&"function"==typeof this._call.audioMediaTrackTransform?t=await this._call.audioMediaTrackTransform(n):"video"===n.kind&&"function"==typeof this._call.videoMediaTrackTransform&&(t=await this._call.videoMediaTrackTransform(n)),t&&e.sender.replaceTrack(t)}}))}manageLayers(e){const t=this.impl.getTransceivers().filter((e=>-1!==e.currentDirection.indexOf("send"))).filter((e=>"video"===e.sender.track.kind));t.length&&this.isSimulcast()&&t.forEach((t=>{const n=t.sender.getParameters();n&&n.encodings&&n.encodings.length>1&&(n.encodings=n.encodings.map((t=>(t.rid&&t.maxBitrate&&(t.active=e.includes(t.rid)),t))));try{t.sender.setParameters(n)}catch(e){this.logger.error("Can't update simulcast parameters")}}))}async resetEncodings(){var e;const t=this.impl.getTransceivers();for(let n of t)if(!isNaN(Number(n.mid))&&"audio"!==(null===(e=n.receiver.track)||void 0===e?void 0:e.kind)&&"inactive"!==n.direction&&"stopped"!==n.direction&&!n.stopped&&(this.logger.info("Reset simulcast layers for mid=".concat(n.mid)),"null"!==n.mid)){const e=n.sender.getParameters();e&&e.encodings&&(e.encodings=e.encodings.map((e=>(e.active=!0,e))),await n.sender.setParameters(e))}}stopInactiveTransceiver(e){"inactive"!==e.currentDirection||this._call.settings.isConference||(e.stop(),this.logger.info("Transceiver ".concat(e.mid," was stopped.")))}addStreamToCache(e){this.streamCache.push(e)}cleanStreamCache(){this.streamCache=[]}stopStreamsFromCache(){this.streamCache.forEach((e=>{m.default.StreamManager.get()._remCallStream(e)})),this.cleanStreamCache()}}r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_getLocalOfferRegular",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"updateHoldState",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_processRemoteAnswer",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_getLocalOffer",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_getLocalOfferFF",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_getLocalAnswer",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_setRemoteDescription",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_handleReinvite",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_close",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_addRemoteCandidate",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"setConfiguration",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_sendDTMF",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_hdnFRSPrep",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_hdnFRS",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"hasLocalAudio",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"enableVideo",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"revertEnablingVideo",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_replaceSharingToVideo",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_addCustomMedia",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_removeCustomMedia",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_updateCustomMedia",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_fixFFSoundBug",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"getConfiguration",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_hold",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_createImpl",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"onSignalingStateChange",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"onConnectionChange",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"onRenegotiation",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"getReceiveOptions",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"onICECandidate",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"onAddTrack",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"codecRearrange",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_setEncodingsParams",null),r([s.LogManager.d_trace(s.LogCategory.RTC)],R.prototype,"_reduceCodecs",null),t.TransreceiverPC=R},6278:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfSignalingRemoteFunctions=t.ConfSignalingRemoteEvents=t.ConfSignaling=t.ConfSignalingState=void 0;const i=n(1150),a=n(2282),o=n(8597),s=n(1901);var l;!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.CLOSED=2]="CLOSED"}(l=t.ConfSignalingState||(t.ConfSignalingState={}));class c{constructor(e){this.call=e,this.reconnectionAttempts=10,this.logger=i.LogManager.get().createLogger(i.LogCategory.SIGNALING,this._traceName()),this.currentState=l.CONNECTING,e.sysOn(a.CallEvents.Connected,(t=>{const n=t=>{try{let r=JSON.parse(t.text);"vi/upgrade"===r.event&&(this.rand=r.rand,this.connectTo(r.url),e.sysOff(a.CallEvents.MessageReceived,n))}catch(e){this.logger.warning("Can't parse JSON data: "+e.text)}};e.sysOn(a.CallEvents.MessageReceived,n),e.sendMessage("vi/upgrade")}))}_traceName(){return"ConfSignaling"}connectTo(e){this.lastWSUrl=e,this.ws=new WebSocket(e),this.ws.onopen=e=>this.onWSConnected(),this.ws.onclose=e=>this.onWSClosed(e),this.ws.onerror=e=>this.onWSError(e),this.ws.onmessage=e=>this.onWSData(e.data)}onWSConnected(){this.connectingTimer=setTimeout((()=>{this.ws.close()}),2e3),this.ws.send(this.rand)}onWSClosed(e){this.ws&&(this.ws.close(),this.ws=void 0),this.currentState=l.CLOSED,e.wasClean||this.reconnect()}reconnect(){this.reconnectionAttempts>0&&(this.reconnectionAttempts--,this.connectTo(this.lastWSUrl))}onWSError(e){this.ws.close(),this.ws=void 0,this.currentState=l.CLOSED,this.logger.warning("Error in onConfSignalingConnectionFailed callback: "+e)}onWSData(e){var t;let n;try{switch(n=JSON.parse(e),n.name){case"vad":this.call.getEndpoints().forEach((e=>{if(e.id===n.endpoint){let t=o.EndpointEvents.VoiceEnd;n.enabled&&(t=o.EndpointEvents.VoiceStart),e.dispatchEvent({name:t,call:this.call,endpoint:e})}}));break;case"hello":clearInterval(this.connectingTimer),this.reconnectionAttempts=10,this.currentState=l.CONNECTED;break;case"endpointStreamsUpdated":this.logger.info("Received endpointStreamsUpdated event with payload ".concat(JSON.stringify(n.payload))),n.payload&&(null===(t=s.EndpointStreamsUpdatedHandler.getInstanceBy(this.call))||void 0===t||t.handle(n.payload));break;case"message":this.call.dispatchEvent({name:a.CallEvents.MessageReceived,call:this.call,text:n.payload});break;default:this.logger.info("Unknown command: "+n.name)}}catch(t){this.logger.warning("Can't parse JSON data: "+e)}}runFunction(e,t){this.ws.send(JSON.stringify({name:e,payload:t}))}}r([i.LogManager.d_trace(i.LogCategory.SIGNALING)],c.prototype,"connectTo",null),r([i.LogManager.d_trace(i.LogCategory.SIGNALING)],c.prototype,"onWSConnected",null),r([i.LogManager.d_trace(i.LogCategory.SIGNALING)],c.prototype,"onWSClosed",null),r([i.LogManager.d_trace(i.LogCategory.SIGNALING)],c.prototype,"reconnect",null),r([i.LogManager.d_trace(i.LogCategory.SIGNALING)],c.prototype,"onWSError",null),r([i.LogManager.d_trace(i.LogCategory.SIGNALING)],c.prototype,"onWSData",null),t.ConfSignaling=c,function(e){e.VAD="vad",e.MUTE="mute",e.MANAGE_ENDPOINTS="manageEndpoints",e.MESSAGE="message",e.ENDPOINT_STREAMS_UPDATED="endpointStreamsUpdated"}(t.ConfSignalingRemoteEvents||(t.ConfSignalingRemoteEvents={})),function(e){e.MUTE="mute",e.MANAGE_ENDPOINTS="manageEndpoints",e.MESSAGE="message",e.REQUEST_VIDEO_SIZE="requestVideoSize"}(t.ConfSignalingRemoteFunctions||(t.ConfSignalingRemoteFunctions={}))},8202:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MsgAction=void 0,function(e){e.UNKNOWN="UNKNOWN",e.createConversation="createConversation",e.editConversation="editConversation",e.removeConversation="removeConversation",e.joinConversation="joinConversation",e.leaveConversation="leaveConversation",e.getConversation="getConversation",e.getConversations="getConversations",e.getPublicConversations="getPublicConversations",e.searchConversations="searchConversations",e.removeEmptyConversation="removeEmptyConversation",e.addParticipants="addParticipants",e.editParticipants="editParticipants",e.removeParticipants="removeParticipants",e.getUser="getUser",e.getUsers="getUsers",e.editUser="editUser",e.setStatus="setStatus",e.sendMessage="sendMessage",e.editMessage="editMessage",e.removeMessage="removeMessage",e.typingMessage="typingMessage",e.isRead="isRead",e.subscribe="subscribe",e.unsubscribe="unsubscribe",e.manageNotification="manageNotification",e.getSubscriptionList="getSubscriptionList",e.createBot="createBot",e.removeBot="removeBot",e.retransmitEvents="retransmitEvents"}(t.MsgAction||(t.MsgAction={}))},249:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MsgEvent=void 0,function(e){e.onError="onError",e.onCreateConversation="onCreateConversation",e.onEditConversation="onEditConversation",e.onRemoveConversation="onRemoveConversation",e.onGetConversation="onGetConversation",e.onGetPublicConversations="onGetPublicConversations",e.onGetUser="onGetUser",e.onEditUser="onEditUser",e.onSetStatus="onSetStatus",e.onSendMessage="onSendMessage",e.onEditMessage="onEditMessage",e.onRemoveMessage="onRemoveMessage",e.isRead="isRead",e.onTyping="onTyping",e.onSubscribe="onSubscribe",e.onUnsubscribe="onUnsubscribe",e.onGetSubscriptionList="onGetSubscriptionList",e.onCreateBot="onCreateBot",e.onRemoveBot="onRemoveBot",e.onRetransmitEvents="onRetransmitEvents"}(t.MsgEvent||(t.MsgEvent={}))},7050:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.MsgSignaling=void 0;const i=n(1150),a=n(249),o=n(3576),s=n(6968),l=n(209),c=n(245);class d extends o.EventTarget{constructor(){if(super(),d.instance)throw new Error("Error - use Client.getMessagingInstance()");this.query=[],setInterval((()=>{this.updateQuery()}),220)}static get(){return d.instance=d.instance||new d,d.instance}capitalize(e){return e.toString()[0].toUpperCase()+e.toString().slice(1)}updateQuery(){if(this.query.length){const e=this.query.splice(0,1);c.default.sendRaw(e[0])}}addEventListener(e,t,n){super.addEventListener(e,t,n)}dispatchMsgEvent(e,t){var n,r;if(null===(n=this.eventListeners)||void 0===n?void 0:n[e]){const n=this.eventListeners[e];for(let e of n)null===(r=e.listener)||void 0===r||r.call(e,null==t?void 0:t.payload,null==t?void 0:t.request_uuid)}}handleWsData(e){if(-1==Object.values(a.MsgEvent).indexOf(e.event))throw new Error("Unknown messaging event "+e.event+" with payload "+JSON.stringify(e.payload));this.dispatchMsgEvent(e.event,e)}sendWsMessage(e,t){const n=["subscribe","unsubscribe","typingMessage","isRead","setStatus"].includes(e)?"CommonNamespace":"IncomingNamespace",r=(new l.default).toString(),i={service:s.MsgService.Chat,event:e,payload:Object.assign(t,{"@type":"type/vox.store.".concat(n,".").concat({setStatus:"PresenceMessage",isRead:"StatusMessage",typingMessage:"TypingMessage",subscribe:"ManageSubscribes",unsubscribe:"ManageSubscribes",addParticipants:"ManageParticipants",editParticipants:"ManageParticipants",manageNotification:"ManageNotifications",getPublicConversations:"GetConversations",retransmitEvents:"RetransmitRequest"}[e]||this.capitalize(e))}),request_uuid:r};return this.query.push(i),r}_traceName(){return"MsgSignaling"}}r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],d.prototype,"handleWsData",null),r([i.LogManager.d_trace(i.LogCategory.MESSAGING)],d.prototype,"sendWsMessage",null),t.MsgSignaling=d},575:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteEvent=void 0,function(e){e[e.loginFailed="loginFailed"]="loginFailed",e[e.loginSuccessful="loginSuccessful"]="loginSuccessful",e[e.handleError="handleError"]="handleError",e[e.onPCStats="__onPCStats"]="onPCStats",e[e.handleIncomingConnection="handleIncomingConnection"]="handleIncomingConnection",e[e.handleConnectionConnected="handleConnectionConnected"]="handleConnectionConnected",e[e.handleConnectionDisconnected="handleConnectionDisconnected"]="handleConnectionDisconnected",e[e.handleRingOut="handleRingOut"]="handleRingOut",e[e.startEarlyMedia="startEarlyMedia"]="startEarlyMedia",e[e.stopRinging="stopRinging"]="stopRinging",e[e.handleConnectionFailed="handleConnectionFailed"]="handleConnectionFailed",e[e.handleSIPInfo="handleSIPInfo"]="handleSIPInfo",e[e.handleSipEvent="handleSipEvent"]="handleSipEvent",e[e.handleTransferStarted="handleTransferStarted"]="handleTransferStarted",e[e.handleTransferComplete="handleTransferComplete"]="handleTransferComplete",e[e.handleTransferFailed="handleTransferFailed"]="handleTransferFailed",e[e.handleReInvite="handleReInvite"]="handleReInvite",e[e.handleAcceptReinvite="handleAcceptReinvite"]="handleAcceptReinvite",e[e.handleRejectReinvite="handleRejectReinvite"]="handleRejectReinvite",e[e.createPC="__createPC"]="createPC",e[e.destroyPC="__destroyPC"]="destroyPC",e[e.connectionSuccessful="__connectionSuccessful"]="connectionSuccessful",e[e.connectionFailed="__connectionFailed"]="connectionFailed",e[e.createConnection="__createConnection"]="createConnection",e[e.pong="__pong"]="pong",e[e.increaseGain="increaseGain"]="increaseGain",e[e.handlePreFlightCheckResult="handlePreFlightCheckResult"]="handlePreFlightCheckResult",e[e.handleVoicemail="handleVoicemail"]="handleVoicemail",e[e.onCallRemoteFunctionError="onCallRemoteFunctionError"]="onCallRemoteFunctionError",e[e.refreshOauthTokenFailed="refreshOauthTokenFailed"]="refreshOauthTokenFailed",e[e.refreshOauthTokenSuccessful="refreshOauthTokenSuccessful"]="refreshOauthTokenSuccessful",e[e.registerPushTokenResult="registerPushTokenResult"]="registerPushTokenResult",e[e.unregisterPushTokenResult="unregisterPushTokenResult"]="unregisterPushTokenResult",e[e.sipRegisterSuccessful="sipRegisterSuccessful"]="sipRegisterSuccessful",e[e.sipRegisterFailed="sipRegisterFailed"]="sipRegisterFailed",e[e.onACDStatus="onACDStatus"]="onACDStatus",e[e.SQMessagingStatusUpdated="SQMessagingStatusUpdated"]="SQMessagingStatusUpdated",e[e.onSQStatusError="onSQStatusError"]="onSQStatusError",e[e.onICEConfig="onICEConfig"]="onICEConfig",e[e.onICEConfigFailed="onICEConfigFailed"]="onICEConfigFailed"}(t.RemoteEvent||(t.RemoteEvent={}))},4106:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteFunction=void 0,function(e){e[e.ping="__ping"]="ping",e[e.login="login"]="login",e[e.loginGenerateOneTimeKey="loginGenerateOneTimeKey"]="loginGenerateOneTimeKey",e[e.loginStage2="loginStage2"]="loginStage2",e[e.setOperatorACDStatus="setOperatorACDStatus"]="setOperatorACDStatus",e[e.getOperatorACDStatus="getOperatorACDStatus"]="getOperatorACDStatus",e[e.setOperatorMessagingStatus="setOperatorMessagingStatus"]="setOperatorMessagingStatus",e[e.getOperatorMessagingStatus="getOperatorMessagingStatus"]="getOperatorMessagingStatus",e[e.setDesiredVideoBandwidth="setDesiredVideoBandwidth"]="setDesiredVideoBandwidth",e[e.rejectCall="rejectCall"]="rejectCall",e[e.disconnectCall="disconnectCall"]="disconnectCall",e[e.sendDTMF="sendDTMF"]="sendDTMF",e[e.sendSIPInfo="sendSIPInfo"]="sendSIPInfo",e[e.hold="hold"]="hold",e[e.unhold="unhold"]="unhold",e[e.acceptCall="acceptCall"]="acceptCall",e[e.createCall="createCall"]="createCall",e[e.callConference="callConference"]="callConference",e[e.transferCall="transferCall"]="transferCall",e[e.muteLocal="__muteLocal"]="muteLocal",e[e.reInvite="ReInvite"]="reInvite",e[e.acceptReInvite="AcceptReInvite"]="acceptReInvite",e[e.rejectReInvite="RejectReInvite"]="rejectReInvite",e[e.confirmPC="__confirmPC"]="confirmPC",e[e.addCandidate="__addCandidate"]="addCandidate",e[e.loginUsingOneTimeKey="loginUsingOneTimeKey"]="loginUsingOneTimeKey",e[e.refreshOauthToken="refreshOauthToken"]="refreshOauthToken",e[e.confirmIncomingConnection="confirmIncomingConnection"]="confirmIncomingConnection",e[e.zPromptFinished="promptFinished"]="zPromptFinished",e[e.zStartPreFlightCheck="__startPreFlightCheck"]="zStartPreFlightCheck",e[e.registerPushToken="registerPushToken"]="registerPushToken",e[e.unregisterPushToken="unregisterPushToken"]="unregisterPushToken",e[e.pushFeedback="pushFeedback"]="pushFeedback",e[e.refreshIceConfig="refreshIceConfig"]="refreshIceConfig"}(t.RemoteFunction||(t.RemoteFunction={}))},245:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoxSignalingState=void 0;const r=n(2262),i=n(7050),a=n(3576),o=n(125),s=n(141),l=n(308),c=[];let d=null;class u extends a.EventTarget{}const g=new u;function f(e,t){1===e&&2===t&&c.forEach((e=>e.onSignalingConnected())),3===t&&c.forEach((e=>e.onSignalingConnectionFailed(""))),4===t&&o.Client.getInstance().dispatchEvent({name:s.Events.Reconnecting}),4===e&&2===t&&(o.Client.getInstance().dispatchEvent({name:s.Events.Reconnected}),l.CallManager.get().icerestart()),5===t&&c.forEach((e=>e.onSignalingClosed()))}function h(e){e.service?i.MsgSignaling.get().handleWsData(e):g.eventListeners[e.name]&&g.eventListeners[e.name].forEach((t=>t.listener.apply(null,e.params)))}const p={setRPCHandler:function(e,t){g.addEventListener(e,t)},removeRPCHandler:function(e,t){g.removeEventListener(e,t)},callRemoteFunction:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return d.send({name:e,params:n}),!0},addHandler:function(e){c.push(e)},onConnectionFailedRPC:function(){},currentState:function(){if(!d)return m.IDLE;switch(d.state){case 0:case 3:case 5:default:return m.IDLE;case 1:return m.CONNECTING;case 2:case 4:return m.CONNECTED}},disconnect:async function(){d&&(await d.clear(),d=null)},connect:async function(e,t){if(!d||5===d.state||3===d.state)return d=new r.Connection(e,2,Array.isArray(t)?t:[t]),d.outerMessageHandler=h,d.outerStateHandler=f,await d.connect(),2===d.state||(await d.clear(),d=null,!1)},sendRaw:function(e){return d.send(e)}};var m;!function(e){e[e.IDLE=0]="IDLE",e[e.CONNECTING=1]="CONNECTING",e[e.WSCONNECTED=2]="WSCONNECTED",e[e.CONNECTED=3]="CONNECTED",e[e.CLOSING=4]="CLOSING"}(m=t.VoxSignalingState||(t.VoxSignalingState={})),t.default=p},2262:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},i=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0;const a=n(4234),o=n(1783),s=n(5383),l=n(3658),c=n(2071),d=n(9367),u=n(1666),g=n(125),f=n(1150),h=n(5604),p=n(4106),m=n(575),v=[p.RemoteFunction.ping,m.RemoteEvent.pong],y=["ack"];class C{constructor(e,t,n){this.logger=f.LogManager.get().createLogger(0,"SIG2"),this.messageHandler=async(e,t)=>{try{const n=JSON.parse(e);if("msg"===n.type&&v.includes(n.payload.name)||y.includes(n.type)||this.logger.info(a.t("INFO_CONN_MESSAGE",t.uuid,e)),!n.type)return void this.logger.error(a.t("ERR_CONN_MESSAGE_FORMAT_TYPE","type"));switch(n.type){case"close":this.validateSeq(n.seq,t)&&await this.processClose(n);break;case"ack":await this.processAck(n);break;case"error":this.awaitingTransportHandler&&(this.destroyTransportSilent(this.awaitingTransportHandler.transport),this.awaitingTransportHandler.resolve(h.CONNECTION_CODE.SERVER_ERROR),this.awaitingTransportHandler=null);break;case"id":await this.setConnectionId(n),await this.sendData({type:"lastrx",seq:this.remoteClock});break;case"lastrx":await this.processLastRtx(n);break;case"msg":this.validateSeq(n.seq,t)&&await this.processMsg(n);break;default:this.logger.error(a.t("ERR_CONN_MESSAGE_FORMAT_TYPE","type"))}}catch(e){this.logger.error(a.t("ERR_CONN_MESSAGE_PARSING_ERR")),console.error(e)}},this.onTransportClose=async(e,t)=>{if(this.logger.info(a.t("INFO_CONN_TRANSPORT_CLOSED",e.uuid,t.reason,t.code.toString())),e.onClose=null,e.messageHandler=null,!this.transportList.has(e))return;const n=Array.from(this.transportList).some((e=>1===e.state||0===e.state));this.transportList.delete(e),n||(this.connectionId?(this.logger.info(a.t("INFO_CONN_RECONNECT_NEEDED")),2===this.state&&(this.setState(4),await this.reconnect()?this.setState(2):this.setState(5))):this.setState(3))},this.state=0,this.config={balancerUrl:"https://balancer.voximplant.com/getNearestHost",acdVersion:e,imVersion:t,servers:Array.from(n)}}validateSeq(e,t){return e===this.remoteClock+1||(this.logger.warning(a.t("INFO_CONN_BALANCER",e.toString(),this.remoteClock.toString(),t.uuid)),t.destroy(u.TransportCloseCodes.WRONG_SEQ,"Wrong seq"),!1)}async setConnectionId(e){this.logger.info(a.t("INFO_CONN_CONNECTION_ID_SET",e.id)),this.connectionId=e.id,this.awaitingTransportHandler&&(this.awaitingTransportHandler.resolve(h.CONNECTION_CODE.CONNECTED),this.awaitingTransportHandler=null)}async processAck(e){const t=Array.from(this.messagePool.keys()).sort()[0];this.logger.trace(a.t("TRACE_CONN_ACK_RECEIVED",e.seq.toString(),this.localClock.toString(),t.toString()));let n=0;for(let r=t;r<=e.seq;r++)this.messagePool.has(r)&&(this.messagePool.delete(r),n++);this.ackTimeout&&(clearTimeout(this.ackTimeout),this.ackTimeout=null),this.logger.trace(a.t("TRACE_CONN_ACK_CLEARED",n.toString()))}async processLastRtx(e){const t=this.localClock-e.seq;let n=0;for(let r=e.seq;r<=this.localClock;r++){const e=this.messagePool.get(r);e&&(await this.sendData(e),n++)}this.logger.trace(a.t("TRACE_CONN_RETRANSMIT",e.seq.toString(),this.localClock.toString(),t.toString(),n.toString()))}async processClose(e){await this.clearRoutine(!1)}async processMsg(e){this.remoteClock=e.seq,this.outerMessageHandler&&this.outerMessageHandler(e.payload),this.sendACK()}transformMsgPayload(e){if(e.payload.service){const t=e.payload;return Object.assign({name:"".concat(t.service,".").concat(t.event)},e.payload)}if(e.payload.name){const t=e.payload;return Object.assign({name:"GW.".concat(t.name)},c.hydratePayload(t.name,t.params))}return{name:"UnknownGWMessage",payload:e.payload}}sendACK(){this.sendData({type:"ack",seq:this.remoteClock}).catch((e=>{}))}async send(e){if(1!==this.state&&2!==this.state&&4!==this.state)return void this.logger.warning(a.t("WARN_CONN_WRONG_STATE","send message",g.Client.getInstance().getClientState().toString(),""+this.state));const t=++this.localClock,n={type:"msg",seq:t,payload:e};this.messagePool.set(t,n),this.ackTimeout||2!==this.state||(this.ackTimeout=setTimeout((()=>{this.transportList.forEach((e=>e.destroy(u.TransportCloseCodes.TIMEOUT))),clearTimeout(this.ackTimeout)}),6e3)),await this.sendData(n)}async sendData(e){var t,n;const r=this.transportList.values();try{for(var o,s=i(r);!(o=await s.next()).done;){const t=o.value;"msg"===e.type&&v.includes(e.payload.name)||y.includes(e.type)||this.logger.info(a.t("INFO_CONN_TO_MESSAGE",t.uuid,JSON.stringify(e))),await t.send(JSON.stringify(e))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&await n.call(s)}finally{if(t)throw t.error}}}async requestBalancer(){var e,t,r,i;let o="https://balancer.voximplant.com/getNearestHost";(null===(e=this.config)||void 0===e?void 0:e.balancerUrl)&&(0===(null===(t=this.config)||void 0===t?void 0:t.balancerUrl.indexOf("https://"))?o=null===(r=this.config)||void 0===r?void 0:r.balancerUrl:this.logger.warning(a.t("WARN_CONN_WRONG_BALANCER_URL",null===(i=this.config)||void 0===i?void 0:i.balancerUrl))),this.logger.info(a.t("INFO_CONN_BALANCER",o));try{const e=await n.g.fetch(o),t=await e.text();if(200!==e.status)throw new Error("Response code: ".concat(e.status));if(0===t.length)throw new Error("Response body is empty");return t.split(";")}catch(e){console.error(e),this.logger.error(a.t("ERR_CONN_WRONG_BALANCER_RESPONSE",e.message,o))}return[]}makeConnectionURL(e){var t,r;let i="nodejs";const a=n.g.navigator;return(null==a?void 0:a.mozGetUserMedia)?i="firefox":(null==a?void 0:a.webkitGetUserMedia)?i="chrome":a&&(i="safari"),"wss://".concat(e,"/platform?version=5&client_version=4.6.3-2641&video=true&ccheck=false&client_platform=").concat(i,"&im_version=").concat((null===(t=this.config)||void 0===t?void 0:t.imVersion)||2,"&acd_version=").concat((null===(r=this.config)||void 0===r?void 0:r.acdVersion)||1).concat(this.connectionId?"&id="+this.connectionId:"","&features=1")}async connect(){var e;if(this.logger.info(a.t("INFO_CONN_START_CONNECTION")),this.state>0)return void this.logger.warning(a.t("WARN_CONN_WRONG_STATE","connect",o.VIConnectionStateStrings[this.state],""+this.state));this.setState(1),this.localClock=0,this.remoteClock=0,this.messagePool=new Map,this.transportList=new Set;let t=null===(e=this.config)||void 0===e?void 0:e.servers;if(t&&t.length&&t[0]||(t=await this.requestBalancer()),0===t.length){const e=a.t("ERR_CONN_FAILED","No gateways to connect");throw this.logger.error(e),this.setState(3),new Error(e)}this.logger.info(a.t("INFO_CONN_CONNECTION_POOL",t.join(", "))),await this.firstConnection(t)?(this.setState(2),this.pingInterval&&clearInterval(this.pingInterval),this.pingInterval=setInterval((()=>this.doPing()),2e3)):(a.t("ERR_CONN_FAILED",a.t("ERR_CONN_CLOUD_IS_UNREACHABLE",t.join(", "))),this.setState(3))}doPing(){2===this.state&&this.send({name:"__ping"})}async reconnect(){this.logger.info(a.t("INFO_CONN_RECONNECT","1"));let e=await this.connectToServer(this.currentServer);if(console.error(e),e===h.CONNECTION_CODE.CONNECTED)return!0;const t=async()=>await this.connectToServer(this.currentServer),n=l.makePromiseTimeout(t,200),r=l.makePromiseTimeout(t,1e3),i=l.makePromiseTimeout(t,5e3),o=[n,n,r,r,r,i,i,i,i];for(let s=0;s<o.length;s++)if(e!==h.CONNECTION_CODE.CONNECTED)switch(this.logger.info(a.t("INFO_CONN_RECONNECT",(s+2).toString())),e=await o[s](this.currentServer),console.error(e),e){case h.CONNECTION_CODE.NOT_CONNECTED:this.logger.info(a.t("INFO_CONN_RECONNECT_ATTEMPT_FAILED",(s+2).toString()));break;case h.CONNECTION_CODE.SERVER_ERROR:return!1}return e===h.CONNECTION_CODE.CONNECTED}async firstConnection(e){for(const t of e)if(this.logger.info(a.t("INFO_CONN_CONNECT",t)),await this.connectToServer(t)===h.CONNECTION_CODE.CONNECTED)return this.logger.info(a.t("INFO_CONN_CONNECT_SUCCESSFUL",t)),this.currentServer=t,!0;return!1}async connectToServer(e){const t=this.makeConnectionURL(e),n=new s.Transport;return await n.connect(t)?(this.transportList.add(n),this.logger.info(a.t("INFO_CONN_TRANSPORT_CONNECTED",n.uuid)),n.messageHandler=this.messageHandler,n.onClose=this.onTransportClose,await new Promise((e=>{this.awaitingTransportHandler&&(this.destroyTransportSilent(this.awaitingTransportHandler.transport),this.awaitingTransportHandler.resolve(h.CONNECTION_CODE.NOT_CONNECTED)),this.awaitingTransportHandler={resolve:e,transport:n}}))):(n.destroy(u.TransportCloseCodes.NOT_CONNECTED),1)}async clear(){await this.clearRoutine(!0)}async clearRoutine(e){if(0===this.state||3===this.state||5===this.state)return void this.logger.warning(a.t("WARN_CONN_WRONG_STATE","disconnect",o.VIConnectionStateStrings[this.state],""+this.state));this.pingInterval&&clearInterval(this.pingInterval),this.logger.info(a.t("INFO_CONN_CLEAR")),this.setState(5);const t={type:"close",seq:this.localClock++};this.transportList.forEach((n=>{2===n.state&&e&&n.send(JSON.stringify(t)),this.destroyTransportSilent(n)}))}destroyTransportSilent(e){this.transportList.delete(e),e.onClose=null,e.messageHandler=null,e.destroy(u.TransportCloseCodes.CLIENT_ERROR,"Closing by connection"),this.logger.info(a.t("INFO_CONN_TRANSPORT_DESTROY",e.uuid))}setState(e){const t=this.state;this.state=e,this.outerStateHandler&&this.outerStateHandler(t,e)}}r([d.throttleDecorator(5e3)],C.prototype,"sendACK",null),t.Connection=C},5604:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CONNECTION_CODE=void 0,function(e){e[e.CONNECTED=0]="CONNECTED",e[e.NOT_CONNECTED=1]="NOT_CONNECTED",e[e.SERVER_ERROR=2]="SERVER_ERROR"}(n||(n={})),t.CONNECTION_CODE=n},1783:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VIConnectionStateStrings=t.VIConnectionState=void 0;const n={disconnected:0,connecting:1,connected:2,failed:3,reconnecting:4,closed:5};t.VIConnectionState=n;const r=Object.keys(n);t.VIConnectionStateStrings=r},2071:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dehydratePayload=t.hydratePayload=void 0;const n={loginFailed:["code","extra"],loginSuccessful:["displayName","params"],__onPCStats:["stats"],handleIncomingConnection:["id","headers","sdp","extra"],handleConnectionConnected:["id","headers","sdp","endpointData","scheme"],handleConnectionDisconnected:["id","headers","params"],handleRingOut:["id"],startEarlyMedia:["id","headers","sdp","scheme"],stopRinging:["id"],handleConnectionFailed:["id","code","reason","headers"],handleSIPInfo:["id","type","subType","body","headers"],handleSipEvent:["id"],handleTransferStarted:["id"],handleTransferComplete:["id"],handleTransferFailed:["id"],handleReInvite:["id","headers","sdp","scheme"],handleAcceptReinvite:["id","headers","sdp"],handleRejectReinvite:["id","headers","sdp"],__createPC:["id","sdp"],__destroyPC:["id"],__connectionSuccessful:["token"],__connectionFailed:[],__createConnection:["token"],__pong:[],increaseGain:[],handlePreFlightCheckResult:["a","b","c"],handleVoicemail:["event"],refreshOauthTokenFailed:["code"],refreshOauthTokenSuccessful:["oauth"],registerPushTokenResult:["result"],unregisterPushTokenResult:["result"],sipRegisterSuccessful:["id","sipUri"],sipRegisterFailed:["id","sipUri","status","reason"],onACDStatus:["id","status","uuid","description"],SQMessagingStatusUpdated:["id","status","uuid","description"],onSQStatusError:["id","uuid","code","description"],onICEConfig:["id","config"],onICEConfigFailed:["id"]},r={__ping:[],login:["username","password"],loginGenerateOneTimeKey:[],setOperatorACDStatus:[],getOperatorACDStatus:[],setOperatorMessagingStatus:[],getOperatorMessagingStatus:[],setDesiredVideoBandwidth:[],rejectCall:[],disconnectCall:[],sendDTMF:[],sendSIPInfo:[],hold:[],unhold:[],acceptCall:[],createCall:[],callConference:[],transferCall:[],__muteLocal:[],ReInvite:[],AcceptReInvite:[],RejectReInvite:[],__confirmPC:[],__addCandidate:[],loginUsingOneTimeKey:[],refreshOauthToken:[],promptFinished:[],registerPushToken:[],unregisterPushToken:[],pushFeedback:[]};t.hydratePayload=function(e,t){const r=n[e];if(!r)throw new Error("Rule unknown for ".concat(e));return t.reduce(((e,t,n)=>(e[r[n]]=t,e)),{})},t.dehydratePayload=function(e,t){const n=r[e];if(!n)throw new Error("Rule unknown for ".concat(e));return n.reduce(((e,n)=>{const r=t[n]||null;return e.push(r),e}),[])}},9367:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttleDecorator=void 0,t.throttleDecorator=function(){let e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;return(i,a,o)=>({value:function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var l;e||(e=Date.now()),n.g.clearTimeout(t),e&&Date.now()-e>=r?(null===(l=o.value)||void 0===l||l.apply(this,a),e=Date.now()):t=n.g.setTimeout((()=>{var t;Date.now()-e>=r&&(null===(t=o.value)||void 0===t||t.apply(this,a),e=Date.now())}),r-(Date.now()-e))}})}},5383:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Transport=void 0;const r=n(1666),i=n(2957);t.Transport=class{constructor(){this.state=0,this.uuid=i.Utils.generateUUID()}send(e){if(this.ws.readyState===WebSocket.CLOSED||this.ws.readyState===WebSocket.CLOSING)return this.state=4,this.parentOnClose("Client error",r.TransportCloseCodes.CLIENT_ERROR,!1),void this.ws.close(r.TransportCloseCodes.CLIENT_ERROR,"Client error");this.ws.send(e)}destroy(e,t){e!==r.TransportCloseCodes.NOT_CONNECTED?this.ws.close(e,t):this.state=4}async connect(e){return new Promise((t=>{this.state=1,this.ws=new WebSocket(e);const n=e=>{this.state=0,t(!1)};this.ws.addEventListener("open",(()=>{this.state=2,this.ws.removeEventListener("error",n),this.ws.addEventListener("message",(e=>{this.messageHandler&&this.messageHandler(e.data,this)})),this.ws.addEventListener("close",(e=>{let{reason:t,code:n,wasClean:r}=e;4!==this.state&&(this.state=4,this.parentOnClose(t,n,r))})),this.ws.addEventListener("error",(e=>{this.state=4,this.parentOnClose("Client error",r.TransportCloseCodes.CLIENT_ERROR,!1),this.ws.close(r.TransportCloseCodes.CLIENT_ERROR,"Client error")})),t(!0)})),this.ws.addEventListener("error",n)}))}parentOnClose(e,t,n){this.onClose&&this.onClose(this,{reason:e,code:t,wasClean:n})}}},1666:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransportCloseCodes=void 0,t.TransportCloseCodes={NOT_CONNECTED:-1,NORMAL:1e3,WRONG_SEQ:4001,SERVER_ERROR:4002,CLIENT_ERROR:4003,TIMEOUT:4004}},3658:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makePromiseTimeout=void 0,t.makePromiseTimeout=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return new Promise((n=>{setTimeout((async function(){const t=await e.apply(r);n(t)}),t)}))}}},4234:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.t=void 0;const n=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},{TEST_REPLACE:"This is a {1} {2} replace"}),{TRACE_CONN_ACK_RECEIVED:"ASK message: received ask {1}, local clock {2}, minimal stored clock {3}",TRACE_CONN_ACK_CLEARED:"ASK message: cleared {1} msg from the pool.",TRACE_CONN_RETRANSMIT:"LastRTX message: requested from {1} current {2} total requested {3} can be sent {4}"}),{INFO_CONN_START_CONNECTION:"Start connecting procedure",INFO_CONN_BALANCER:"Request balancer url {1}",INFO_CONN_TRANSPORT_CONNECTED:"Transport was connected uuid:{1}",INFO_CONN_TRANSPORT_CLOSED:"Transport was closed unexpectedly uuid:{1} reason:{2} code {3}",INFO_CONN_TRANSPORT_DESTROY:"Transport was successful closed uuid:{1}",INFO_CONN_CONNECTION_POOL:"Connecting to Voximplant gateways: {1}",INFO_CONN_CONNECT:"Trying to connect with {1}",INFO_CONN_CONNECT_SUCCESSFUL:"Connection with {1} was successful",INFO_CONN_RECONNECT_NEEDED:"Trying to restore connection",INFO_CONN_RECONNECT:"Attempt to reconnect #{1}",INFO_CONN_RECONNECT_ATTEMPT_FAILED:"Attempt #{1} failed. Timeout.",INFO_CONN_CLEAR:"Start disconnecting procedure.",INFO_CONN_MESSAGE:'New message from Transport uuid: {1}. "{2}"',INFO_CONN_TO_MESSAGE:'New message to Transport uuid: {1}. "{2}"',INFO_CONN_CONNECTION_ID_SET:"Set new connection id: {1}",INFO_TRANSPORT_CLOSED:"Transport {1} was closed with code {2} reason: {3}"}),{WARN_CORE_WRONG_EVENT:"{1} internal event is unhandled. Looks like you forgot to connect some module. If you can't solve this yourself, please contact our technical support at support@voximplant.com.",WARN_CONN_WRONG_BALANCER_URL:'The Balancer URL must be secure. "{1}" not starts with "https://"',WARN_CONN_WRONG_STATE:"You try to {1} in the wrong state {2}({3})",WARN_CONN_WRONG_SEQ:"Received seq={1}, last seq={2}. Transport {3} will terminated.",WARN_TRANSPORT_NO_HANDLER:"Transport {1} has no message handler. Message was dropped.",WARN_TRANSPORT_NO_CLOSE_HANDLER:"Transport {1} has no close handler."}),{ERR_LOADING_MODULE:"Error loading module: ",ERR_MODULE_CONSTRUCTOR:"The modules field must be array",ERR_CORE_HANDLER_THROW:'Some module throw error while handle the "{1}" event. Error message is "{2}"',ERR_CORE_PRE_HANDLER_THROW:'Some module throw error while pre handle the "{1}" event. Error message is "{2}"',ERR_CORE_POST_HANDLER_THROW:'Some module throw error while post handle the "{1}" event. Error message is "{2}"',ERR_STATE_IS_READONLY:"SDK.state is read only.",ERR_CONFIG_IS_READONLY:"SDK.config is read only.",ERR_AlREADY_CONNECTED:'SDK already connected. Please use "async SDK.disconnect()" at first place.',ERR_NOT_CONNECTED_YET:'SDK not connected yet. Please use "async SDK.connect()" at first place.',ERR_CONN_WRONG_BALANCER_RESPONSE:'Wrong balancer response. "{1}" from "{2}"',ERR_CONN_FAILED:"Connection failed. Reason: {1}",ERR_CONN_CLOUD_IS_UNREACHABLE:"Voximplant cloud is unreachable. List of servers {1}",ERR_CONN_MESSAGE_PARSING_ERR:"Error while parsing message from Transport",ERR_CONN_MESSAGE_FORMAT_TYPE:'Error in message from Transport: "{1}" field not set.',ERR_CONN_CONNECTION_ID_ALREADY_SET:"Connection id already set and can't be updated."}),{THROW_WRONG_ENVIRONMENT:"Wrong environment",THROW_WRONG_MODULES_CONSTRUCTOR:"Modules config must be an array or a function that returns array"});t.t=function(e){const t=n[e];for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return t?r(t,...a):e};const r=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.replace(/{(\d+)}/g,(function(e,t){return void 0!==n[t-1]?n[t-1]:e}))}},9007:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSimulcastProfile=void 0,t.getSimulcastProfile=function(e){return"b24"===e.profileName?function(e){let{trackType:t,layerCount:n,minTrackSize:r}=e;return"video"===t?{framerateParams:[25,2===n?25:15,1===n?25:2===n?15:25],bitrateParams:[r>=1080?24e5:18e5,8e5,3e5],scaleDownParams:[1,1,1===n?1:r/320]}:{framerateParams:[30,2===n?30:10,1===n?30:1],scaleDownParams:[1,1,1]}}(e):function(e){let{trackType:t,layerCount:n,minTrackSize:r}=e;return"video"===t?{bitrateParams:[r>=1080?24e5:18e5,5e5,1e5],scaleDownParams:[1,r/360,r/280],framerateParams:[30,30,15]}:{framerateParams:[30,2===n?30:10,1===n?30:1],scaleDownParams:[1,1,1]}}(e)}},4893:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCollectInterval=t.LOW_BATTERY_COLLECT_INTERVAL=t.DEFAULT_COLLECT_INTERVAL=t.MIN_COLLECT_INTERVAL=void 0;const r=n(308);t.MIN_COLLECT_INTERVAL=500,t.DEFAULT_COLLECT_INTERVAL=1e3,t.LOW_BATTERY_COLLECT_INTERVAL=1e4,t.getCollectInterval=async function(){const e=r.CallManager.get().rtcStatsCollectionInterval;try{if(navigator.getBattery)return(await navigator.getBattery()).level<=.3?Math.max(1e4,e):e}catch(e){}return e}},8552:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unregisterPeerConnection=t.registerSource=void 0;const r=n(4893),i=n(7141),a=n(2746),o=n(9258),s=n(171),l=n(5229),c=n(2182),d=n(1954),u=n(1150),g=n(308);let f=!1;const h=new Set,p=new WeakMap,m=new WeakMap;let v=!1,y=r.DEFAULT_COLLECT_INTERVAL,C=i.baseStatsStrategy;async function _(){r.getCollectInterval().then((e=>{y=e}));for(const t of h.values())if("connected"===t.connectionState){const n=await t.getStats(),r=(e=n,l.checkBlink(e,f)?s.blinkStatsStrategy:c.checkGecko(e,f)?a.geckoStatsStrategy:d.checkWebkit(e,f)?o.webkitStatsStrategy:i.baseStatsStrategy);r.name!==C.name&&(u.LogManager.get().writeMessage(u.LogCategory.RTC,"Stat2",u.LogLevel.INFO,"Stats strategy changed from ".concat(C.name," to ").concat(r.name)),C=r);const g=m.get(t),h=C.process(n,g);m.set(t,JSON.parse(JSON.stringify(h)));const v=p.get(t);v&&v(h)}var e;0!==h.size&&(v=!0,setTimeout(_,y))}function S(e){h.delete(e),u.LogManager.get().writeMessage(u.LogCategory.RTC,"Stat2",u.LogLevel.INFO,"Statics source was removed "),0===h.size&&(u.LogManager.get().writeMessage(u.LogCategory.RTC,"Stat2",u.LogLevel.INFO,"Statics interval was stopped"),v=!1)}t.unregisterPeerConnection=S,t.registerSource=function(e,t,n,r){u.LogManager.get().writeMessage(u.LogCategory.RTC,"Stat2",u.LogLevel.INFO,"Add a new statistic source"),n&&n.addEventListener("abort",(function(){u.LogManager.get().writeMessage(u.LogCategory.RTC,"Stat2",u.LogLevel.INFO,"Abort statistic source"),S(e)})),p.set(e,t),function(e){h.add(e),u.LogManager.get().writeMessage(u.LogCategory.RTC,"Stat2",u.LogLevel.INFO,"Statics source was added ");const t=g.CallManager.get().rtcStatsCollectionInterval;!v&&t>0&&(v=!0,setTimeout(_,y))}(e)}},6577:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShortStreamStats=void 0;const n=(e,t,n)=>Object.entries(e).filter((e=>{let[n,r]=e;return(Array.isArray(r)?r:[r]).find((e=>e.kind===t))})).reduce(((e,t)=>{const[r,i]=t;return r&&"undefined"!==r&&(e[r]=((e,t)=>(Array.isArray(e)?e:[e]).map((e=>Object.entries(e).reduce(((e,n)=>{const[r,i]=n;return t.includes(r)&&(e[r]=i),e}),{}))))(i,n)),e}),{});t.getShortStreamStats=e=>{const{outbound:t,inbound:r}=e,i=["packetsSent","packetsReceived","packetsLost","codec","bitrate","endpoint","rtt"],a=["packetsSent","packetsReceived","packetsLost","framesPerSecond","framesDropped","codec","bitrate","rid","width","height","rtt","endpoint"];return{timestamp:Date.now(),outbound:{audio:n(t,"audio",i),video:n(t,"video",a)},inbound:{audio:n(r,"audio",i),video:n(r,"video",a)}}}},6665:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerSource=void 0;const r=n(8552);Object.defineProperty(t,"registerSource",{enumerable:!0,get:function(){return r.registerSource}})},7141:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseStatsStrategy=void 0;t.baseStatsStrategy={process:function(e){return{connection:{timestamp:0,availableOutgoingBitrate:0,bytesReceived:0,bytesSent:0,rtt:0,localPort:0,localProtocol:"udp",localType:"relay",remotePort:0,remoteProtocol:"tcp",remoteType:"relay"},inbound:{},outbound:{}}},name:"rfc"}},171:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blinkStatsStrategy=void 0;const r=n(3236),i={process:function(e,t){const[n,i]=r.utils.formatStats(e),a={},o={};let s={};return n.forEach((e=>{var n,l;switch(e.type){case"outbound-rtp":{if(!e.mediaSourceId)break;const a=i.get(e.remoteId),s=i.get(e.codecId),c=i.get(e.mediaSourceId),d=c.trackIdentifier,u=e.rid?null===(n=null==t?void 0:t.outbound[d])||void 0===n?void 0:n.find((t=>t.rid===e.rid)):null===(l=null==t?void 0:t.outbound[d])||void 0===l?void 0:l[0];let g=0;u&&(g=r.utils.calculateBitrate(e.bytesSent,u.bytesSent,e.timestamp,u.timestamp));const f={bytesSent:e.bytesSent,packetsSent:e.packetsSent,rid:e.rid,jitter:0,rtt:0,totalRtt:0,packetsLost:0,loss:0,codec:s.mimeType,pt:s.payloadType,timestamp:e.timestamp,bitrate:g};switch(a&&(f.jitter=a.jitter,f.rtt=a.roundTripTime,f.totalRtt=a.totalRoundTripTime||a.roundTripTime,f.packetsLost=a.packetsLost,f.loss=a.packetsLost/(e.packetsSent+a.packetsLost)),e.kind){case"audio":{const e=c;f.kind="audio",f.audioLevel=e.audioLevel||0,f.totalAudioEnergy=e.totalAudioEnergy||0;break}case"video":{const t=c;f.kind="video",f.baseWidth=t.width,f.baseHeight=t.height,f.width=e.frameWidth||0,f.height=e.frameHeight||0,f.framesPerSecond=e.framesPerSecond||0,f.baseFramesPerSecond=t.framesPerSecond,f.qualityLimitationReason=e.qualityLimitationReason,f.qualityLimitationResolutionChanges=e.qualityLimitationResolutionChanges,f.firCount=e.firCount,f.pliCount=e.pliCount,f.nackCount=e.nackCount,f.qpSum=e.qpSum,f.framesEncoded=e.framesEncoded,f.keyFramesEncoded=e.keyFramesEncoded;break}}o[d]||(o[d]=[]),o[d].push(f);break}case"inbound-rtp":{const n=e.trackIdentifier,o=null==t?void 0:t.inbound[n],s=i.get(e.codecId);let l=0;switch(o&&(l=r.utils.calculateBitrate(e.bytesReceived,o.bytesReceived,e.timestamp,o.timestamp)),a[n]={timestamp:e.timestamp,kind:e.kind,bytesReceived:e.bytesReceived||0,packetsReceived:e.packetsReceived||0,packetsLost:e.packetsLost||0,loss:e.packetsLost/(e.packetsReceived+e.packetsLost),jitter:e.jitter||0,bitrate:l},(null==s?void 0:s.mimeType)&&(a[n].codec=null==s?void 0:s.mimeType),e.kind){case"audio":a[n]=Object.assign(Object.assign({},a[n]),{audioLevel:e.audioLevel||0,totalAudioEnergy:e.totalAudioEnergy||0,totalSamplesReceived:e.totalSamplesReceived||0,totalSamplesDuration:e.totalSamplesDuration||0,insertedSamplesForDeceleration:e.insertedSamplesForDeceleration||0,silentConcealedSamples:e.silentConcealedSamples||0});break;case"video":{let t=0;if(o&&o.framesReceived){const n=o.framesReceived||e.framesReceived;t=(e.framesReceived-n)/(e.timestamp-o.timestamp)*1e3|0}a[n]=Object.assign(Object.assign({},a[n]),{height:e.frameHeight||0,width:e.frameWidth||0,framesReceived:e.framesReceived||0,framesDecoded:e.framesDecoded||0,framesDropped:e.framesDropped||0,framesPerSecond:t});break}}break}case"candidate-pair":{if("succeeded"!==e.state||!e.nominated)return;const t=i.get(e.remoteCandidateId),n=i.get(e.localCandidateId);if(!t||!n)return;const r=t.candidateType,a=t.ip||t.address,o=t.protocol,l=t.port,c=n.candidateType,d=n.ip||n.address,u=n.protocol,g=n.port,f=e.totalRoundTripTime,h=e.currentRoundTripTime,{bytesSent:p,bytesReceived:m,availableOutgoingBitrate:v,timestamp:y}=e;s={timestamp:y,remoteType:r,remoteIp:a,remoteProtocol:o,remotePort:l,localType:c,localIp:d,localProtocol:u,localPort:g,bytesSent:p,bytesReceived:m,availableOutgoingBitrate:v,rtt:f,currentRtt:h};break}}})),{connection:s,outbound:o,inbound:a}},name:"blink"};t.blinkStatsStrategy=i},5229:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkBlink=void 0,t.checkBlink=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!0,r=!1;return e.forEach((e=>{if(n){switch(e.type){case"peer-connection":r=!0;break;case"media-source":n="audio"===(i=e).kind?void 0!==i.audioLevel&&void 0!==i.totalAudioEnergy&&void 0!==i.totalSamplesDuration:"video"===i.kind&&void 0!==i.width&&void 0!==i.height&&void 0!==i.framesPerSecond;break;case"local-candidate":case"remote-candidate":n=function(e){return void 0!==e.address&&void 0!==e.isRemote||void 0!==e.ip&&void 0!==e.isRemote}(e);break;case"transport":n=function(e){return void 0!==e.packetsSent&&void 0!==e.packetsReceived}(e);break;case"inbound-rtp":n=function(e){return"audio"===e.kind||"video"===e.kind}(e);break;case"outbound-rtp":n=function(e){return"audio"===e.kind||"video"===e.kind&&void 0!==e.qualityLimitationReason}(e);break;case"track":n=function(e){return void 0!==e.kind}(e)}t&&console.error("After "+e.type,n)}var i})),r||(n=!1),t&&console.error("Blink detection result is:",n),n}},2182:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkGecko=void 0,t.checkGecko=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!0;return e.forEach((e=>{if(n){switch(e.type){case"candidate-pair":n=void 0!==(r=e).lastPacketReceivedTimestamp&&void 0!==r.lastPacketSentTimestamp;break;case"inbound-rtp":n=function(e){return"video"!==e.kind||void 0!==e.discardedPackets&&void 0!==e.framesDecoded}(e)}t&&console.error("After "+e.type,n)}var r})),t&&console.error("Gecko detection result is:",n),n}},1954:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkWebkit=void 0,t.checkWebkit=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!0,r=!1;return e.forEach((e=>{if(n){switch(e.type){case"peer-connection":r=!0;break;case"track":n=function(e){if(e.framesReceived){const t=e;return void 0!==t.freezeCount&&void 0!==t.pauseCount&&void 0!==t.sumOfSquaredFramesDuration&&void 0!==t.totalFramesDuration&&void 0!==t.totalFreezesDuration&&void 0!==t.totalPausesDuration}return!0}(e)}t&&console.error("After "+e.type,n)}})),r||(n=!1),n}},2746:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.geckoStatsStrategy=void 0;const r=n(3236),i={process:function(e,t){const[n,i]=r.utils.formatStats(e),a={},o={};let s={};return n.forEach((e=>{var n,l;switch(e.type){case"outbound-rtp":{const a=e.ssrc,s=null===(n=null==t?void 0:t.outbound[a])||void 0===n?void 0:n[0],l=i.get(e.codecId);let c=0;s&&(c=r.utils.calculateBitrate(e.bytesSent,s.bytesSent,e.timestamp,s.timestamp));const d={kind:e.kind,bytesSent:e.bytesSent,packetsSent:e.packetsSent,timestamp:e.timestamp,bitrate:c};(null==l?void 0:l.mimeType)&&(d.codec=null==l?void 0:l.mimeType),"video"===e.kind&&(d.framesPerSecond=e.framesPerSecond,d.firCount=e.firCount,d.pliCount=e.pliCount,d.nackCount=e.nackCount),o[a]=[d];const u=i.get(e.remoteId);u&&(d.jitter=u.jitter,d.rtt=u.roundTripTime,d.totalRtt=u.totalRoundTripTime,d.packetsLost=u.packetsLost,d.loss=u.packetsLost/(e.packetsSent+u.packetsLost));break}case"inbound-rtp":{const n=e.trackIdentifier,o=null==t?void 0:t.inbound[n],s=i.get(e.codecId);let c=0;o&&(c=r.utils.calculateBitrate(e.bytesReceived,o.bytesReceived,e.timestamp,o.timestamp)),a[n]={timestamp:e.timestamp,kind:e.kind,bytesReceived:e.bytesReceived||0,packetsReceived:e.packetsReceived||0,packetsLost:e.packetsLost||0,loss:e.packetsLost/(e.packetsReceived+e.packetsLost),jitter:e.jitter||0,bitrate:c};const d=i.get(e.remoteId);d&&(a[n].rtt=d.roundTripTime,a[n].totalRtt=d.totalRoundTripTime),(null==s?void 0:s.mimeType)&&(a[n].codec=null==s?void 0:s.mimeType),"video"===e.kind&&(a[n]=Object.assign(Object.assign({},a[n]),{framesDecoded:e.framesDecoded||0,framesPerSecond:null!==(l=e.framesPerSecond)&&void 0!==l?l:0}));break}case"candidate-pair":{if("succeeded"!==e.state||!e.nominated)return;const t=i.get(e.remoteCandidateId),n=i.get(e.localCandidateId);if(!t||!n)return;const r=t.candidateType,a=t.ip||t.address,o=t.protocol,l=t.port,c=n.candidateType,d=n.ip||n.address,u=n.protocol,g=n.port,{bytesSent:f,bytesReceived:h,timestamp:p}=e;s={timestamp:p,remoteType:r,remoteIp:a,remoteProtocol:o,remotePort:l,localType:c,localIp:d,localProtocol:u,localPort:g,bytesSent:f,bytesReceived:h};break}}})),{connection:s,outbound:o,inbound:a}},name:"gecko"};t.geckoStatsStrategy=i},3236:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utils=void 0;const n={calculateBitrate:function(e,t,n,r){return(e-t)/(n-r)*8e3},formatStats:function(e){const t=e,n=new Map;return t.forEach((e=>n.set(e.id,e))),[t,n]}};t.utils=n},9258:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.webkitStatsStrategy=void 0;const r=n(3236),i={process:function(e,t){const[n,i]=r.utils.formatStats(e),a={},o={};let s={};return n.forEach((e=>{var n,l,c,d,u;switch(e.type){case"outbound-rtp":{const a=i.get(e.remoteId),s=i.get(e.codecId),d=i.get(e.trackId),u=null!==(n=null==d?void 0:d.trackIdentifier)&&void 0!==n?n:e.id;if(!u)return;const g=e.rid?null===(l=null==t?void 0:t.outbound[u])||void 0===l?void 0:l.find((t=>t.rid===e.rid)):null===(c=null==t?void 0:t.outbound[u])||void 0===c?void 0:c[0];let f=0;g&&(f=r.utils.calculateBitrate(e.bytesSent,g.bytesSent,e.timestamp,g.timestamp));const h={bytesSent:e.bytesSent,packetsSent:e.packetsSent,rid:e.rid,jitter:0,rtt:0,totalRtt:0,packetsLost:0,loss:0,codec:s.mimeType,pt:s.payloadType,timestamp:e.timestamp,bitrate:f};if(a){h.jitter=a.jitter,h.rtt=a.roundTripTime,h.packetsLost=a.packetsLost;const t=a.packetsLost||0;h.loss=t/(e.packetsSent+t)}switch(e.kind){case"audio":h.kind="audio";break;case"video":h.kind="video",h.width=e.frameWidth||0,h.height=e.frameHeight||0,h.framesPerSecond=e.framesPerSecond||0,h.qualityLimitationReason=e.qualityLimitationReason,h.qualityLimitationResolutionChanges=e.qualityLimitationResolutionChanges,h.firCount=e.firCount,h.pliCount=e.pliCount,h.nackCount=e.nackCount,h.qpSum=e.qpSum,h.framesEncoded=e.framesEncoded,h.keyFramesEncoded=e.keyFramesEncoded}o[u]||(o[u]=[]),o[u].push(h);break}case"inbound-rtp":{const n=e.trackId,o=i.get(n),s=null!==(u=null!==(d=null==o?void 0:o.trackIdentifier)&&void 0!==d?d:e.trackIdentifier)&&void 0!==u?u:e.id;if(!s)return;const l=null==t?void 0:t.inbound[s],c=i.get(e.codecId);let g=0;switch(l&&(g=r.utils.calculateBitrate(e.bytesReceived,l.bytesReceived,e.timestamp,l.timestamp)),a[s]={timestamp:e.timestamp,kind:e.kind,bytesReceived:e.bytesReceived||0,packetsReceived:e.packetsReceived||0,packetsLost:e.packetsLost||0,loss:e.packetsLost/(e.packetsReceived+e.packetsLost),jitter:0,bitrate:g},(null==c?void 0:c.mimeType)&&(a[s].codec=null==c?void 0:c.mimeType),e.kind){case"audio":a[s]=Object.assign(Object.assign({},a[s]),{jitter:e.jitter,totalAudioEnergy:e.totalAudioEnergy||0,totalSamplesReceived:e.totalSamplesReceived||0,totalSamplesDuration:e.totalSamplesDuration||0,insertedSamplesForDeceleration:e.insertedSamplesForDeceleration||0,silentConcealedSamples:e.silentConcealedSamples||0});break;case"video":{let t=0;if(l&&l.framesReceived){const n=l.framesReceived||e.framesReceived;t=(e.framesReceived-n)/(e.timestamp-l.timestamp)*1e3|0}a[s]=Object.assign(Object.assign({},a[s]),{height:e.frameHeight||0,width:e.frameWidth||0,framesReceived:e.framesReceived||0,framesDecoded:e.framesDecoded||0,framesPerSecond:t});break}}break}case"candidate-pair":{if("succeeded"!==e.state||!e.nominated)return;const t=i.get(e.remoteCandidateId),n=i.get(e.localCandidateId);if(!t||!n)return;const r=t.candidateType,a=t.protocol,o=t.port,l=n.candidateType,c=n.protocol,d=n.port,u=e.totalRoundTripTime,g=e.currentRoundTripTime,{bytesSent:f,bytesReceived:h,availableOutgoingBitrate:p,timestamp:m}=e;s={timestamp:m,remoteType:r,remoteProtocol:a,remotePort:o,localType:l,localProtocol:c,localPort:d,bytesSent:f,bytesReceived:h,availableOutgoingBitrate:p,rtt:u,currentRtt:g};break}}})),{connection:s,outbound:o,inbound:a}},name:"webkit"};t.webkitStatsStrategy=i},7998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OperatorACDStatuses=t.QueueTypes=void 0,function(e){e[e.ACD=1]="ACD",e[e.SmartQueue=2]="SmartQueue"}(t.QueueTypes||(t.QueueTypes={})),function(e){e[e.Banned="BANNED"]="Banned",e[e.Dialing="DIALING"]="Dialing",e[e.Offline="OFFLINE"]="Offline",e[e.Online="ONLINE"]="Online",e[e.Ready="READY"]="Ready",e[e.InService="IN_SERVICE"]="InService",e[e.AfterService="AFTER_SERVICE"]="AfterService",e[e.Timeout="TIMEOUT"]="Timeout",e[e.DND="DND"]="DND",e[e.CustomStatus_1="CUSTOM_1"]="CustomStatus_1",e[e.CustomStatus_2="CUSTOM_2"]="CustomStatus_2",e[e.CustomStatus_3="CUSTOM_3"]="CustomStatus_3",e[e.CustomStatus_4="CUSTOM_4"]="CustomStatus_4",e[e.CustomStatus_5="CUSTOM_5"]="CustomStatus_5",e[e.CustomStatus_6="CUSTOM_6"]="CustomStatus_6",e[e.CustomStatus_7="CUSTOM_7"]="CustomStatus_7",e[e.CustomStatus_8="CUSTOM_8"]="CustomStatus_8",e[e.CustomStatus_9="CUSTOM_9"]="CustomStatus_9",e[e.CustomStatus_10="CUSTOM_10"]="CustomStatus_10"}(t.OperatorACDStatuses||(t.OperatorACDStatuses={}))},3992:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queueDecorator=t.TaskMutex=void 0,t.TaskMutex=class{constructor(){this.queue=[],this.locked=!1}acquire(){return this.locked?new Promise((e=>this.queue.push(e))):(this.locked=!0,Promise.resolve())}release(){if(this.queue.length)return this.queue.shift()();this.locked=!1}use(e){return this.acquire().then((()=>Promise.resolve().then((()=>e.descriptor.value.apply(e.instance,e.args))).then((e=>(this.release(),e))).catch((e=>{throw this.release(),e}))))}},t.queueDecorator=function(){return(e,t,n)=>({value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.mutex.use({args:t,descriptor:n,instance:this})}})}},2957:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;const i=n(1150),a=n(125),o=n(3947),s=n(7272),l=n(6081),c=n(9007);class d{static cadScript(e){return e.split(";").map((function(e){if(0!==e.length){var t=e.match(/\([0-9\/\.,\*\+]*\)$/),n=e.substring(0,t.index),r=t.pop();if(t.length)throw new Error("cadence script should be of the form `%f(%f/%f[,%f/%f])`");if(n="*"===n?1/0:parseFloat(n),isNaN(n))throw new Error("cadence length should be of the form `%f`");return{duration:n,sections:r=r.slice(1,r.length-1).split(",").map((function(e){try{var t=e.split("/");if(t.length>3)throw new Error;return{on:(t=t.map((function(e,t){var n;if(2===t)return e.split("+").map((function(e){var t=parseInt(e,10);if(isNaN(t))throw new Error;return t-1}));if("*"==e&&(n=1/0),n=n||parseFloat(e),isNaN(n))throw new Error;return n})))[0],off:t[1],frequencies:t[2]}}catch(e){throw new Error("cadence segments should be of the form `%f/%f[%d[+%d]]`")}}))}}}))}static freqScript(e){return e.split(",").map((function(e){try{var t=e.split("@"),n=parseInt(t.shift()),r=parseFloat(t.shift());if(t.length)throw Error();return{frequency:n,decibels:r}}catch(e){throw new Error("freqScript pairs are expected to be of the form `%d@%f[,%d@%f]`")}}))}static toneScript(e){var t=e.split(";");return{frequencies:this.freqScript(t.shift()),cadences:this.cadScript(t.join(";"))}}static playToneScript(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0!==window.AudioContext||void 0!==window.webkitAudioContext){var n=s.default.AudioDeviceManager.get().getAudioContext();if(null===n)return;var r=this.toneScript(e),i=[],a=0,o=function(e){for(var t=0;t<n.sampleRate*e;t++)i.push(0)},l=function(e,t){for(var a=0;a<n.sampleRate*t;a++){for(var o=0,s=0;s<e.length;s++)o+=Math.pow(10,r.frequencies[e[s]].decibels/20)*Math.sin((i.length+a)*(3.14159265359/n.sampleRate)*r.frequencies[e[s]].frequency),a<10&&(o*=a/10),a>n.sampleRate*t-10&&(o*=(n.sampleRate*t-a)/10);i.push(o)}},c=function(e,t){if(t!=1/0)var n=t;else n=t=20;if(0!==e.off&&e.off!=1/0)for(;n>0;)l(e.frequencies,e.on),n-=e.on,o(e.off),n-=e.off,n=parseInt(String(10*n))/10;else l(e.frequencies,t)},d=function(e){e.duration!=1/0?a+=e.duration:a+=20;for(var t=0;t<e.sections.length;t++)c(e.sections[t],e.duration)};this.source=n.createBufferSource();for(var u=0;u<r.cadences.length;u++)r.cadences[u].duration==1/0&&(this.source.loop=!0),d(r.cadences[u]);this.source.connect(n.destination);for(var g=n.createBuffer(1,a*n.sampleRate,n.sampleRate),f=g.getChannelData(0),h=0;h<a*n.sampleRate;h++)f[h]=i[h];i=null,this.source.buffer=g,!0===t&&(this.source.loop=!0),this.source.start(0)}}static stopPlayback(){return void 0!==this.source&&null!==this.source&&(this.source.stop(0),this.source=null,!0)}static getServers(){return fetch("https://balancer.voximplant.com/getNearestHost").then((e=>e.text()))}static generateUUID(){let e=this._gri,t=this._ha;return t(e(32),8)+"-"+t(e(16),4)+"-"+t(16384|e(12),4)+"-"+t(32768|e(14),4)+"-"+t(e(48),12)}static _gri(e){return e<0?NaN:e<=30?0|Math.random()*(1<<e):e<=53?(0|Math.random()*(1<<30))+(0|Math.random()*(1<<e-30))*(1<<30):NaN}static _ha(e,t){let n=e.toString(16),r=t-n.length,i="0";for(;r>0;r>>>=1,i+=i)1&r&&(n=i+n);return n}static checkCA(){if(!a.Client.getInstance().connected())throw new Error(l.CallError.NOT_CONNECTED_TO_VOXIMPLANT.toString());if(!o.Authenticator.get().authorized())throw new Error(l.CallError.NOT_AUTHORIZED.toString())}static mixObjectToLeft(e,t){for(var n in e)void 0!==t[n]&&(e[n]=t[n]);return e}static strFormat(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.replace(/{(\d+)}/g,(function(e,t){return void 0!==n[t]?n[t]:e}))}_traceName(){return"Utils"}static buildSimulcastLayers(e){let{trackSettings:t,trackType:n,profileName:r}=e;t||(t={width:1920,height:1080});const i=t.width>t.height?t.height:t.width,a=d.getSimulcastLayerCount(i),o=c.getSimulcastProfile({profileName:r,trackType:n,layerCount:a,minTrackSize:i});return d.buildSimulcastBuilderByProfile(a,o)}static getSimulcastLayerCount(e){return e>=720?3:e>=480?2:1}static buildSimulcastBuilderByProfile(e,t){const n=["h","m","l"].slice(3-e),r=[];let i,a,o;t.bitrateParams&&(i=t.bitrateParams.slice(3-e),i[0]=t.bitrateParams[0]),t.scaleDownParams&&(a=t.scaleDownParams.slice(3-e),a[0]=t.scaleDownParams[0]),t.framerateParams&&(o=t.framerateParams.slice(3-e),o[0]=t.framerateParams[0]);for(let s=0;s<e;s++){const e={rid:n[s]};i&&(e.maxBitrate=i[s]),a&&(e.scaleResolutionDownBy=a[s]),o&&(e.maxFramerate=o[s]),r.push(e)}return r}static getDefaultStreamTransformer(){return window.RTCRtpSender&&RTCRtpSender.prototype.createEncodedStreams?new TransformStream({start(){},async transform(e,t){t.enqueue(e)},flush(){}}):void 0}static buildNotSimulcastLayers(e){let{trackSettings:t,trackType:n}=e;var r;t||(t={width:1920,height:1080});const i=null===(r=a.Client.getInstance().limitVCodecs)||void 0===r?void 0:r.filter((e=>"red"!==e.name&&"ulpfec"!==e.name)),o=!(null==i?void 0:i.filter((e=>!("H264"===e.name&&"42e01f"===e.params["profile-level-id"]))).length);let s=1;if("sharing"===n&&o){const e=t.height/720,n=t.width/1280;e>=n&&n>1&&(s=n),n<=e&&e>1&&(s=e)}const l=t.width>t.height?t.height:t.width;return[{maxBitrate:l>=1080?25e5:l>=720?15e5:5e5,maxFramerate:30,scaleResolutionDownBy:s}]}static stringifyError(e){const t=Object.getOwnPropertyNames(e);return t.length?JSON.stringify(e,t):JSON.stringify(e,["name","message"])}}d.source=null,d.floorTo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.floor(e/t)*t},r([i.LogManager.d_trace(i.LogCategory.UTILS)],d,"cadScript",null),r([i.LogManager.d_trace(i.LogCategory.UTILS)],d,"freqScript",null),r([i.LogManager.d_trace(i.LogCategory.UTILS)],d,"toneScript",null),r([i.LogManager.d_trace(i.LogCategory.UTILS)],d,"playToneScript",null),r([i.LogManager.d_trace(i.LogCategory.UTILS)],d,"stopPlayback",null),r([i.LogManager.d_trace(i.LogCategory.UTILS)],d,"getServers",null),t.Utils=d},9001:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.getMessenger=t.version=t.getInstance=t.MediaRenderDisablingReason=t.ClientState=t.LogLevel=t.LogCategory=t.QueueTypes=t.OperatorACDStatuses=t.EndpointEvents=t.Endpoint=t.CallEvents=t.Events=t.Messaging=void 0;const a=n(125),o=n(3947),s=n(6054);var l=n(6054);Object.defineProperty(t,"Messaging",{enumerable:!0,get:function(){return l.Messaging}});var c=n(141);Object.defineProperty(t,"Events",{enumerable:!0,get:function(){return c.Events}});var d=n(2282);Object.defineProperty(t,"CallEvents",{enumerable:!0,get:function(){return d.CallEvents}});var u=n(9144);Object.defineProperty(t,"Endpoint",{enumerable:!0,get:function(){return u.Endpoint}});var g=n(8597);Object.defineProperty(t,"EndpointEvents",{enumerable:!0,get:function(){return g.EndpointEvents}});var f=n(7998);Object.defineProperty(t,"OperatorACDStatuses",{enumerable:!0,get:function(){return f.OperatorACDStatuses}}),Object.defineProperty(t,"QueueTypes",{enumerable:!0,get:function(){return f.QueueTypes}});var h=n(1150);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return h.LogCategory}}),Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return h.LogLevel}}),Object.defineProperty(t,"ClientState",{enumerable:!0,get:function(){return h.ClientState}}),i(n(7272),t);var p=n(1450);Object.defineProperty(t,"MediaRenderDisablingReason",{enumerable:!0,get:function(){return p.MediaRenderDisablingReason}}),t.getInstance=function(){return a.Client.getInstance()},t.version=a.Client.getInstance().version,t.getMessenger=function(){if(!o.Authenticator.get().authorized())throw new Error("NOT_AUTHORIZED");return s.default.Messenger.getInstance()}},4758:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}return e.hashStr=function(e,t){return void 0===t&&(t=!1),this.onePassHasher.start().appendStr(e).end(t)},e.hashAsciiStr=function(e,t){return void 0===t&&(t=!1),this.onePassHasher.start().appendAsciiStr(e).end(t)},e._hex=function(t){var n,r,i,a,o=e.hexChars,s=e.hexOut;for(a=0;a<4;a+=1)for(r=8*a,n=t[a],i=0;i<8;i+=2)s[r+1+i]=o.charAt(15&n),n>>>=4,s[r+0+i]=o.charAt(15&n),n>>>=4;return s.join("")},e._md5cycle=function(e,t){var n=e[0],r=e[1],i=e[2],a=e[3];r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&i|~r&a)+t[0]-680876936|0)<<7|n>>>25)+r|0)&r|~n&i)+t[1]-389564586|0)<<12|a>>>20)+n|0)&n|~a&r)+t[2]+606105819|0)<<17|i>>>15)+a|0)&a|~i&n)+t[3]-1044525330|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&i|~r&a)+t[4]-176418897|0)<<7|n>>>25)+r|0)&r|~n&i)+t[5]+1200080426|0)<<12|a>>>20)+n|0)&n|~a&r)+t[6]-1473231341|0)<<17|i>>>15)+a|0)&a|~i&n)+t[7]-45705983|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&i|~r&a)+t[8]+1770035416|0)<<7|n>>>25)+r|0)&r|~n&i)+t[9]-1958414417|0)<<12|a>>>20)+n|0)&n|~a&r)+t[10]-42063|0)<<17|i>>>15)+a|0)&a|~i&n)+t[11]-1990404162|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&i|~r&a)+t[12]+1804603682|0)<<7|n>>>25)+r|0)&r|~n&i)+t[13]-40341101|0)<<12|a>>>20)+n|0)&n|~a&r)+t[14]-1502002290|0)<<17|i>>>15)+a|0)&a|~i&n)+t[15]+1236535329|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&a|i&~a)+t[1]-165796510|0)<<5|n>>>27)+r|0)&i|r&~i)+t[6]-1069501632|0)<<9|a>>>23)+n|0)&r|n&~r)+t[11]+643717713|0)<<14|i>>>18)+a|0)&n|a&~n)+t[0]-373897302|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&a|i&~a)+t[5]-701558691|0)<<5|n>>>27)+r|0)&i|r&~i)+t[10]+38016083|0)<<9|a>>>23)+n|0)&r|n&~r)+t[15]-660478335|0)<<14|i>>>18)+a|0)&n|a&~n)+t[4]-405537848|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&a|i&~a)+t[9]+568446438|0)<<5|n>>>27)+r|0)&i|r&~i)+t[14]-1019803690|0)<<9|a>>>23)+n|0)&r|n&~r)+t[3]-187363961|0)<<14|i>>>18)+a|0)&n|a&~n)+t[8]+1163531501|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&a|i&~a)+t[13]-1444681467|0)<<5|n>>>27)+r|0)&i|r&~i)+t[2]-51403784|0)<<9|a>>>23)+n|0)&r|n&~r)+t[7]+1735328473|0)<<14|i>>>18)+a|0)&n|a&~n)+t[12]-1926607734|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r^i^a)+t[5]-378558|0)<<4|n>>>28)+r|0)^r^i)+t[8]-2022574463|0)<<11|a>>>21)+n|0)^n^r)+t[11]+1839030562|0)<<16|i>>>16)+a|0)^a^n)+t[14]-35309556|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r^i^a)+t[1]-1530992060|0)<<4|n>>>28)+r|0)^r^i)+t[4]+1272893353|0)<<11|a>>>21)+n|0)^n^r)+t[7]-155497632|0)<<16|i>>>16)+a|0)^a^n)+t[10]-1094730640|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r^i^a)+t[13]+681279174|0)<<4|n>>>28)+r|0)^r^i)+t[0]-358537222|0)<<11|a>>>21)+n|0)^n^r)+t[3]-722521979|0)<<16|i>>>16)+a|0)^a^n)+t[6]+76029189|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r^i^a)+t[9]-640364487|0)<<4|n>>>28)+r|0)^r^i)+t[12]-421815835|0)<<11|a>>>21)+n|0)^n^r)+t[15]+530742520|0)<<16|i>>>16)+a|0)^a^n)+t[2]-995338651|0)<<23|r>>>9)+i|0,r=((r+=((a=((a+=(r^((n=((n+=(i^(r|~a))+t[0]-198630844|0)<<6|n>>>26)+r|0)|~i))+t[7]+1126891415|0)<<10|a>>>22)+n|0)^((i=((i+=(n^(a|~r))+t[14]-1416354905|0)<<15|i>>>17)+a|0)|~n))+t[5]-57434055|0)<<21|r>>>11)+i|0,r=((r+=((a=((a+=(r^((n=((n+=(i^(r|~a))+t[12]+1700485571|0)<<6|n>>>26)+r|0)|~i))+t[3]-1894986606|0)<<10|a>>>22)+n|0)^((i=((i+=(n^(a|~r))+t[10]-1051523|0)<<15|i>>>17)+a|0)|~n))+t[1]-2054922799|0)<<21|r>>>11)+i|0,r=((r+=((a=((a+=(r^((n=((n+=(i^(r|~a))+t[8]+1873313359|0)<<6|n>>>26)+r|0)|~i))+t[15]-30611744|0)<<10|a>>>22)+n|0)^((i=((i+=(n^(a|~r))+t[6]-1560198380|0)<<15|i>>>17)+a|0)|~n))+t[13]+1309151649|0)<<21|r>>>11)+i|0,r=((r+=((a=((a+=(r^((n=((n+=(i^(r|~a))+t[4]-145523070|0)<<6|n>>>26)+r|0)|~i))+t[11]-1120210379|0)<<10|a>>>22)+n|0)^((i=((i+=(n^(a|~r))+t[2]+718787259|0)<<15|i>>>17)+a|0)|~n))+t[9]-343485551|0)<<21|r>>>11)+i|0,e[0]=n+e[0]|0,e[1]=r+e[1]|0,e[2]=i+e[2]|0,e[3]=a+e[3]|0},e.prototype.start=function(){return this._dataLength=0,this._bufferLength=0,this._state.set(e.stateIdentity),this},e.prototype.appendStr=function(t){var n,r,i=this._buffer8,a=this._buffer32,o=this._bufferLength;for(r=0;r<t.length;r+=1){if((n=t.charCodeAt(r))<128)i[o++]=n;else if(n<2048)i[o++]=192+(n>>>6),i[o++]=63&n|128;else if(n<55296||n>56319)i[o++]=224+(n>>>12),i[o++]=n>>>6&63|128,i[o++]=63&n|128;else{if((n=1024*(n-55296)+(t.charCodeAt(++r)-56320)+65536)>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");i[o++]=240+(n>>>18),i[o++]=n>>>12&63|128,i[o++]=n>>>6&63|128,i[o++]=63&n|128}o>=64&&(this._dataLength+=64,e._md5cycle(this._state,a),o-=64,a[0]=a[16])}return this._bufferLength=o,this},e.prototype.appendAsciiStr=function(t){for(var n,r=this._buffer8,i=this._buffer32,a=this._bufferLength,o=0;;){for(n=Math.min(t.length-o,64-a);n--;)r[a++]=t.charCodeAt(o++);if(a<64)break;this._dataLength+=64,e._md5cycle(this._state,i),a=0}return this._bufferLength=a,this},e.prototype.appendByteArray=function(t){for(var n,r=this._buffer8,i=this._buffer32,a=this._bufferLength,o=0;;){for(n=Math.min(t.length-o,64-a);n--;)r[a++]=t[o++];if(a<64)break;this._dataLength+=64,e._md5cycle(this._state,i),a=0}return this._bufferLength=a,this},e.prototype.getState=function(){var e=this,t=e._state;return{buffer:String.fromCharCode.apply(null,e._buffer8),buflen:e._bufferLength,length:e._dataLength,state:[t[0],t[1],t[2],t[3]]}},e.prototype.setState=function(e){var t,n=e.buffer,r=e.state,i=this._state;for(this._dataLength=e.length,this._bufferLength=e.buflen,i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],t=0;t<n.length;t+=1)this._buffer8[t]=n.charCodeAt(t)},e.prototype.end=function(t){void 0===t&&(t=!1);var n,r=this._bufferLength,i=this._buffer8,a=this._buffer32,o=1+(r>>2);if(this._dataLength+=r,i[r]=128,i[r+1]=i[r+2]=i[r+3]=0,a.set(e.buffer32Identity.subarray(o),o),r>55&&(e._md5cycle(this._state,a),a.set(e.buffer32Identity)),(n=8*this._dataLength)<=4294967295)a[14]=n;else{var s=n.toString(16).match(/(.*?)(.{0,8})$/);if(null===s)return;var l=parseInt(s[2],16),c=parseInt(s[1],16)||0;a[14]=l,a[15]=c}return e._md5cycle(this._state,a),t?this._state:e._hex(this._state)},e.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),e.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.hexChars="0123456789abcdef",e.hexOut=[],e.onePassHasher=new e,e}();t.Md5=n,"5d41402abc4b2a76b9719d911017c592"!==n.hashStr("hello")&&console.error("Md5 self test failed.")}},t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}return n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n(9001)})(),t.default=t.VoxImplant=n,e.exports&&(t=e.exports=t.default)}).call(this)},418:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=o(e,a(n)))}return e}function a(e){if("string"===typeof e||"number"===typeof e)return e;if("object"!==typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=o(t,n));return t}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>o[e]=()=>r[e]));return o.default=()=>r,n.d(a,o),a}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=n(791),t=n.t(e,2),r=n(250),i=n(454),a=n(184);const o=(0,i.getInstance)(),s=e=>(async()=>{try{await o.init({localVideoContainerId:"localvideo",remoteVideoContainerId:"remotevideo"}),console.log("SDK is ready!");try{await o.connect(),console.log("Connected")}catch(e){console.log("Connection failed!")}}catch(e){console.log("SDK init failure!")}})().then((()=>o.login("test".concat(e?"1":"","@test.jock96.n8.voximplant.com"),"1772018p").then((()=>{console.log("Logged in!");const t={number:"myConf",simulcast:!0,video:{sendVideo:!0,receiveVideo:!0},H264first:!0};let n;return n=e?o.callConference(t):o.call(t),o.showLocalVideo(!0),n})).catch((()=>{console.log("Login failure!")})))),l=async()=>{const e=await s(!0);e&&e.answer()},c=()=>(0,a.jsxs)("div",{className:"App",children:[(0,a.jsx)("div",{id:"remotevideo"}),(0,a.jsx)("div",{id:"localvideo"}),(0,a.jsx)("button",{onClick:l,children:"join"}),(0,a.jsx)("button",{onClick:()=>s(),children:"call"})]});var d,u=n(164),g=n.t(u,2);function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(d||(d={}));const h="popstate";function p(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function m(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function v(e,t){return{usr:e.state,key:e.key,idx:t}}function y(e,t,n,r){return void 0===n&&(n=null),f({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?_(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function C(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function _(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function S(e,t,n,r){void 0===r&&(r={});let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,s=d.Pop,l=null,c=u();function u(){return(o.state||{idx:null}).idx}function g(){s=d.Pop;let e=u(),t=null==e?null:e-c;c=e,l&&l({action:s,location:_.location,delta:t})}function m(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,n="string"===typeof e?e:C(e);return p(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==c&&(c=0,o.replaceState(f({},o.state,{idx:c}),""));let _={get action(){return s},get location(){return e(i,o)},listen(e){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(h,g),l=e,()=>{i.removeEventListener(h,g),l=null}},createHref:e=>t(i,e),createURL:m,encodeLocation(e){let t=m(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){s=d.Push;let r=y(_.location,e,t);n&&n(r,e),c=u()+1;let g=v(r,c),f=_.createHref(r);try{o.pushState(g,"",f)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;i.location.assign(f)}a&&l&&l({action:s,location:_.location,delta:1})},replace:function(e,t){s=d.Replace;let r=y(_.location,e,t);n&&n(r,e),c=u();let i=v(r,c),g=_.createHref(r);o.replaceState(i,"",g),a&&l&&l({action:s,location:_.location,delta:0})},go:e=>o.go(e)};return _}var E;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(E||(E={}));const b=new Set(["lazy","caseSensitive","path","id","index","children"]);function M(e,t,n,r){return void 0===n&&(n=[]),void 0===r&&(r={}),e.map(((e,i)=>{let a=[...n,i],o="string"===typeof e.id?e.id:a.join("-");if(p(!0!==e.index||!e.children,"Cannot specify children on an index route"),p(!r[o],'Found a route id collision on id "'+o+"\".  Route id's must be globally unique within Data Router usages"),function(e){return!0===e.index}(e)){let n=f({},e,t(e),{id:o});return r[o]=n,n}{let n=f({},e,t(e),{id:o,children:void 0});return r[o]=n,e.children&&(n.children=M(e.children,t,a,r)),n}}))}function w(e,t,n){void 0===n&&(n="/");let r=V(("string"===typeof t?_(t):t).pathname||"/",n);if(null==r)return null;let i=R(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let a=null;for(let o=0;null==a&&o<i.length;++o)a=x(i[o],j(r));return a}function R(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,a)=>{let o={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(p(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));let s=q([r,o.relativePath]),l=n.concat(o);e.children&&e.children.length>0&&(p(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),R(e.children,t,l,s)),(null!=e.path||e.index)&&t.push({path:s,score:D(s,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of L(e.path))i(e,t,r);else i(e,t)})),t}function L(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(0===r.length)return i?[a,""]:[a];let o=L(r.join("/")),s=[];return s.push(...o.map((e=>""===e?a:[a,e].join("/")))),i&&s.push(...o),s.map((t=>e.startsWith("/")&&""===t?"/":t))}const T=/^:[\w-]+$/,I=3,P=2,O=1,A=10,N=-2,k=e=>"*"===e;function D(e,t){let n=e.split("/"),r=n.length;return n.some(k)&&(r+=N),t&&(r+=P),n.filter((e=>!k(e))).reduce(((e,t)=>e+(T.test(t)?I:""===t?O:A)),r)}function x(e,t){let{routesMeta:n}=e,r={},i="/",a=[];for(let o=0;o<n.length;++o){let e=n[o],s=o===n.length-1,l="/"===i?t:t.slice(i.length)||"/",c=F({path:e.relativePath,caseSensitive:e.caseSensitive,end:s},l);if(!c)return null;Object.assign(r,c.params);let d=e.route;a.push({params:r,pathname:q([i,c.pathname]),pathnameBase:W(q([i,c.pathnameBase])),route:d}),"/"!==c.pathnameBase&&(i=q([i,c.pathnameBase]))}return a}function F(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);m("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let a=new RegExp(i,t?void 0:"i");return[a,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce(((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=s[n]||"";o=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[n];return e[r]=i&&!l?void 0:function(e,t){try{return decodeURIComponent(e)}catch(n){return m(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+n+")."),e}}(l||"",r),e}),{}),pathname:a,pathnameBase:o,pattern:e}}function j(e){try{return decodeURI(e)}catch(t){return m(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function V(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function U(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function G(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function z(e,t){let n=G(e);return t?n.map(((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)):n.map((e=>e.pathnameBase))}function H(e,t,n,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=_(e):(i=f({},e),p(!i.pathname||!i.pathname.includes("?"),U("?","pathname","search",i)),p(!i.pathname||!i.pathname.includes("#"),U("#","pathname","hash",i)),p(!i.search||!i.search.includes("#"),U("#","search","hash",i)));let a,o=""===e||""===i.pathname,s=o?"/":i.pathname;if(null==s)a=n;else{let e=t.length-1;if(!r&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}a=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof e?_(e):e,a=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:a,search:B(r),hash:Q(i)}}(i,a),c=s&&"/"!==s&&s.endsWith("/"),d=(o||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!d||(l.pathname+="/"),l}const q=e=>e.join("/").replace(/\/\/+/g,"/"),W=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),B=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Q=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;class K{constructor(e,t,n,r){void 0===r&&(r=!1),this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function J(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const $=["post","put","patch","delete"],Y=new Set($),Z=["get",...$],X=new Set(Z),ee=new Set([301,302,303,307,308]),te=new Set([307,308]),ne={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},re={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},ie={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},ae=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,oe=e=>({hasErrorBoundary:Boolean(e.hasErrorBoundary)}),se="remix-router-transitions";function le(e){const t=e.window?e.window:"undefined"!==typeof window?window:void 0,n="undefined"!==typeof t&&"undefined"!==typeof t.document&&"undefined"!==typeof t.document.createElement,r=!n;let i;if(p(e.routes.length>0,"You must provide a non-empty routes array to createRouter"),e.mapRouteProperties)i=e.mapRouteProperties;else if(e.detectErrorBoundary){let t=e.detectErrorBoundary;i=e=>({hasErrorBoundary:t(e)})}else i=oe;let a,o,s={},l=M(e.routes,i,void 0,s),c=e.basename||"/",u=f({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1},e.future),g=null,h=new Set,v=null,C=null,_=null,S=null!=e.hydrationData,b=w(l,e.history.location,c),R=null;if(null==b){let t=we(404,{pathname:e.history.location.pathname}),{matches:n,route:r}=Me(l);b=n,R={[r.id]:t}}let L,T=b.some((e=>e.route.lazy)),I=b.some((e=>e.route.loader));if(T)o=!1;else if(I)if(u.v7_partialHydration){let t=e.hydrationData?e.hydrationData.loaderData:null,n=e.hydrationData?e.hydrationData.errors:null;o=b.every((e=>e.route.loader&&!0!==e.route.loader.hydrate&&(t&&void 0!==t[e.route.id]||n&&void 0!==n[e.route.id])))}else o=null!=e.hydrationData;else o=!0;let P,O={historyAction:e.history.action,location:e.history.location,matches:b,initialized:o,navigation:ne,restoreScrollPosition:null==e.hydrationData&&null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||R,fetchers:new Map,blockers:new Map},A=d.Pop,N=!1,k=!1,D=new Map,x=null,F=!1,j=!1,U=[],G=[],z=new Map,H=0,q=-1,W=new Map,B=new Set,Q=new Map,K=new Map,J=new Set,$=new Map,Y=new Map,Z=!1;function X(e,t){void 0===t&&(t={}),O=f({},O,e);let n=[],r=[];u.v7_fetcherPersist&&O.fetchers.forEach(((e,t)=>{"idle"===e.state&&(J.has(t)?r.push(t):n.push(t))})),[...h].forEach((e=>e(O,{deletedFetchers:r,unstable_viewTransitionOpts:t.viewTransitionOpts,unstable_flushSync:!0===t.flushSync}))),u.v7_fetcherPersist&&(n.forEach((e=>O.fetchers.delete(e))),r.forEach((e=>_e(e))))}function ee(t,n,r){var i,o;let s,{flushSync:c}=void 0===r?{}:r,u=null!=O.actionData&&null!=O.navigation.formMethod&&Ne(O.navigation.formMethod)&&"loading"===O.navigation.state&&!0!==(null==(i=t.state)?void 0:i._isRedirect);s=n.actionData?Object.keys(n.actionData).length>0?n.actionData:null:u?O.actionData:null;let g=n.loaderData?Ee(O.loaderData,n.loaderData,n.matches||[],n.errors):O.loaderData,h=O.blockers;h.size>0&&(h=new Map(h),h.forEach(((e,t)=>h.set(t,ie))));let p,m=!0===N||null!=O.navigation.formMethod&&Ne(O.navigation.formMethod)&&!0!==(null==(o=t.state)?void 0:o._isRedirect);if(a&&(l=a,a=void 0),F||A===d.Pop||(A===d.Push?e.history.push(t,t.state):A===d.Replace&&e.history.replace(t,t.state)),A===d.Pop){let e=D.get(O.location.pathname);e&&e.has(t.pathname)?p={currentLocation:O.location,nextLocation:t}:D.has(t.pathname)&&(p={currentLocation:t,nextLocation:O.location})}else if(k){let e=D.get(O.location.pathname);e?e.add(t.pathname):(e=new Set([t.pathname]),D.set(O.location.pathname,e)),p={currentLocation:O.location,nextLocation:t}}X(f({},n,{actionData:s,loaderData:g,historyAction:A,location:t,initialized:!0,navigation:ne,revalidation:"idle",restoreScrollPosition:Qe(t,n.matches||O.matches),preventScrollReset:m,blockers:h}),{viewTransitionOpts:p,flushSync:!0===c}),A=d.Pop,N=!1,k=!1,F=!1,j=!1,U=[],G=[]}async function le(t,n,r){P&&P.abort(),P=null,A=t,F=!0===(r&&r.startUninterruptedRevalidation),function(e,t){if(v&&_){let n=Be(e,t);v[n]=_()}}(O.location,O.matches),N=!0===(r&&r.preventScrollReset),k=!0===(r&&r.enableViewTransition);let o=a||l,g=r&&r.overrideNavigation,h=w(o,n,c),p=!0===(r&&r.flushSync);if(!h){let e=we(404,{pathname:n.pathname}),{matches:t,route:r}=Me(o);return We(),void ee(n,{matches:t,loaderData:{},errors:{[r.id]:e}},{flushSync:p})}if(O.initialized&&!j&&function(e,t){if(e.pathname!==t.pathname||e.search!==t.search)return!1;if(""===e.hash)return""!==t.hash;if(e.hash===t.hash)return!0;if(""!==t.hash)return!0;return!1}(O.location,n)&&!(r&&r.submission&&Ne(r.submission.formMethod)))return void ee(n,{matches:h},{flushSync:p});P=new AbortController;let m,y,C=ve(e.history,n,P.signal,r&&r.submission);if(r&&r.pendingError)y={[be(h).route.id]:r.pendingError};else if(r&&r.submission&&Ne(r.submission.formMethod)){let e=await async function(e,t,n,r,a){void 0===a&&(a={});he();let o,l=function(e,t){let n={state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text};return n}(t,n);X({navigation:l},{flushSync:!0===a.flushSync});let g=Fe(r,t);if(g.route.action||g.route.lazy){if(o=await me("action",e,g,r,s,i,c,u.v7_relativeSplatPath),e.signal.aborted)return{shortCircuited:!0}}else o={type:E.error,error:we(405,{method:e.method,pathname:t.pathname,routeId:g.route.id})};if(Pe(o)){let e;return e=a&&null!=a.replace?a.replace:o.location===O.location.pathname+O.location.search,await ue(O,o,{submission:n,replace:e}),{shortCircuited:!0}}if(Ie(o)){let e=be(r,g.route.id);return!0!==(a&&a.replace)&&(A=d.Push),{pendingActionData:{},pendingActionError:{[e.route.id]:o.error}}}if(Te(o))throw we(400,{type:"defer-action"});return{pendingActionData:{[g.route.id]:o.data}}}(C,n,r.submission,h,{replace:r.replace,flushSync:p});if(e.shortCircuited)return;m=e.pendingActionData,y=e.pendingActionError,g=Ve(n,r.submission),p=!1,C=new Request(C.url,{signal:C.signal})}let{shortCircuited:S,loaderData:b,errors:M}=await async function(t,n,r,i,o,s,d,g,h,p,m){let v=i||Ve(n,o),y=o||s||je(v),C=a||l,[_,S]=ge(e.history,O,r,y,n,u.v7_partialHydration&&!0===g,j,U,G,J,Q,B,C,c,p,m);if(We((e=>!(r&&r.some((t=>t.route.id===e)))||_&&_.some((t=>t.route.id===e)))),q=++H,0===_.length&&0===S.length){let e=Ae();return ee(n,f({matches:r,loaderData:{},errors:m||null},p?{actionData:p}:{},e?{fetchers:new Map(O.fetchers)}:{}),{flushSync:h}),{shortCircuited:!0}}if(!F&&(!u.v7_partialHydration||!g)){S.forEach((e=>{let t=O.fetchers.get(e.key),n=Ue(void 0,t?t.data:void 0);O.fetchers.set(e.key,n)}));let e=p||O.actionData;X(f({navigation:v},e?0===Object.keys(e).length?{actionData:null}:{actionData:e}:{},S.length>0?{fetchers:new Map(O.fetchers)}:{}),{flushSync:h})}S.forEach((e=>{z.has(e.key)&&Le(e.key),e.controller&&z.set(e.key,e.controller)}));let E=()=>S.forEach((e=>Le(e.key)));P&&P.signal.addEventListener("abort",E);let{results:b,loaderResults:M,fetcherResults:w}=await fe(O.matches,r,_,S,t);if(t.signal.aborted)return{shortCircuited:!0};P&&P.signal.removeEventListener("abort",E);S.forEach((e=>z.delete(e.key)));let R=Re(b);if(R){if(R.idx>=_.length){let e=S[R.idx-_.length].key;B.add(e)}return await ue(O,R.result,{replace:d}),{shortCircuited:!0}}let{loaderData:L,errors:T}=Se(O,r,_,M,m,S,w,$);$.forEach(((e,t)=>{e.subscribe((n=>{(n||e.done)&&$.delete(t)}))}));let I=Ae(),A=xe(q),N=I||A||S.length>0;return f({loaderData:L,errors:T},N?{fetchers:new Map(O.fetchers)}:{})}(C,n,h,g,r&&r.submission,r&&r.fetcherSubmission,r&&r.replace,r&&!0===r.initialHydration,p,m,y);S||(P=null,ee(n,f({matches:h},m?{actionData:m}:{},{loaderData:b,errors:M})))}async function ue(r,i,a){let{submission:o,fetcherSubmission:s,replace:l}=void 0===a?{}:a;i.revalidate&&(j=!0);let u=y(r.location,i.location,{_isRedirect:!0});if(p(u,"Expected a location on the redirect navigation"),n){let n=!1;if(i.reloadDocument)n=!0;else if(ae.test(i.location)){const r=e.history.createURL(i.location);n=r.origin!==t.location.origin||null==V(r.pathname,c)}if(n)return void(l?t.location.replace(i.location):t.location.assign(i.location))}P=null;let g=!0===l?d.Replace:d.Push,{formMethod:h,formAction:m,formEncType:v}=r.navigation;!o&&!s&&h&&m&&v&&(o=je(r.navigation));let C=o||s;if(te.has(i.status)&&C&&Ne(C.formMethod))await le(g,u,{submission:f({},C,{formAction:i.location}),preventScrollReset:N});else{let e=Ve(u,o);await le(g,u,{overrideNavigation:e,fetcherSubmission:s,preventScrollReset:N})}}async function fe(t,n,r,a,o){let l=await Promise.all([...r.map((e=>me("loader",o,e,n,s,i,c,u.v7_relativeSplatPath))),...a.map((t=>{if(t.matches&&t.match&&t.controller)return me("loader",ve(e.history,t.path,t.controller.signal),t.match,t.matches,s,i,c,u.v7_relativeSplatPath);return{type:E.error,error:we(404,{pathname:t.path})}}))]),d=l.slice(0,r.length),g=l.slice(r.length);return await Promise.all([ke(t,r,d,d.map((()=>o.signal)),!1,O.loaderData),ke(t,a.map((e=>e.match)),g,a.map((e=>e.controller?e.controller.signal:null)),!0)]),{results:l,loaderResults:d,fetcherResults:g}}function he(){j=!0,U.push(...We()),Q.forEach(((e,t)=>{z.has(t)&&(G.push(t),Le(t))}))}function pe(e,t,n){void 0===n&&(n={}),O.fetchers.set(e,t),X({fetchers:new Map(O.fetchers)},{flushSync:!0===(n&&n.flushSync)})}function ye(e,t,n,r){void 0===r&&(r={});let i=be(O.matches,t);_e(e),X({errors:{[i.route.id]:n},fetchers:new Map(O.fetchers)},{flushSync:!0===(r&&r.flushSync)})}function Ce(e){return u.v7_fetcherPersist&&(K.set(e,(K.get(e)||0)+1),J.has(e)&&J.delete(e)),O.fetchers.get(e)||re}function _e(e){let t=O.fetchers.get(e);!z.has(e)||t&&"loading"===t.state&&W.has(e)||Le(e),Q.delete(e),W.delete(e),B.delete(e),J.delete(e),O.fetchers.delete(e)}function Le(e){let t=z.get(e);p(t,"Expected fetch controller: "+e),t.abort(),z.delete(e)}function Oe(e){for(let t of e){let e=Ge(Ce(t).data);O.fetchers.set(t,e)}}function Ae(){let e=[],t=!1;for(let n of B){let r=O.fetchers.get(n);p(r,"Expected fetcher: "+n),"loading"===r.state&&(B.delete(n),e.push(n),t=!0)}return Oe(e),t}function xe(e){let t=[];for(let[n,r]of W)if(r<e){let e=O.fetchers.get(n);p(e,"Expected fetcher: "+n),"loading"===e.state&&(Le(n),W.delete(n),t.push(n))}return Oe(t),t.length>0}function ze(e){O.blockers.delete(e),Y.delete(e)}function He(e,t){let n=O.blockers.get(e)||ie;p("unblocked"===n.state&&"blocked"===t.state||"blocked"===n.state&&"blocked"===t.state||"blocked"===n.state&&"proceeding"===t.state||"blocked"===n.state&&"unblocked"===t.state||"proceeding"===n.state&&"unblocked"===t.state,"Invalid blocker state transition: "+n.state+" -> "+t.state);let r=new Map(O.blockers);r.set(e,t),X({blockers:r})}function qe(e){let{currentLocation:t,nextLocation:n,historyAction:r}=e;if(0===Y.size)return;Y.size>1&&m(!1,"A router only supports one blocker at a time");let i=Array.from(Y.entries()),[a,o]=i[i.length-1],s=O.blockers.get(a);return s&&"proceeding"===s.state?void 0:o({currentLocation:t,nextLocation:n,historyAction:r})?a:void 0}function We(e){let t=[];return $.forEach(((n,r)=>{e&&!e(r)||(n.cancel(),t.push(r),$.delete(r))})),t}function Be(e,t){if(C){return C(e,t.map((e=>function(e,t){let{route:n,pathname:r,params:i}=e;return{id:n.id,pathname:r,params:i,data:t[n.id],handle:n.handle}}(e,O.loaderData))))||e.key}return e.key}function Qe(e,t){if(v){let n=Be(e,t),r=v[n];if("number"===typeof r)return r}return null}return L={get basename(){return c},get future(){return u},get state(){return O},get routes(){return l},get window(){return t},initialize:function(){if(g=e.history.listen((t=>{let{action:n,location:r,delta:i}=t;if(Z)return void(Z=!1);m(0===Y.size||null!=i,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let a=qe({currentLocation:O.location,nextLocation:r,historyAction:n});return a&&null!=i?(Z=!0,e.history.go(-1*i),void He(a,{state:"blocked",location:r,proceed(){He(a,{state:"proceeding",proceed:void 0,reset:void 0,location:r}),e.history.go(i)},reset(){let e=new Map(O.blockers);e.set(a,ie),X({blockers:e})}})):le(n,r)})),n){!function(e,t){try{let n=e.sessionStorage.getItem(se);if(n){let e=JSON.parse(n);for(let[n,r]of Object.entries(e||{}))r&&Array.isArray(r)&&t.set(n,new Set(r||[]))}}catch(n){}}(t,D);let e=()=>function(e,t){if(t.size>0){let r={};for(let[e,n]of t)r[e]=[...n];try{e.sessionStorage.setItem(se,JSON.stringify(r))}catch(n){m(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}(t,D);t.addEventListener("pagehide",e),x=()=>t.removeEventListener("pagehide",e)}return O.initialized||le(d.Pop,O.location,{initialHydration:!0}),L},subscribe:function(e){return h.add(e),()=>h.delete(e)},enableScrollRestoration:function(e,t,n){if(v=e,_=t,C=n||null,!S&&O.navigation===ne){S=!0;let e=Qe(O.location,O.matches);null!=e&&X({restoreScrollPosition:e})}return()=>{v=null,_=null,C=null}},navigate:async function t(n,r){if("number"===typeof n)return void e.history.go(n);let i=ce(O.location,O.matches,c,u.v7_prependBasename,n,u.v7_relativeSplatPath,null==r?void 0:r.fromRouteId,null==r?void 0:r.relative),{path:a,submission:o,error:s}=de(u.v7_normalizeFormMethod,!1,i,r),l=O.location,g=y(O.location,a,r&&r.state);g=f({},g,e.history.encodeLocation(g));let h=r&&null!=r.replace?r.replace:void 0,p=d.Push;!0===h?p=d.Replace:!1===h||null!=o&&Ne(o.formMethod)&&o.formAction===O.location.pathname+O.location.search&&(p=d.Replace);let m=r&&"preventScrollReset"in r?!0===r.preventScrollReset:void 0,v=!0===(r&&r.unstable_flushSync),C=qe({currentLocation:l,nextLocation:g,historyAction:p});if(!C)return await le(p,g,{submission:o,pendingError:s,preventScrollReset:m,replace:r&&r.replace,enableViewTransition:r&&r.unstable_viewTransition,flushSync:v});He(C,{state:"blocked",location:g,proceed(){He(C,{state:"proceeding",proceed:void 0,reset:void 0,location:g}),t(n,r)},reset(){let e=new Map(O.blockers);e.set(C,ie),X({blockers:e})}})},fetch:function(t,n,o,d){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");z.has(t)&&Le(t);let g=!0===(d&&d.unstable_flushSync),f=a||l,h=ce(O.location,O.matches,c,u.v7_prependBasename,o,u.v7_relativeSplatPath,n,null==d?void 0:d.relative),m=w(f,h,c);if(!m)return void ye(t,n,we(404,{pathname:h}),{flushSync:g});let{path:v,submission:y,error:C}=de(u.v7_normalizeFormMethod,!0,h,d);if(C)return void ye(t,n,C,{flushSync:g});let _=Fe(m,v);N=!0===(d&&d.preventScrollReset),y&&Ne(y.formMethod)?async function(t,n,r,o,d,g,f){if(he(),Q.delete(t),!o.route.action&&!o.route.lazy){let e=we(405,{method:f.formMethod,pathname:r,routeId:n});return void ye(t,n,e,{flushSync:g})}let h=O.fetchers.get(t);pe(t,function(e,t){let n={state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0};return n}(f,h),{flushSync:g});let m=new AbortController,v=ve(e.history,r,m.signal,f);z.set(t,m);let y=H,C=await me("action",v,o,d,s,i,c,u.v7_relativeSplatPath);if(v.signal.aborted)return void(z.get(t)===m&&z.delete(t));if(u.v7_fetcherPersist&&J.has(t)){if(Pe(C)||Ie(C))return void pe(t,Ge(void 0))}else{if(Pe(C))return z.delete(t),q>y?void pe(t,Ge(void 0)):(B.add(t),pe(t,Ue(f)),ue(O,C,{fetcherSubmission:f}));if(Ie(C))return void ye(t,n,C.error)}if(Te(C))throw we(400,{type:"defer-action"});let _=O.navigation.location||O.location,S=ve(e.history,_,m.signal),E=a||l,b="idle"!==O.navigation.state?w(E,O.navigation.location,c):O.matches;p(b,"Didn't find any matches after fetcher action");let M=++H;W.set(t,M);let R=Ue(f,C.data);O.fetchers.set(t,R);let[L,T]=ge(e.history,O,b,f,_,!1,j,U,G,J,Q,B,E,c,{[o.route.id]:C.data},void 0);T.filter((e=>e.key!==t)).forEach((e=>{let t=e.key,n=O.fetchers.get(t),r=Ue(void 0,n?n.data:void 0);O.fetchers.set(t,r),z.has(t)&&Le(t),e.controller&&z.set(t,e.controller)})),X({fetchers:new Map(O.fetchers)});let I=()=>T.forEach((e=>Le(e.key)));m.signal.addEventListener("abort",I);let{results:N,loaderResults:k,fetcherResults:D}=await fe(O.matches,b,L,T,S);if(m.signal.aborted)return;m.signal.removeEventListener("abort",I),W.delete(t),z.delete(t),T.forEach((e=>z.delete(e.key)));let x=Re(N);if(x){if(x.idx>=L.length){let e=T[x.idx-L.length].key;B.add(e)}return ue(O,x.result)}let{loaderData:F,errors:V}=Se(O,O.matches,L,k,void 0,T,D,$);if(O.fetchers.has(t)){let e=Ge(C.data);O.fetchers.set(t,e)}xe(M),"loading"===O.navigation.state&&M>q?(p(A,"Expected pending action"),P&&P.abort(),ee(O.navigation.location,{matches:b,loaderData:F,errors:V,fetchers:new Map(O.fetchers)})):(X({errors:V,loaderData:Ee(O.loaderData,F,b,V),fetchers:new Map(O.fetchers)}),j=!1)}(t,n,v,_,m,g,y):(Q.set(t,{routeId:n,path:v}),async function(t,n,r,a,o,l,d){let g=O.fetchers.get(t);pe(t,Ue(d,g?g.data:void 0),{flushSync:l});let f=new AbortController,h=ve(e.history,r,f.signal);z.set(t,f);let m=H,v=await me("loader",h,a,o,s,i,c,u.v7_relativeSplatPath);Te(v)&&(v=await De(v,h.signal,!0)||v);z.get(t)===f&&z.delete(t);if(h.signal.aborted)return;if(J.has(t))return void pe(t,Ge(void 0));if(Pe(v))return q>m?void pe(t,Ge(void 0)):(B.add(t),void await ue(O,v));if(Ie(v))return void ye(t,n,v.error);p(!Te(v),"Unhandled fetcher deferred data"),pe(t,Ge(v.data))}(t,n,v,_,m,g,y))},revalidate:function(){he(),X({revalidation:"loading"}),"submitting"!==O.navigation.state&&("idle"!==O.navigation.state?le(A||O.historyAction,O.navigation.location,{overrideNavigation:O.navigation}):le(O.historyAction,O.location,{startUninterruptedRevalidation:!0}))},createHref:t=>e.history.createHref(t),encodeLocation:t=>e.history.encodeLocation(t),getFetcher:Ce,deleteFetcher:function(e){if(u.v7_fetcherPersist){let t=(K.get(e)||0)-1;t<=0?(K.delete(e),J.add(e)):K.set(e,t)}else _e(e);X({fetchers:new Map(O.fetchers)})},dispose:function(){g&&g(),x&&x(),h.clear(),P&&P.abort(),O.fetchers.forEach(((e,t)=>_e(t))),O.blockers.forEach(((e,t)=>ze(t)))},getBlocker:function(e,t){let n=O.blockers.get(e)||ie;return Y.get(e)!==t&&Y.set(e,t),n},deleteBlocker:ze,_internalFetchControllers:z,_internalActiveDeferreds:$,_internalSetRoutes:function(e){s={},a=M(e,i,void 0,s)}},L}Symbol("deferred");function ce(e,t,n,r,i,a,o,s){let l,c;if(o){l=[];for(let e of t)if(l.push(e),e.route.id===o){c=e;break}}else l=t,c=t[t.length-1];let d=H(i||".",z(l,a),V(e.pathname,n)||e.pathname,"path"===s);return null==i&&(d.search=e.search,d.hash=e.hash),null!=i&&""!==i&&"."!==i||!c||!c.route.index||xe(d.search)||(d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index"),r&&"/"!==n&&(d.pathname="/"===d.pathname?n:q([n,d.pathname])),C(d)}function de(e,t,n,r){if(!r||!function(e){return null!=e&&("formData"in e&&null!=e.formData||"body"in e&&void 0!==e.body)}(r))return{path:n};if(r.formMethod&&!Ae(r.formMethod))return{path:n,error:we(405,{method:r.formMethod})};let i,a,o=()=>({path:n,error:we(400,{type:"invalid-body"})}),s=r.formMethod||"get",l=e?s.toUpperCase():s.toLowerCase(),c=Le(n);if(void 0!==r.body){if("text/plain"===r.formEncType){if(!Ne(l))return o();let e="string"===typeof r.body?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce(((e,t)=>{let[n,r]=t;return""+e+n+"="+r+"\n"}),""):String(r.body);return{path:n,submission:{formMethod:l,formAction:c,formEncType:r.formEncType,formData:void 0,json:void 0,text:e}}}if("application/json"===r.formEncType){if(!Ne(l))return o();try{let e="string"===typeof r.body?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:l,formAction:c,formEncType:r.formEncType,formData:void 0,json:e,text:void 0}}}catch(g){return o()}}}if(p("function"===typeof FormData,"FormData is not available in this environment"),r.formData)i=ye(r.formData),a=r.formData;else if(r.body instanceof FormData)i=ye(r.body),a=r.body;else if(r.body instanceof URLSearchParams)i=r.body,a=Ce(i);else if(null==r.body)i=new URLSearchParams,a=new FormData;else try{i=new URLSearchParams(r.body),a=Ce(i)}catch(g){return o()}let d={formMethod:l,formAction:c,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:a,json:void 0,text:void 0};if(Ne(d.formMethod))return{path:n,submission:d};let u=_(n);return t&&u.search&&xe(u.search)&&i.append("index",""),u.search="?"+i,{path:C(u),submission:d}}function ue(e,t){let n=e;if(t){let r=e.findIndex((e=>e.route.id===t));r>=0&&(n=e.slice(0,r))}return n}function ge(e,t,n,r,i,a,o,s,l,c,d,u,g,h,p,m){let v=m?Object.values(m)[0]:p?Object.values(p)[0]:void 0,y=e.createURL(t.location),C=e.createURL(i),_=m?Object.keys(m)[0]:void 0,S=ue(n,_).filter(((e,n)=>{let{route:i}=e;if(i.lazy)return!0;if(null==i.loader)return!1;if(a)return!!i.loader.hydrate||void 0===t.loaderData[i.id]&&(!t.errors||void 0===t.errors[i.id]);if(function(e,t,n){let r=!t||n.route.id!==t.route.id,i=void 0===e[n.route.id];return r||i}(t.loaderData,t.matches[n],e)||s.some((t=>t===e.route.id)))return!0;let l=t.matches[n],c=e;return he(e,f({currentUrl:y,currentParams:l.params,nextUrl:C,nextParams:c.params},r,{actionResult:v,defaultShouldRevalidate:o||y.pathname+y.search===C.pathname+C.search||y.search!==C.search||fe(l,c)}))})),E=[];return d.forEach(((e,i)=>{if(a||!n.some((t=>t.route.id===e.routeId))||c.has(i))return;let s=w(g,e.path,h);if(!s)return void E.push({key:i,routeId:e.routeId,path:e.path,matches:null,match:null,controller:null});let d=t.fetchers.get(i),p=Fe(s,e.path),m=!1;m=!u.has(i)&&(!!l.includes(i)||(d&&"idle"!==d.state&&void 0===d.data?o:he(p,f({currentUrl:y,currentParams:t.matches[t.matches.length-1].params,nextUrl:C,nextParams:n[n.length-1].params},r,{actionResult:v,defaultShouldRevalidate:o})))),m&&E.push({key:i,routeId:e.routeId,path:e.path,matches:s,match:p,controller:new AbortController})})),[S,E]}function fe(e,t){let n=e.route.path;return e.pathname!==t.pathname||null!=n&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function he(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if("boolean"===typeof n)return n}return t.defaultShouldRevalidate}async function pe(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let i=n[e.id];p(i,"No route found in manifest");let a={};for(let o in r){let e=void 0!==i[o]&&"hasErrorBoundary"!==o;m(!e,'Route "'+i.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. The lazy route property "'+o+'" will be ignored.'),e||b.has(o)||(a[o]=r[o])}Object.assign(i,a),Object.assign(i,f({},t(i),{lazy:void 0}))}async function me(e,t,n,r,i,a,o,s,l){let c,d,u;void 0===l&&(l={});let g=e=>{let r,i=new Promise(((e,t)=>r=t));return u=()=>r(),t.signal.addEventListener("abort",u),Promise.race([e({request:t,params:n.params,context:l.requestContext}),i])};try{let r=n.route[e];if(n.route.lazy)if(r){let e,t=await Promise.all([g(r).catch((t=>{e=t})),pe(n.route,a,i)]);if(e)throw e;d=t[0]}else{if(await pe(n.route,a,i),r=n.route[e],!r){if("action"===e){let e=new URL(t.url),r=e.pathname+e.search;throw we(405,{method:t.method,pathname:r,routeId:n.route.id})}return{type:E.data,data:void 0}}d=await g(r)}else{if(!r){let e=new URL(t.url);throw we(404,{pathname:e.pathname+e.search})}d=await g(r)}p(void 0!==d,"You defined "+("action"===e?"an action":"a loader")+' for route "'+n.route.id+"\" but didn't return anything from your `"+e+"` function. Please return a value or `null`.")}catch(m){c=E.error,d=m}finally{u&&t.signal.removeEventListener("abort",u)}if(Oe(d)){let e,i=d.status;if(ee.has(i)){let e=d.headers.get("Location");if(p(e,"Redirects returned/thrown from loaders/actions must have a Location header"),ae.test(e)){if(!l.isStaticRequest){let n=new URL(t.url),r=e.startsWith("//")?new URL(n.protocol+e):new URL(e),i=null!=V(r.pathname,o);r.origin===n.origin&&i&&(e=r.pathname+r.search+r.hash)}}else e=ce(new URL(t.url),r.slice(0,r.indexOf(n)+1),o,!0,e,s);if(l.isStaticRequest)throw d.headers.set("Location",e),d;return{type:E.redirect,status:i,location:e,revalidate:null!==d.headers.get("X-Remix-Revalidate"),reloadDocument:null!==d.headers.get("X-Remix-Reload-Document")}}if(l.isRouteRequest){throw{type:c===E.error?E.error:E.data,response:d}}try{let t=d.headers.get("Content-Type");e=t&&/\bapplication\/json\b/.test(t)?null==d.body?null:await d.json():await d.text()}catch(m){return{type:E.error,error:m}}return c===E.error?{type:c,error:new K(i,d.statusText,e),headers:d.headers}:{type:E.data,data:e,statusCode:d.status,headers:d.headers}}return c===E.error?{type:c,error:d}:function(e){let t=e;return t&&"object"===typeof t&&"object"===typeof t.data&&"function"===typeof t.subscribe&&"function"===typeof t.cancel&&"function"===typeof t.resolveData}(d)?{type:E.deferred,deferredData:d,statusCode:null==(f=d.init)?void 0:f.status,headers:(null==(h=d.init)?void 0:h.headers)&&new Headers(d.init.headers)}:{type:E.data,data:d};var f,h}function ve(e,t,n,r){let i=e.createURL(Le(t)).toString(),a={signal:n};if(r&&Ne(r.formMethod)){let{formMethod:e,formEncType:t}=r;a.method=e.toUpperCase(),"application/json"===t?(a.headers=new Headers({"Content-Type":t}),a.body=JSON.stringify(r.json)):"text/plain"===t?a.body=r.text:"application/x-www-form-urlencoded"===t&&r.formData?a.body=ye(r.formData):a.body=r.formData}return new Request(i,a)}function ye(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,"string"===typeof r?r:r.name);return t}function Ce(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function _e(e,t,n,r,i){let a,o={},s=null,l=!1,c={};return n.forEach(((n,d)=>{let u=t[d].route.id;if(p(!Pe(n),"Cannot handle redirect results in processLoaderData"),Ie(n)){let t=be(e,u),i=n.error;r&&(i=Object.values(r)[0],r=void 0),s=s||{},null==s[t.route.id]&&(s[t.route.id]=i),o[u]=void 0,l||(l=!0,a=J(n.error)?n.error.status:500),n.headers&&(c[u]=n.headers)}else Te(n)?(i.set(u,n.deferredData),o[u]=n.deferredData.data):o[u]=n.data,null==n.statusCode||200===n.statusCode||l||(a=n.statusCode),n.headers&&(c[u]=n.headers)})),r&&(s=r,o[Object.keys(r)[0]]=void 0),{loaderData:o,errors:s,statusCode:a||200,loaderHeaders:c}}function Se(e,t,n,r,i,a,o,s){let{loaderData:l,errors:c}=_e(t,n,r,i,s);for(let d=0;d<a.length;d++){let{key:t,match:n,controller:r}=a[d];p(void 0!==o&&void 0!==o[d],"Did not find corresponding fetcher result");let i=o[d];if(!r||!r.signal.aborted)if(Ie(i)){let r=be(e.matches,null==n?void 0:n.route.id);c&&c[r.route.id]||(c=f({},c,{[r.route.id]:i.error})),e.fetchers.delete(t)}else if(Pe(i))p(!1,"Unhandled fetcher revalidation redirect");else if(Te(i))p(!1,"Unhandled fetcher deferred data");else{let n=Ge(i.data);e.fetchers.set(t,n)}}return{loaderData:l,errors:c}}function Ee(e,t,n,r){let i=f({},t);for(let a of n){let n=a.route.id;if(t.hasOwnProperty(n)?void 0!==t[n]&&(i[n]=t[n]):void 0!==e[n]&&a.route.loader&&(i[n]=e[n]),r&&r.hasOwnProperty(n))break}return i}function be(e,t){return(t?e.slice(0,e.findIndex((e=>e.route.id===t))+1):[...e]).reverse().find((e=>!0===e.route.hasErrorBoundary))||e[0]}function Me(e){let t=1===e.length?e[0]:e.find((e=>e.index||!e.path||"/"===e.path))||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function we(e,t){let{pathname:n,routeId:r,method:i,type:a}=void 0===t?{}:t,o="Unknown Server Error",s="Unknown @remix-run/router error";return 400===e?(o="Bad Request",i&&n&&r?s="You made a "+i+' request to "'+n+'" but did not provide a `loader` for route "'+r+'", so there is no way to handle the request.':"defer-action"===a?s="defer() is not supported in actions":"invalid-body"===a&&(s="Unable to encode submission body")):403===e?(o="Forbidden",s='Route "'+r+'" does not match URL "'+n+'"'):404===e?(o="Not Found",s='No route matches URL "'+n+'"'):405===e&&(o="Method Not Allowed",i&&n&&r?s="You made a "+i.toUpperCase()+' request to "'+n+'" but did not provide an `action` for route "'+r+'", so there is no way to handle the request.':i&&(s='Invalid request method "'+i.toUpperCase()+'"')),new K(e||500,o,new Error(s),!0)}function Re(e){for(let t=e.length-1;t>=0;t--){let n=e[t];if(Pe(n))return{result:n,idx:t}}}function Le(e){return C(f({},"string"===typeof e?_(e):e,{hash:""}))}function Te(e){return e.type===E.deferred}function Ie(e){return e.type===E.error}function Pe(e){return(e&&e.type)===E.redirect}function Oe(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"object"===typeof e.headers&&"undefined"!==typeof e.body}function Ae(e){return X.has(e.toLowerCase())}function Ne(e){return Y.has(e.toLowerCase())}async function ke(e,t,n,r,i,a){for(let o=0;o<n.length;o++){let s=n[o],l=t[o];if(!l)continue;let c=e.find((e=>e.route.id===l.route.id)),d=null!=c&&!fe(c,l)&&void 0!==(a&&a[l.route.id]);if(Te(s)&&(i||d)){let e=r[o];p(e,"Expected an AbortSignal for revalidating fetcher deferred result"),await De(s,e,i).then((e=>{e&&(n[o]=e||n[o])}))}}}async function De(e,t,n){if(void 0===n&&(n=!1),!await e.deferredData.resolveData(t)){if(n)try{return{type:E.data,data:e.deferredData.unwrappedData}}catch(r){return{type:E.error,error:r}}return{type:E.data,data:e.deferredData.data}}}function xe(e){return new URLSearchParams(e).getAll("index").some((e=>""===e))}function Fe(e,t){let n="string"===typeof t?_(t).search:t.search;if(e[e.length-1].route.index&&xe(n||""))return e[e.length-1];let r=G(e);return r[r.length-1]}function je(e){let{formMethod:t,formAction:n,formEncType:r,text:i,formData:a,json:o}=e;if(t&&n&&r)return null!=i?{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i}:null!=a?{formMethod:t,formAction:n,formEncType:r,formData:a,json:void 0,text:void 0}:void 0!==o?{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}:void 0}function Ve(e,t){if(t){return{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}return{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function Ue(e,t){if(e){return{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}}return{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function Ge(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function ze(){return ze=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ze.apply(this,arguments)}const He=e.createContext(null);const qe=e.createContext(null);const We=e.createContext(null);const Be=e.createContext({outlet:null,matches:[],isDataRoute:!1});function Qe(){return null!=e.useContext(We)}function Ke(){return Qe()||p(!1),e.useContext(We).location}function Je(t){e.useContext(qe).static||e.useLayoutEffect(t)}function $e(){let{isDataRoute:t}=e.useContext(Be);return t?function(){let{router:t}=Xe(Ye.UseNavigateStable),n=et(Ze.UseNavigateStable),r=e.useRef(!1);Je((()=>{r.current=!0}));let i=e.useCallback((function(e,i){void 0===i&&(i={}),r.current&&("number"===typeof e?t.navigate(e):t.navigate(e,ze({fromRouteId:n},i)))}),[t,n]);return i}():function(){Qe()||p(!1);let t=e.useContext(He),{basename:n,future:r,navigator:i}=e.useContext(qe),{matches:a}=e.useContext(Be),{pathname:o}=Ke(),s=JSON.stringify(z(a,r.v7_relativeSplatPath)),l=e.useRef(!1);return Je((()=>{l.current=!0})),e.useCallback((function(e,r){if(void 0===r&&(r={}),!l.current)return;if("number"===typeof e)return void i.go(e);let a=H(e,JSON.parse(s),o,"path"===r.relative);null==t&&"/"!==n&&(a.pathname="/"===a.pathname?n:q([n,a.pathname])),(r.replace?i.replace:i.push)(a,r.state,r)}),[n,i,s,o,t])}()}e.Component;var Ye=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Ye||{}),Ze=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Ze||{});function Xe(t){let n=e.useContext(He);return n||p(!1),n}function et(t){let n=function(t){let n=e.useContext(Be);return n||p(!1),n}(),r=n.matches[n.matches.length-1];return r.route.id||p(!1),r.route.id}t.startTransition;new Promise((()=>{}));e.Component;function tt(t){let n={hasErrorBoundary:null!=t.ErrorBoundary||null!=t.errorElement};return t.Component&&Object.assign(n,{element:e.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(n,{hydrateFallbackElement:e.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(n,{errorElement:e.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),n}function nt(){return nt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nt.apply(this,arguments)}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rt(){var e;let t=null==(e=window)?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=nt({},t,{errors:it(t.errors)})),t}function it(e){if(!e)return null;let t=Object.entries(e),n={};for(let[i,a]of t)if(a&&"RouteErrorResponse"===a.__type)n[i]=new K(a.status,a.statusText,a.data,!0===a.internal);else if(a&&"Error"===a.__type){if(a.__subType){let e=window[a.__subType];if("function"===typeof e)try{let t=new e(a.message);t.stack="",n[i]=t}catch(r){}}if(null==n[i]){let e=new Error(a.message);e.stack="",n[i]=e}}else n[i]=a;return n}new Map;t.startTransition,g.flushSync,t.useId;"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var at,ot;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(at||(at={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(ot||(ot={}));var st=n(418),lt=n.n(st);const ct=e=>{let{direction:t="row",gap:n=0,children:r,className:i,style:o}=e;return(0,a.jsx)("div",{className:lt()("root",i),style:{flexDirection:t,gap:n,...o},children:r})},dt=e=>{let{children:t,gap:n,className:r,style:i}=e;return(0,a.jsx)(ct,{className:r,direction:"row",gap:n,style:i,children:t})},ut=e=>{let{children:t,gap:n,className:r,style:i}=e;return(0,a.jsx)(ct,{direction:"column",gap:n,className:r,style:i,children:t})},gt=e=>{let{elipsis:t,children:n}=e;return(0,a.jsx)("span",{className:t?"elipsisText":void 0,children:n})},ft=e=>{let{children:t,onClick:n}=e;return(0,a.jsx)("button",{className:"baseButton",onClick:n,children:t})},ht=e=>{let{gap:t,children:n,style:r}=e;return(0,a.jsx)(ut,{className:"card",gap:t,style:r,children:n})},pt=10,mt=e=>{let{gap:t=pt,children:n}=e;return(0,a.jsx)(ut,{className:"page",gap:t,children:n})},vt=e=>{let{level:t=1,children:n}=e;switch(t){case 1:return(0,a.jsx)("h1",{children:n});case 2:return(0,a.jsx)("h2",{children:n});case 3:return(0,a.jsx)("h3",{children:n});case 4:return(0,a.jsx)("h4",{children:n});case 5:return(0,a.jsx)("h5",{children:n});case 6:return(0,a.jsx)("h6",{children:n});default:throw new Error("Unexpected level of title")}},yt=e=>{let{centered:t}=e;return(0,a.jsx)("div",{style:t?{margin:"auto"}:void 0,className:"spinner"})};const Ct={root:null,rootMargin:"0px",threshold:.1},_t=t=>{var n;let{onFetchMore:r,intersectionObserverInit:i}=t;const[o,s]=(0,e.useState)({current:null}),l=(0,e.useCallback)((e=>{s({current:e})}),[s]),c=function(t,n){const[r,i]=(0,e.useState)(!1),a=(0,e.useCallback)((e=>{const[t]=e;i(t.isIntersecting)}),[]);return(0,e.useEffect)((()=>{const e=new IntersectionObserver(a,n);if(t)return e.observe(t),()=>{e.unobserve(t)}}),[t,n]),r}(o.current,null!==i&&void 0!==i?i:Ct),d=null!==(n=function(t){const n=(0,e.useRef)();return(0,e.useEffect)((()=>{n.current=t})),n.current}(c))&&void 0!==n&&n;return(0,e.useEffect)((()=>{!d&&c&&r()}),[c,d,r]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"observer",ref:l}),(0,a.jsx)(yt,{centered:!0})]})};function St(e){return"Minified Redux error #".concat(e,"; visit https://redux.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}var Et=(()=>"function"===typeof Symbol&&Symbol.observable||"@@observable")(),bt=()=>Math.random().toString(36).substring(7).split("").join("."),Mt={INIT:"@@redux/INIT".concat(bt()),REPLACE:"@@redux/REPLACE".concat(bt()),PROBE_UNKNOWN_ACTION:()=>"@@redux/PROBE_UNKNOWN_ACTION".concat(bt())};function wt(e){if("object"!==typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function Rt(e,t,n){if("function"!==typeof e)throw new Error(St(2));if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(St(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(St(1));return n(Rt)(e,t)}let r=e,i=t,a=new Map,o=a,s=0,l=!1;function c(){o===a&&(o=new Map,a.forEach(((e,t)=>{o.set(t,e)})))}function d(){if(l)throw new Error(St(3));return i}function u(e){if("function"!==typeof e)throw new Error(St(4));if(l)throw new Error(St(5));let t=!0;c();const n=s++;return o.set(n,e),function(){if(t){if(l)throw new Error(St(6));t=!1,c(),o.delete(n),a=null}}}function g(e){if(!wt(e))throw new Error(St(7));if("undefined"===typeof e.type)throw new Error(St(8));if("string"!==typeof e.type)throw new Error(St(17));if(l)throw new Error(St(9));try{l=!0,i=r(i,e)}finally{l=!1}return(a=o).forEach((e=>{e()})),e}g({type:Mt.INIT});return{dispatch:g,subscribe:u,getState:d,replaceReducer:function(e){if("function"!==typeof e)throw new Error(St(10));r=e,g({type:Mt.REPLACE})},[Et]:function(){const e=u;return{subscribe(t){if("object"!==typeof t||null===t)throw new Error(St(11));function n(){const e=t;e.next&&e.next(d())}n();return{unsubscribe:e(n)}},[Et](){return this}}}}}function Lt(e){const t=Object.keys(e),n={};for(let o=0;o<t.length;o++){const r=t[o];0,"function"===typeof e[r]&&(n[r]=e[r])}const r=Object.keys(n);let i;try{!function(e){Object.keys(e).forEach((t=>{const n=e[t];if("undefined"===typeof n(void 0,{type:Mt.INIT}))throw new Error(St(12));if("undefined"===typeof n(void 0,{type:Mt.PROBE_UNKNOWN_ACTION()}))throw new Error(St(13))}))}(n)}catch(a){i=a}return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(i)throw i;let a=!1;const o={};for(let i=0;i<r.length;i++){const s=r[i],l=n[s],c=e[s],d=l(c,t);if("undefined"===typeof d){t&&t.type;throw new Error(St(14))}o[s]=d,a=a||d!==c}return a=a||r.length!==Object.keys(e).length,a?o:e}}function Tt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>e:1===t.length?t[0]:t.reduce(((e,t)=>function(){return e(t(...arguments))}))}function It(e){return wt(e)&&"type"in e&&"string"===typeof e.type}function Pt(e){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pt(e)}function Ot(e){var t=function(e,t){if("object"!=Pt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Pt(t)?t:String(t)}function At(e,t,n){return(t=Ot(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Nt=Symbol.for("immer-nothing"),kt=Symbol.for("immer-draftable"),Dt=Symbol.for("immer-state");function xt(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var Ft=Object.getPrototypeOf;function jt(e){return!!e&&!!e[Dt]}function Vt(e){var t;return!!e&&(Gt(e)||Array.isArray(e)||!!e[kt]||!(null===(t=e.constructor)||void 0===t||!t[kt])||Qt(e)||Kt(e))}var Ut=Object.prototype.constructor.toString();function Gt(e){if(!e||"object"!==typeof e)return!1;const t=Ft(e);if(null===t)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Ut}function zt(e,t){0===Ht(e)?Object.entries(e).forEach((n=>{let[r,i]=n;t(r,i,e)})):e.forEach(((n,r)=>t(r,n,e)))}function Ht(e){const t=e[Dt];return t?t.type_:Array.isArray(e)?1:Qt(e)?2:Kt(e)?3:0}function qt(e,t){return 2===Ht(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Wt(e,t){return 2===Ht(e)?e.get(t):e[t]}function Bt(e,t,n){const r=Ht(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function Qt(e){return e instanceof Map}function Kt(e){return e instanceof Set}function Jt(e){return e.copy_||e.base_}function $t(e,t){if(Qt(e))return new Map(e);if(Kt(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&Gt(e)){if(!Ft(e)){const t=Object.create(null);return Object.assign(t,e)}return{...e}}const n=Object.getOwnPropertyDescriptors(e);delete n[Dt];let r=Reflect.ownKeys(n);for(let i=0;i<r.length;i++){const t=r[i],a=n[t];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[t]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[t]})}return Object.create(Ft(e),n)}function Yt(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Xt(e)||jt(e)||!Vt(e)||(Ht(e)>1&&(e.set=e.add=e.clear=e.delete=Zt),Object.freeze(e),t&&zt(e,((e,t)=>Yt(t,!0)))),e}function Zt(){xt(2)}function Xt(e){return Object.isFrozen(e)}var en,tn={};function nn(e){const t=tn[e];return t||xt(0),t}function rn(e,t){tn[e]||(tn[e]=t)}function an(){return en}function on(e,t){t&&(nn("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function sn(e){ln(e),e.drafts_.forEach(dn),e.drafts_=null}function ln(e){e===en&&(en=e.parent_)}function cn(e){return en={drafts_:[],parent_:en,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function dn(e){const t=e[Dt];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function un(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[Dt].modified_&&(sn(t),xt(4)),Vt(e)&&(e=gn(t,e),t.parent_||hn(t,e)),t.patches_&&nn("Patches").generateReplacementPatches_(n[Dt].base_,e,t.patches_,t.inversePatches_)):e=gn(t,n,[]),sn(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Nt?e:void 0}function gn(e,t,n){if(Xt(t))return t;const r=t[Dt];if(!r)return zt(t,((i,a)=>fn(e,r,t,i,a,n))),t;if(r.scope_!==e)return t;if(!r.modified_)return hn(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const t=r.copy_;let i=t,a=!1;3===r.type_&&(i=new Set(t),t.clear(),a=!0),zt(i,((i,o)=>fn(e,r,t,i,o,n,a))),hn(e,t,!1),n&&e.patches_&&nn("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function fn(e,t,n,r,i,a,o){if(jt(i)){const o=gn(e,i,a&&t&&3!==t.type_&&!qt(t.assigned_,r)?a.concat(r):void 0);if(Bt(n,r,o),!jt(o))return;e.canAutoFreeze_=!1}else o&&n.add(i);if(Vt(i)&&!Xt(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;gn(e,i),t&&t.scope_.parent_||hn(e,i)}}function hn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Yt(t,n)}var pn={get(e,t){if(t===Dt)return e;const n=Jt(e);if(!qt(n,t))return function(e,t,n){var r;const i=yn(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!Vt(r)?r:r===vn(e.base_,t)?(_n(e),e.copy_[t]=Sn(r,e)):r},has:(e,t)=>t in Jt(e),ownKeys:e=>Reflect.ownKeys(Jt(e)),set(e,t,n){const r=yn(Jt(e),t);if(null!==r&&void 0!==r&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=vn(Jt(e),t),o=null===r||void 0===r?void 0:r[Dt];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((i=n)===(a=r)?0!==i||1/i===1/a:i!==i&&a!==a)&&(void 0!==n||qt(e.base_,t)))return!0;_n(e),Cn(e)}var i,a;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==vn(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,_n(e),Cn(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=Jt(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){xt(11)},getPrototypeOf:e=>Ft(e.base_),setPrototypeOf(){xt(12)}},mn={};function vn(e,t){const n=e[Dt];return(n?Jt(n):e)[t]}function yn(e,t){if(!(t in e))return;let n=Ft(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=Ft(n)}}function Cn(e){e.modified_||(e.modified_=!0,e.parent_&&Cn(e.parent_))}function _n(e){e.copy_||(e.copy_=$t(e.base_,e.scope_.immer_.useStrictShallowCopy_))}zt(pn,((e,t)=>{mn[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),mn.deleteProperty=function(e,t){return mn.set.call(this,e,t,void 0)},mn.set=function(e,t,n){return pn.set.call(this,e[0],t,n,e[0])};function Sn(e,t){const n=Qt(e)?nn("MapSet").proxyMap_(e,t):Kt(e)?nn("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:an(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,a=pn;n&&(i=[r],a=mn);const{revoke:o,proxy:s}=Proxy.revocable(i,a);return r.draft_=s,r.revoke_=o,s}(e,t);return(t?t.scope_:an()).drafts_.push(n),n}function En(e){return jt(e)||xt(10),bn(e)}function bn(e){if(!Vt(e)||Xt(e))return e;const t=e[Dt];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=$t(e,t.scope_.immer_.useStrictShallowCopy_)}else n=$t(e,!0);return zt(n,((e,t)=>{Bt(n,e,bn(t))})),t&&(t.finalized_=!1),n}function Mn(){const e="replace",t="add",n="remove";function r(e){if(!Vt(e))return e;if(Array.isArray(e))return e.map(r);if(Qt(e))return new Map(Array.from(e.entries()).map((e=>{let[t,n]=e;return[t,r(n)]})));if(Kt(e))return new Set(Array.from(e).map(r));const t=Object.create(Ft(e));for(const n in e)t[n]=r(e[n]);return qt(e,kt)&&(t[kt]=e[kt]),t}function i(e){return jt(e)?r(e):e}rn("Patches",{applyPatches_:function(i,a){return a.forEach((a=>{const{path:o,op:s}=a;let l=i;for(let e=0;e<o.length-1;e++){const t=Ht(l);let n=o[e];"string"!==typeof n&&"number"!==typeof n&&(n=""+n),0!==t&&1!==t||"__proto__"!==n&&"constructor"!==n||xt(19),"function"===typeof l&&"prototype"===n&&xt(19),l=Wt(l,n),"object"!==typeof l&&xt(18,o.join("/"))}const c=Ht(l),d=r(a.value),u=o[o.length-1];switch(s){case e:switch(c){case 2:return l.set(u,d);case 3:xt(16);default:return l[u]=d}case t:switch(c){case 1:return"-"===u?l.push(d):l.splice(u,0,d);case 2:return l.set(u,d);case 3:return l.add(d);default:return l[u]=d}case n:switch(c){case 1:return l.splice(u,1);case 2:return l.delete(u);case 3:return l.delete(a.value);default:return delete l[u]}default:xt(17)}})),i},generatePatches_:function(r,a,o,s){switch(r.type_){case 0:case 2:return function(r,a,o,s){const{base_:l,copy_:c}=r;zt(r.assigned_,((r,d)=>{const u=Wt(l,r),g=Wt(c,r),f=d?qt(l,r)?e:t:n;if(u===g&&f===e)return;const h=a.concat(r);o.push(f===n?{op:f,path:h}:{op:f,path:h,value:g}),s.push(f===t?{op:n,path:h}:f===n?{op:t,path:h,value:i(u)}:{op:e,path:h,value:i(u)})}))}(r,a,o,s);case 1:return function(r,a,o,s){let{base_:l,assigned_:c}=r,d=r.copy_;d.length<l.length&&([l,d]=[d,l],[o,s]=[s,o]);for(let t=0;t<l.length;t++)if(c[t]&&d[t]!==l[t]){const n=a.concat([t]);o.push({op:e,path:n,value:i(d[t])}),s.push({op:e,path:n,value:i(l[t])})}for(let e=l.length;e<d.length;e++){const n=a.concat([e]);o.push({op:t,path:n,value:i(d[e])})}for(let e=d.length-1;l.length<=e;--e){const t=a.concat([e]);s.push({op:n,path:t})}}(r,a,o,s);case 3:return function(e,r,i,a){let{base_:o,copy_:s}=e,l=0;o.forEach((e=>{if(!s.has(e)){const o=r.concat([l]);i.push({op:n,path:o,value:e}),a.unshift({op:t,path:o,value:e})}l++})),l=0,s.forEach((e=>{if(!o.has(e)){const o=r.concat([l]);i.push({op:t,path:o,value:e}),a.unshift({op:n,path:o,value:e})}l++}))}(r,a,o,s)}},generateReplacementPatches_:function(t,n,r,i){r.push({op:e,path:[],value:n===Nt?void 0:n}),i.push({op:e,path:[],value:t})}})}var wn=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if("function"===typeof e&&"function"!==typeof t){const n=t;t=e;const r=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return r.produce(e,(e=>t.call(this,e,...a)))}}let r;if("function"!==typeof t&&xt(6),void 0!==n&&"function"!==typeof n&&xt(7),Vt(e)){const i=cn(this),a=Sn(e,void 0);let o=!0;try{r=t(a),o=!1}finally{o?sn(i):ln(i)}return on(i,n),un(r,i)}if(!e||"object"!==typeof e){if(r=t(e),void 0===r&&(r=e),r===Nt&&(r=void 0),this.autoFreeze_&&Yt(r,!0),n){const t=[],i=[];nn("Patches").generateReplacementPatches_(e,r,t,i),n(t,i)}return r}xt(1)},this.produceWithPatches=(e,n)=>{if("function"===typeof e)return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return t.produceWithPatches(n,(t=>e(t,...i)))};let r,i;return[this.produce(e,n,((e,t)=>{r=e,i=t})),r,i]},"boolean"===typeof(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Vt(e)||xt(8),jt(e)&&(e=En(e));const t=cn(this),n=Sn(e,void 0);return n[Dt].isManual_=!0,ln(t),n}finishDraft(e,t){const n=e&&e[Dt];n&&n.isManual_||xt(9);const{scope_:r}=n;return on(r,t),un(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=nn("Patches").applyPatches_;return jt(e)?r(e,t):this.produce(e,(e=>r(e,t)))}},Rn=wn.produce,Ln=wn.produceWithPatches.bind(wn),Tn=(wn.setAutoFreeze.bind(wn),wn.setUseStrictShallowCopy.bind(wn),wn.applyPatches.bind(wn));wn.createDraft.bind(wn),wn.finishDraft.bind(wn);function In(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected a function, instead received ".concat(typeof e);if("function"!==typeof e)throw new TypeError(t)}var Pn=e=>Array.isArray(e)?e:[e];function On(e){const t=Array.isArray(e[0])?e[0]:e;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected all items to be functions, instead received the following types: ";if(!e.every((e=>"function"===typeof e))){const n=e.map((e=>"function"===typeof e?"function ".concat(e.name||"unnamed","()"):typeof e)).join(", ");throw new TypeError("".concat(t,"[").concat(n,"]"))}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}Symbol(),Object.getPrototypeOf({});var An="undefined"!==typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}},Nn=0,kn=1;function Dn(){return{s:Nn,v:void 0,o:null,p:null}}function xn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Dn();const{resultEqualityCheck:r}=t;let i,a=0;function o(){let t=n;const{length:o}=arguments;for(let e=0,n=o;e<n;e++){const n=arguments[e];if("function"===typeof n||"object"===typeof n&&null!==n){let e=t.o;null===e&&(t.o=e=new WeakMap);const r=e.get(n);void 0===r?(t=Dn(),e.set(n,t)):t=r}else{let e=t.p;null===e&&(t.p=e=new Map);const r=e.get(n);void 0===r?(t=Dn(),e.set(n,t)):t=r}}const s=t;let l;if(t.s===kn?l=t.v:(l=e.apply(null,arguments),a++),s.s=kn,r){var c,d,u;const e=null!==(c=null===(d=i)||void 0===d||null===(u=d.deref)||void 0===u?void 0:u.call(d))&&void 0!==c?c:i;null!=e&&r(e,l)&&(l=e,0!==a&&a--);i="object"===typeof l&&null!==l||"function"===typeof l?new An(l):l}return s.v=l,l}return o.clearCache=()=>{n=Dn(),o.resetResultsCount()},o.resultsCount=()=>a,o.resetResultsCount=()=>{a=0},o}function Fn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i="function"===typeof e?{memoize:e,memoizeOptions:n}:e,a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let r,a=0,o=0,s={},l=t.pop();"object"===typeof l&&(s=l,l=t.pop()),In(l,"createSelector expects an output function after the inputs, but received: [".concat(typeof l,"]"));const c={...i,...s},{memoize:d,memoizeOptions:u=[],argsMemoize:g=xn,argsMemoizeOptions:f=[],devModeChecks:h={}}=c,p=Pn(u),m=Pn(f),v=On(t),y=d((function(){return a++,l.apply(null,arguments)}),...p);const C=g((function(){o++;const e=function(e,t){const n=[],{length:r}=e;for(let i=0;i<r;i++)n.push(e[i].apply(null,t));return n}(v,arguments);return r=y.apply(null,e),r}),...m);return Object.assign(C,{resultFunc:l,memoizedResultFunc:y,dependencies:v,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>r,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:d,argsMemoize:g})};return Object.assign(a,{withTypes:()=>a}),a}var jn=Fn(xn),Vn=Object.assign((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jn;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected an object, instead received ".concat(typeof e);if("object"!==typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ".concat(typeof e));const n=Object.keys(e),r=t(n.map((t=>e[t])),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(((e,t,r)=>(e[n[r]]=t,e)),{})}));return r}),{withTypes:()=>Vn});function Un(e){return t=>{let{dispatch:n,getState:r}=t;return t=>i=>"function"===typeof i?i(n,r,e):t(i)}}var Gn=Un(),zn=Un,Hn=(function(){const e=Fn(...arguments),t=Object.assign((function(){const t=e(...arguments),n=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t(jt(e)?En(e):e,...r)};return Object.assign(n,t),n}),{withTypes:()=>t})}(xn),"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?Tt:Tt.apply(null,arguments)}),qn=("undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__,e=>e&&"function"===typeof e.match);function Wn(e,t){function n(){if(t){let n=t(...arguments);if(!n)throw new Error(Nr(0));return{type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=()=>"".concat(e),n.type=e,n.match=t=>It(t)&&t.type===e,n}var Bn=class e extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return super.concat.apply(this,t)}prepend(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return 1===n.length&&Array.isArray(n[0])?new e(...n[0].concat(this)):new e(...n.concat(this))}};function Qn(e){return Vt(e)?Rn(e,(()=>{})):e}function Kn(e,t,n){if(e.has(t)){let r=e.get(t);return n.update&&(r=n.update(r,t,e),e.set(t,r)),r}if(!n.insert)throw new Error(Nr(10));const r=n.insert(t,e);return e.set(t,r),r}var Jn="RTK_autoBatch",$n=()=>e=>({payload:e,meta:{[Jn]:!0}}),Yn=e=>t=>{setTimeout(t,e)},Zn="undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:Yn(10),Xn=e=>function(t){const{autoBatch:n=!0}=null!==t&&void 0!==t?t:{};let r=new Bn(e);return n&&r.push(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"raf"};return t=>function(){const n=t(...arguments);let r=!0,i=!1,a=!1;const o=new Set,s="tick"===e.type?queueMicrotask:"raf"===e.type?Zn:"callback"===e.type?e.queueNotification:Yn(e.timeout),l=()=>{a=!1,i&&(i=!1,o.forEach((e=>e())))};return Object.assign({},n,{subscribe(e){const t=n.subscribe((()=>r&&e()));return o.add(e),()=>{t(),o.delete(e)}},dispatch(e){try{var t;return r=!(null!==e&&void 0!==e&&null!==(t=e.meta)&&void 0!==t&&t[Jn]),i=!r,i&&(a||(a=!0,s(l))),n.dispatch(e)}finally{r=!0}}})}}("object"===typeof n?n:void 0)),r};function er(e){const t={},n=[];let r;const i={addCase(e,n){const r="string"===typeof e?e:e.type;if(!r)throw new Error(Nr(28));if(r in t)throw new Error(Nr(29));return t[r]=n,i},addMatcher:(e,t)=>(n.push({matcher:e,reducer:t}),i),addDefaultCase:e=>(r=e,i)};return e(i),[t,n,r]}var tr=function(){let e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;for(;t--;)e+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return e},nr=(e,t)=>qn(e)?e.match(t):e(t);function rr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>t.some((t=>nr(t,e)))}function ir(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>t.every((t=>nr(t,e)))}function ar(e,t){if(!e||!e.meta)return!1;const n="string"===typeof e.meta.requestId,r=t.indexOf(e.meta.requestStatus)>-1;return n&&r}function or(e){return"function"===typeof e[0]&&"pending"in e[0]&&"fulfilled"in e[0]&&"rejected"in e[0]}function sr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>ar(e,["pending"]):or(t)?e=>rr(...t.map((e=>e.pending)))(e):sr()(t[0])}function lr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>ar(e,["rejected"]):or(t)?e=>rr(...t.map((e=>e.rejected)))(e):lr()(t[0])}function cr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=e=>e&&e.meta&&e.meta.rejectedWithValue;return 0===t.length||or(t)?e=>ir(lr(...t),r)(e):cr()(t[0])}function dr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>ar(e,["fulfilled"]):or(t)?e=>rr(...t.map((e=>e.fulfilled)))(e):dr()(t[0])}function ur(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>ar(e,["pending","fulfilled","rejected"]):or(t)?e=>{const n=[];for(const r of t)n.push(r.pending,r.rejected,r.fulfilled);return rr(...n)(e)}:ur()(t[0])}var gr=["name","message","stack","code"],fr=class{constructor(e,t){At(this,"_type",void 0),this.payload=e,this.meta=t}},hr=class{constructor(e,t){At(this,"_type",void 0),this.payload=e,this.meta=t}},pr=e=>{if("object"===typeof e&&null!==e){const t={};for(const n of gr)"string"===typeof e[n]&&(t[n]=e[n]);return t}return{message:String(e)}},mr=(()=>{function e(e,t,n){const r=Wn(e+"/fulfilled",((e,t,n,r)=>({payload:e,meta:{...r||{},arg:n,requestId:t,requestStatus:"fulfilled"}}))),i=Wn(e+"/pending",((e,t,n)=>({payload:void 0,meta:{...n||{},arg:t,requestId:e,requestStatus:"pending"}}))),a=Wn(e+"/rejected",((e,t,r,i,a)=>({payload:i,error:(n&&n.serializeError||pr)(e||"Rejected"),meta:{...a||{},arg:r,requestId:t,rejectedWithValue:!!i,requestStatus:"rejected",aborted:"AbortError"===(null===e||void 0===e?void 0:e.name),condition:"ConditionError"===(null===e||void 0===e?void 0:e.name)}})));return Object.assign((function(e){return(o,s,l)=>{const c=null!==n&&void 0!==n&&n.idGenerator?n.idGenerator(e):tr(),d=new AbortController;let u,g;function f(e){g=e,d.abort()}const h=async function(){let h;try{var p,m;let a=null===n||void 0===n||null===(p=n.condition)||void 0===p?void 0:p.call(n,e,{getState:s,extra:l});if(null!==(v=a)&&"object"===typeof v&&"function"===typeof v.then&&(a=await a),!1===a||d.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const y=new Promise(((e,t)=>{u=()=>{t({name:"AbortError",message:g||"Aborted"})},d.signal.addEventListener("abort",u)}));o(i(c,e,null===n||void 0===n||null===(m=n.getPendingMeta)||void 0===m?void 0:m.call(n,{requestId:c,arg:e},{getState:s,extra:l}))),h=await Promise.race([y,Promise.resolve(t(e,{dispatch:o,getState:s,extra:l,requestId:c,signal:d.signal,abort:f,rejectWithValue:(e,t)=>new fr(e,t),fulfillWithValue:(e,t)=>new hr(e,t)})).then((t=>{if(t instanceof fr)throw t;return t instanceof hr?r(t.payload,c,e,t.meta):r(t,c,e)}))])}catch(y){h=y instanceof fr?a(null,c,e,y.payload,y.meta):a(y,c,e)}finally{u&&d.signal.removeEventListener("abort",u)}var v;return n&&!n.dispatchConditionRejection&&a.match(h)&&h.meta.condition||o(h),h}();return Object.assign(h,{abort:f,requestId:c,arg:e,unwrap:()=>h.then(vr)})}}),{pending:i,rejected:a,fulfilled:r,settled:rr(a,r),typePrefix:e})}return e.withTypes=()=>e,e})();function vr(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}var yr=Symbol.for("rtk-slice-createasyncthunk");function Cr(e,t){return"".concat(e,"/").concat(t)}function _r(e,t,n,r){function i(i){let a=t(i);"undefined"===typeof a&&r&&(a=n());for(var o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];return e(a,...s)}return i.unwrapped=e,i}var Sr=function(){var e;let{creators:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=null===t||void 0===t||null===(e=t.asyncThunk)||void 0===e?void 0:e[yr];return function(e){const{name:t,reducerPath:r=t}=e;if(!t)throw new Error(Nr(11));const i=("function"===typeof e.reducers?e.reducers(function(){function e(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name](){return e(...arguments)}}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},a=Object.keys(i),o={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},s={addCase(e,t){const n="string"===typeof e?e:e.type;if(!n)throw new Error(Nr(12));if(n in o.sliceCaseReducersByType)throw new Error(Nr(13));return o.sliceCaseReducersByType[n]=t,s},addMatcher:(e,t)=>(o.sliceMatchers.push({matcher:e,reducer:t}),s),exposeAction:(e,t)=>(o.actionCreators[e]=t,s),exposeCaseReducer:(e,t)=>(o.sliceCaseReducersByName[e]=t,s)};function l(){const[t={},n=[],r]="function"===typeof e.extraReducers?er(e.extraReducers):[e.extraReducers],i={...t,...o.sliceCaseReducersByType};return function(e,t){let n,[r,i,a]=er(t);if("function"===typeof e)n=()=>Qn(e());else{const t=Qn(e);n=()=>t}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n(),t=arguments.length>1?arguments[1]:void 0,o=[r[t.type],...i.filter((e=>{let{matcher:n}=e;return n(t)})).map((e=>{let{reducer:t}=e;return t}))];return 0===o.filter((e=>!!e)).length&&(o=[a]),o.reduce(((e,n)=>{if(n){if(jt(e)){const r=n(e,t);return void 0===r?e:r}if(Vt(e))return Rn(e,(e=>n(e,t)));{const r=n(e,t);if(void 0===r){if(null===e)return e;throw new Error(Nr(9))}return r}}return e}),e)}return o.getInitialState=n,o}(e.initialState,(e=>{for(let t in i)e.addCase(t,i[t]);for(let t of o.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);r&&e.addDefaultCase(r)}))}a.forEach((r=>{const a=i[r],o={reducerName:r,type:Cr(t,r),createNotation:"function"===typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(a)?function(e,t,n){let r,i,{type:a,reducerName:o,createNotation:s}=e;if("reducer"in t){if(s&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(t))throw new Error(Nr(17));r=t.reducer,i=t.prepare}else r=t;n.addCase(a,r).exposeCaseReducer(o,r).exposeAction(o,i?Wn(a,i):Wn(a))}(o,a,s):function(e,t,n,r){let{type:i,reducerName:a}=e;if(!r)throw new Error(Nr(18));const{payloadCreator:o,fulfilled:s,pending:l,rejected:c,settled:d,options:u}=t,g=r(i,o,u);n.exposeAction(a,g),s&&n.addCase(g.fulfilled,s);l&&n.addCase(g.pending,l);c&&n.addCase(g.rejected,c);d&&n.addMatcher(g.settled,d);n.exposeCaseReducer(a,{fulfilled:s||Er,pending:l||Er,rejected:c||Er,settled:d||Er})}(o,a,s,n)}));const c=e=>e,d=new Map;let u;function g(e,t){return u||(u=l()),u(e,t)}function f(){return u||(u=l()),u.getInitialState()}function h(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function r(e){let r=e[t];return"undefined"===typeof r&&n&&(r=f()),r}function i(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c;const r=Kn(d,n,{insert:()=>new WeakMap});return Kn(r,t,{insert:()=>{const r={};for(const[a,o]of Object.entries(null!==(i=e.selectors)&&void 0!==i?i:{})){var i;r[a]=_r(o,t,f,n)}return r}})}return{reducerPath:t,getSelectors:i,get selectors(){return i(r)},selectSlice:r}}const p={name:t,reducer:g,actions:o.actionCreators,caseReducers:o.sliceCaseReducersByName,getInitialState:f,...h(r),injectInto(e){let{reducerPath:t,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=null!==t&&void 0!==t?t:r;return e.inject({reducerPath:i,reducer:g},n),{...p,...h(i,!0)}}};return p}}();function Er(){}var br="listener",Mr="completed",wr="cancelled",Rr=("task-".concat(wr),"task-".concat(Mr),"".concat(br,"-").concat(wr),"".concat(br,"-").concat(Mr),(e,t)=>{if("function"!==typeof e)throw new Error(Nr(32))});var{assign:Lr}=Object,Tr="listenerMiddleware",Ir=e=>{let{type:t,actionCreator:n,matcher:r,predicate:i,effect:a}=e;if(t)i=Wn(t).match;else if(n)t=n.type,i=n.match;else if(r)i=r;else if(!i)throw new Error(Nr(21));return Rr(a),{predicate:i,type:t,effect:a}},Pr=Object.assign((e=>{const{type:t,predicate:n,effect:r}=Ir(e);return{id:tr(),effect:r,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(Nr(22))}}}),{withTypes:()=>Pr}),Or=Object.assign(Wn("".concat(Tr,"/add")),{withTypes:()=>Or}),Ar=(Wn("".concat(Tr,"/removeAll")),Object.assign(Wn("".concat(Tr,"/remove")),{withTypes:()=>Ar}));Symbol.for("rtk-state-proxy-original");function Nr(e){return"Minified Redux Toolkit error #".concat(e,"; visit https://redux-toolkit.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}var kr=(e=>(e.uninitialized="uninitialized",e.pending="pending",e.fulfilled="fulfilled",e.rejected="rejected",e))(kr||{});var Dr=e=>e.replace(/\/$/,""),xr=e=>e.replace(/^\//,"");function Fr(e,t){if(!e)return t;if(!t)return e;if(function(e){return new RegExp("(^|:)//").test(e)}(t))return t;const n=e.endsWith("/")||!t.startsWith("?")?"/":"";return e=Dr(e),t=xr(t),"".concat(e).concat(n).concat(t)}var jr=e=>[].concat(...e);var Vr=wt;function Ur(e,t){if(e===t||!(Vr(e)&&Vr(t)||Array.isArray(e)&&Array.isArray(t)))return t;const n=Object.keys(t),r=Object.keys(e);let i=n.length===r.length;const a=Array.isArray(t)?[]:{};for(const o of n)a[o]=Ur(e[o],t[o]),i&&(i=e[o]===a[o]);return i?e:a}var Gr=function(){return fetch(...arguments)},zr=e=>e.status>=200&&e.status<=299,Hr=e=>/ion\/(vnd\.api\+)?json/.test(e.get("content-type")||"");function qr(e){if(!wt(e))return e;const t={...e};for(const[n,r]of Object.entries(t))void 0===r&&delete t[n];return t}var Wr=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.value=e,this.meta=t}};var Br=Wn("__rtkq/focused"),Qr=Wn("__rtkq/unfocused"),Kr=Wn("__rtkq/online"),Jr=Wn("__rtkq/offline");function $r(e){return"query"===e.type}function Yr(e,t,n,r,i,a){return"function"===typeof e?e(t,n,r,i).map(Zr).map(a):Array.isArray(e)?e.map(Zr).map(a):[]}function Zr(e){return"string"===typeof e?{type:e}:e}function Xr(e){return null!=e}function ei(e){let t=0;for(const n in e)t++;return t}var ti=Symbol("forceQueryFn"),ni=e=>"function"===typeof e[ti];function ri(e){return e}function ii(e,t,n,r){return Yr(n[e.meta.arg.endpointName][t],dr(e)?e.payload:void 0,cr(e)?e.payload:void 0,e.meta.arg.originalArgs,"baseQueryMeta"in e.meta?e.meta.baseQueryMeta:void 0,r)}function ai(e,t,n){const r=e[t];r&&n(r)}function oi(e){var t;return null!==(t="arg"in e?e.arg.fixedCacheKey:e.fixedCacheKey)&&void 0!==t?t:e.requestId}function si(e,t,n){const r=e[oi(t)];r&&n(r)}var li={};function ci(e){let{reducerPath:t,queryThunk:n,mutationThunk:r,context:{endpointDefinitions:i,apiUid:a,extractRehydrationInfo:o,hasRehydrationInfo:s},assertTagType:l,config:c}=e;const d=Wn("".concat(t,"/resetApiState")),u=Sr({name:"".concat(t,"/queries"),initialState:li,reducers:{removeQueryResult:{reducer(e,t){let{payload:{queryCacheKey:n}}=t;delete e[n]},prepare:$n()},queryResultPatched:{reducer(e,t){let{payload:{queryCacheKey:n,patches:r}}=t;ai(e,n,(e=>{e.data=Tn(e.data,r.concat())}))},prepare:$n()}},extraReducers(e){e.addCase(n.pending,((e,t)=>{var n,r;let{meta:i,meta:{arg:a}}=t;const o=ni(a);null!==(r=e[n=a.queryCacheKey])&&void 0!==r||(e[n]={status:"uninitialized",endpointName:a.endpointName}),ai(e,a.queryCacheKey,(e=>{e.status="pending",e.requestId=o&&e.requestId?e.requestId:i.requestId,void 0!==a.originalArgs&&(e.originalArgs=a.originalArgs),e.startedTimeStamp=i.startedTimeStamp}))})).addCase(n.fulfilled,((e,t)=>{let{meta:n,payload:r}=t;ai(e,n.arg.queryCacheKey,(e=>{if(e.requestId!==n.requestId&&!ni(n.arg))return;const{merge:t}=i[n.arg.endpointName];var a,o;if(e.status="fulfilled",t)if(void 0!==e.data){const{fulfilledTimeStamp:i,arg:a,baseQueryMeta:o,requestId:s}=n;let l=Rn(e.data,(e=>t(e,r,{arg:a.originalArgs,baseQueryMeta:o,fulfilledTimeStamp:i,requestId:s})));e.data=l}else e.data=r;else e.data=null===(a=i[n.arg.endpointName].structuralSharing)||void 0===a||a?Ur(jt(e.data)?(jt(o=e.data)||xt(15),o[Dt].base_):e.data,r):r;delete e.error,e.fulfilledTimeStamp=n.fulfilledTimeStamp}))})).addCase(n.rejected,((e,t)=>{let{meta:{condition:n,arg:r,requestId:i},error:a,payload:o}=t;ai(e,r.queryCacheKey,(e=>{if(n);else{if(e.requestId!==i)return;e.status="rejected",e.error=null!==o&&void 0!==o?o:a}}))})).addMatcher(s,((e,t)=>{const{queries:n}=o(t);for(const[r,i]of Object.entries(n))"fulfilled"!==(null===i||void 0===i?void 0:i.status)&&"rejected"!==(null===i||void 0===i?void 0:i.status)||(e[r]=i)}))}}),g=Sr({name:"".concat(t,"/mutations"),initialState:li,reducers:{removeMutationResult:{reducer(e,t){let{payload:n}=t;const r=oi(n);r in e&&delete e[r]},prepare:$n()}},extraReducers(e){e.addCase(r.pending,((e,t)=>{let{meta:n,meta:{requestId:r,arg:i,startedTimeStamp:a}}=t;i.track&&(e[oi(n)]={requestId:r,status:"pending",endpointName:i.endpointName,startedTimeStamp:a})})).addCase(r.fulfilled,((e,t)=>{let{payload:n,meta:r}=t;r.arg.track&&si(e,r,(e=>{e.requestId===r.requestId&&(e.status="fulfilled",e.data=n,e.fulfilledTimeStamp=r.fulfilledTimeStamp)}))})).addCase(r.rejected,((e,t)=>{let{payload:n,error:r,meta:i}=t;i.arg.track&&si(e,i,(e=>{e.requestId===i.requestId&&(e.status="rejected",e.error=null!==n&&void 0!==n?n:r)}))})).addMatcher(s,((e,t)=>{const{mutations:n}=o(t);for(const[r,i]of Object.entries(n))"fulfilled"!==(null===i||void 0===i?void 0:i.status)&&"rejected"!==(null===i||void 0===i?void 0:i.status)||r===(null===i||void 0===i?void 0:i.requestId)||(e[r]=i)}))}}),f=Sr({name:"".concat(t,"/invalidation"),initialState:li,reducers:{updateProvidedBy:{reducer(e,t){const{queryCacheKey:n,providedTags:r}=t.payload;for(const l of Object.values(e))for(const e of Object.values(l)){const t=e.indexOf(n);-1!==t&&e.splice(t,1)}for(const{type:l,id:c}of r){var i,a,o,s;const t=null!==(o=(i=null!==(s=e[l])&&void 0!==s?s:e[l]={})[a=c||"__internal_without_id"])&&void 0!==o?o:i[a]=[];t.includes(n)||t.push(n)}},prepare:$n()}},extraReducers(e){e.addCase(u.actions.removeQueryResult,((e,t)=>{let{payload:{queryCacheKey:n}}=t;for(const r of Object.values(e))for(const e of Object.values(r)){const t=e.indexOf(n);-1!==t&&e.splice(t,1)}})).addMatcher(s,((e,t)=>{const{provided:n}=o(t);for(const[o,l]of Object.entries(n))for(const[t,n]of Object.entries(l)){var r,i,a,s;const l=null!==(a=(r=null!==(s=e[o])&&void 0!==s?s:e[o]={})[i=t||"__internal_without_id"])&&void 0!==a?a:r[i]=[];for(const e of n){l.includes(e)||l.push(e)}}})).addMatcher(rr(dr(n),cr(n)),((e,t)=>{const n=ii(t,"providesTags",i,l),{queryCacheKey:r}=t.meta.arg;f.caseReducers.updateProvidedBy(e,f.actions.updateProvidedBy({queryCacheKey:r,providedTags:n}))}))}}),h=Sr({name:"".concat(t,"/subscriptions"),initialState:li,reducers:{updateSubscriptionOptions(e,t){},unsubscribeQueryResult(e,t){},internal_getRTKQSubscriptions(){}}}),p=Sr({name:"".concat(t,"/internalSubscriptions"),initialState:li,reducers:{subscriptionsUpdated:{reducer:(e,t)=>Tn(e,t.payload),prepare:$n()}}}),m=Sr({name:"".concat(t,"/config"),initialState:{online:"undefined"===typeof navigator||void 0===navigator.onLine||navigator.onLine,focused:"undefined"===typeof document||"hidden"!==document.visibilityState,middlewareRegistered:!1,...c},reducers:{middlewareRegistered(e,t){let{payload:n}=t;e.middlewareRegistered="conflict"!==e.middlewareRegistered&&a===n||"conflict"}},extraReducers:e=>{e.addCase(Kr,(e=>{e.online=!0})).addCase(Jr,(e=>{e.online=!1})).addCase(Br,(e=>{e.focused=!0})).addCase(Qr,(e=>{e.focused=!1})).addMatcher(s,(e=>({...e})))}}),v=Lt({queries:u.reducer,mutations:g.reducer,provided:f.reducer,subscriptions:p.reducer,config:m.reducer});return{reducer:(e,t)=>v(d.match(t)?void 0:e,t),actions:{...m.actions,...u.actions,...h.actions,...p.actions,...g.actions,...f.actions,resetApiState:d}}}var di=Symbol.for("RTKQ/skipToken"),ui={status:"uninitialized"},gi=Rn(ui,(()=>{})),fi=Rn(ui,(()=>{}));var hi=WeakMap?new WeakMap:void 0,pi=e=>{let{endpointName:t,queryArgs:n}=e,r="";const i=null===hi||void 0===hi?void 0:hi.get(n);if("string"===typeof i)r=i;else{const e=JSON.stringify(n,((e,t)=>wt(t)?Object.keys(t).sort().reduce(((e,n)=>(e[n]=t[n],e)),{}):t));wt(n)&&(null===hi||void 0===hi||hi.set(n,e)),r=e}return"".concat(t,"(").concat(r,")")};function mi(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){const n=xn((t=>{var n,r;return null===(n=e.extractRehydrationInfo)||void 0===n?void 0:n.call(e,t,{reducerPath:null!==(r=e.reducerPath)&&void 0!==r?r:"api"})})),r={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...e,extractRehydrationInfo:n,serializeQueryArgs(t){let n=pi;if("serializeQueryArgs"in t.endpointDefinition){const e=t.endpointDefinition.serializeQueryArgs;n=t=>{const n=e(t);return"string"===typeof n?n:pi({...t,queryArgs:n})}}else e.serializeQueryArgs&&(n=e.serializeQueryArgs);return n(t)},tagTypes:[...e.tagTypes||[]]},i={endpointDefinitions:{},batch(e){e()},apiUid:tr(),extractRehydrationInfo:n,hasRehydrationInfo:xn((e=>null!=n(e)))},a={injectEndpoints:function(e){const t=e.endpoints({query:e=>({...e,type:"query"}),mutation:e=>({...e,type:"mutation"})});for(const[n,r]of Object.entries(t))if(e.overrideExisting||!(n in i.endpointDefinitions)){i.endpointDefinitions[n]=r;for(const e of o)e.injectEndpoint(n,r)}return a},enhanceEndpoints(e){let{addTagTypes:t,endpoints:n}=e;if(t)for(const i of t)r.tagTypes.includes(i)||r.tagTypes.push(i);if(n)for(const[r,a]of Object.entries(n))"function"===typeof a?a(i.endpointDefinitions[r]):Object.assign(i.endpointDefinitions[r]||{},a);return a}},o=t.map((e=>e.init(a,r,i)));return a.injectEndpoints({endpoints:e.endpoints})}}var vi=e=>{let{reducerPath:t,api:n,context:r,internalState:i}=e;const{removeQueryResult:a,unsubscribeQueryResult:o}=n.internalActions;function s(e){const t=i.currentSubscriptions[e];return!!t&&!function(e){for(let t in e)return!1;return!0}(t)}const l={};function c(e,t,n,i){var o;const c=r.endpointDefinitions[t],d=null!==(o=null===c||void 0===c?void 0:c.keepUnusedDataFor)&&void 0!==o?o:i.keepUnusedDataFor;if(d===1/0)return;const u=Math.max(0,Math.min(d,2147482.647));if(!s(e)){const t=l[e];t&&clearTimeout(t),l[e]=setTimeout((()=>{s(e)||n.dispatch(a({queryCacheKey:e})),delete l[e]}),1e3*u)}}return(e,i,a)=>{if(o.match(e)){var s;const n=i.getState()[t],{queryCacheKey:r}=e.payload;c(r,null===(s=n.queries[r])||void 0===s?void 0:s.endpointName,i,n.config)}if(n.util.resetApiState.match(e))for(const[t,n]of Object.entries(l))n&&clearTimeout(n),delete l[t];if(r.hasRehydrationInfo(e)){const n=i.getState()[t],{queries:a}=r.extractRehydrationInfo(e);for(const[e,t]of Object.entries(a))c(e,null===t||void 0===t?void 0:t.endpointName,i,n.config)}}},yi=e=>{let{reducerPath:t,context:n,context:{endpointDefinitions:r},mutationThunk:i,queryThunk:a,api:o,assertTagType:s,refetchQuery:l,internalState:c}=e;const{removeQueryResult:d}=o.internalActions,u=rr(dr(i),cr(i)),g=rr(dr(i,a),lr(i,a));let f=[];function h(e,r){const i=r.getState(),a=i[t];if(f.push(...e),"delayed"===a.config.invalidationBehavior&&function(e){for(const r in e.queries){var t;if("pending"===(null===(t=e.queries[r])||void 0===t?void 0:t.status))return!0}for(const r in e.mutations){var n;if("pending"===(null===(n=e.mutations[r])||void 0===n?void 0:n.status))return!0}return!1}(a))return;const s=f;if(f=[],0===s.length)return;const u=o.util.selectInvalidatedBy(i,s);n.batch((()=>{const e=Array.from(u.values());for(const{queryCacheKey:n}of e){var t;const e=a.queries[n],i=null!==(t=c.currentSubscriptions[n])&&void 0!==t?t:{};e&&(0===ei(i)?r.dispatch(d({queryCacheKey:n})):"uninitialized"!==e.status&&r.dispatch(l(e,n)))}}))}return(e,t)=>{u(e)?h(ii(e,"invalidatesTags",r,s),t):g(e)?h([],t):o.util.invalidateTags.match(e)&&h(Yr(e.payload,void 0,void 0,void 0,void 0,s),t)}},Ci=e=>{let{reducerPath:t,queryThunk:n,api:r,refetchQuery:i,internalState:a}=e;const o={};function s(e,n){let{queryCacheKey:r}=e;const l=n.getState()[t],c=l.queries[r],u=a.currentSubscriptions[r];if(!c||"uninitialized"===c.status)return;const{lowestPollingInterval:g,skipPollingIfUnfocused:f}=d(u);if(!Number.isFinite(g))return;const h=o[r];null!==h&&void 0!==h&&h.timeout&&(clearTimeout(h.timeout),h.timeout=void 0);const p=Date.now()+g;o[r]={nextPollTimestamp:p,pollingInterval:g,timeout:setTimeout((()=>{!l.config.focused&&f||n.dispatch(i(c,r)),s({queryCacheKey:r},n)}),g)}}function l(e,n){let{queryCacheKey:r}=e;const i=n.getState()[t].queries[r],l=a.currentSubscriptions[r];if(!i||"uninitialized"===i.status)return;const{lowestPollingInterval:u}=d(l);if(!Number.isFinite(u))return void c(r);const g=o[r],f=Date.now()+u;(!g||f<g.nextPollTimestamp)&&s({queryCacheKey:r},n)}function c(e){const t=o[e];null!==t&&void 0!==t&&t.timeout&&clearTimeout(t.timeout),delete o[e]}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!1,n=Number.POSITIVE_INFINITY;for(let r in e)e[r].pollingInterval&&(n=Math.min(e[r].pollingInterval,n),t=e[r].skipPollingIfUnfocused||t);return{lowestPollingInterval:n,skipPollingIfUnfocused:t}}return(e,t)=>{(r.internalActions.updateSubscriptionOptions.match(e)||r.internalActions.unsubscribeQueryResult.match(e))&&l(e.payload,t),(n.pending.match(e)||n.rejected.match(e)&&e.meta.condition)&&l(e.meta.arg,t),(n.fulfilled.match(e)||n.rejected.match(e)&&!e.meta.condition)&&s(e.meta.arg,t),r.util.resetApiState.match(e)&&function(){for(const e of Object.keys(o))c(e)}()}},_i=new Error("Promise never resolved before cacheEntryRemoved."),Si=e=>{let{api:t,reducerPath:n,context:r,queryThunk:i,mutationThunk:a,internalState:o}=e;const s=ur(i),l=ur(a),c=dr(i,a),d={};function u(e,n,i,a,o){const s=r.endpointDefinitions[e],l=null===s||void 0===s?void 0:s.onCacheEntryAdded;if(!l)return;let c={};const u=new Promise((e=>{c.cacheEntryRemoved=e})),g=Promise.race([new Promise((e=>{c.valueResolved=e})),u.then((()=>{throw _i}))]);g.catch((()=>{})),d[i]=c;const f=t.endpoints[e].select("query"===s.type?n:i),h=a.dispatch(((e,t,n)=>n)),p={...a,getCacheEntry:()=>f(a.getState()),requestId:o,extra:h,updateCachedData:"query"===s.type?r=>a.dispatch(t.util.updateQueryData(e,n,r)):void 0,cacheDataLoaded:g,cacheEntryRemoved:u},m=l(n,p);Promise.resolve(m).catch((e=>{if(e!==_i)throw e}))}return(e,r,o)=>{const g=function(e){return s(e)?e.meta.arg.queryCacheKey:l(e)?null!==(n=e.meta.arg.fixedCacheKey)&&void 0!==n?n:e.meta.requestId:t.internalActions.removeQueryResult.match(e)?e.payload.queryCacheKey:t.internalActions.removeMutationResult.match(e)?oi(e.payload):"";var n}(e);if(i.pending.match(e)){const t=o[n].queries[g],i=r.getState()[n].queries[g];!t&&i&&u(e.meta.arg.endpointName,e.meta.arg.originalArgs,g,r,e.meta.requestId)}else if(a.pending.match(e)){r.getState()[n].mutations[g]&&u(e.meta.arg.endpointName,e.meta.arg.originalArgs,g,r,e.meta.requestId)}else if(c(e)){const t=d[g];null!==t&&void 0!==t&&t.valueResolved&&(t.valueResolved({data:e.payload,meta:e.meta.baseQueryMeta}),delete t.valueResolved)}else if(t.internalActions.removeQueryResult.match(e)||t.internalActions.removeMutationResult.match(e)){const e=d[g];e&&(delete d[g],e.cacheEntryRemoved())}else if(t.util.resetApiState.match(e))for(const[t,n]of Object.entries(d))delete d[t],n.cacheEntryRemoved()}},Ei=e=>{let{api:t,context:n,queryThunk:r,mutationThunk:i}=e;const a=sr(r,i),o=lr(r,i),s=dr(r,i),l={};return(e,r)=>{if(a(e)){const{requestId:i,arg:{endpointName:a,originalArgs:o}}=e.meta,s=n.endpointDefinitions[a],c=null===s||void 0===s?void 0:s.onQueryStarted;if(c){const e={},n=new Promise(((t,n)=>{e.resolve=t,e.reject=n}));n.catch((()=>{})),l[i]=e;const d=t.endpoints[a].select("query"===s.type?o:i),u=r.dispatch(((e,t,n)=>n)),g={...r,getCacheEntry:()=>d(r.getState()),requestId:i,extra:u,updateCachedData:"query"===s.type?e=>r.dispatch(t.util.updateQueryData(a,o,e)):void 0,queryFulfilled:n};c(o,g)}}else if(s(e)){var i;const{requestId:t,baseQueryMeta:n}=e.meta;null===(i=l[t])||void 0===i||i.resolve({data:e.payload,meta:n}),delete l[t]}else if(o(e)){var c,d;const{requestId:t,rejectedWithValue:n,baseQueryMeta:r}=e.meta;null===(c=l[t])||void 0===c||c.reject({error:null!==(d=e.payload)&&void 0!==d?d:e.error,isUnhandledError:!n,meta:r}),delete l[t]}}},bi=e=>{let{api:t,context:{apiUid:n},reducerPath:r}=e;return(e,r)=>{t.util.resetApiState.match(e)&&r.dispatch(t.internalActions.middlewareRegistered(n))}},Mi=e=>{let{api:t,queryThunk:n,internalState:r}=e;const i="".concat(t.reducerPath,"/subscriptions");let a=null,o=null;const{updateSubscriptionOptions:s,unsubscribeQueryResult:l}=t.internalActions,c=()=>r.currentSubscriptions,d={getSubscriptions:c,getSubscriptionCount:e=>{var t;return ei(null!==(t=c()[e])&&void 0!==t?t:{})},isRequestSubscribed:(e,t)=>{var n;const r=c();return!(null===r||void 0===r||null===(n=r[e])||void 0===n||!n[t])}};return(e,c)=>{if(a||(a=JSON.parse(JSON.stringify(r.currentSubscriptions))),t.util.resetApiState.match(e))return a=r.currentSubscriptions={},o=null,[!0,!1];if(t.internalActions.internal_getRTKQSubscriptions.match(e))return[!1,d];const u=((e,r)=>{if(s.match(r)){var i;const{queryCacheKey:t,requestId:n,options:a}=r.payload;return null!==e&&void 0!==e&&null!==(i=e[t])&&void 0!==i&&i[n]&&(e[t][n]=a),!0}if(l.match(r)){const{queryCacheKey:t,requestId:n}=r.payload;return e[t]&&delete e[t][n],!0}if(t.internalActions.removeQueryResult.match(r))return delete e[r.payload.queryCacheKey],!0;if(n.pending.match(r)){var a,o;const{meta:{arg:t,requestId:n}}=r,i=null!==(o=e[a=t.queryCacheKey])&&void 0!==o?o:e[a]={};var c,d;return i["".concat(n,"_running")]={},t.subscribe&&(i[n]=null!==(c=null!==(d=t.subscriptionOptions)&&void 0!==d?d:i[n])&&void 0!==c?c:{}),!0}let u=!1;if(n.fulfilled.match(r)||n.rejected.match(r)){const t=e[r.meta.arg.queryCacheKey]||{},n="".concat(r.meta.requestId,"_running");u||(u=!!t[n]),delete t[n]}if(n.rejected.match(r)){const{meta:{condition:t,arg:n,requestId:i}}=r;if(t&&n.subscribe){var g,f,h,p;const t=null!==(f=e[g=n.queryCacheKey])&&void 0!==f?f:e[g]={};t[i]=null!==(h=null!==(p=n.subscriptionOptions)&&void 0!==p?p:t[i])&&void 0!==h?h:{},u=!0}}return u})(r.currentSubscriptions,e);let g=!0;if(u){o||(o=setTimeout((()=>{const e=JSON.parse(JSON.stringify(r.currentSubscriptions)),[,n]=Ln(a,(()=>e));c.next(t.internalActions.subscriptionsUpdated(n)),a=e,o=null}),500));const s="string"==typeof e.type&&!!e.type.startsWith(i),l=n.rejected.match(e)&&e.meta.condition&&!!e.meta.arg.subscribe;g=!s&&!l}return[g,!1]}};function wi(e){const{reducerPath:t,queryThunk:n,api:r,context:i}=e,{apiUid:a}=i,o={invalidateTags:Wn("".concat(t,"/invalidateTags"))},s=e=>e.type.startsWith("".concat(t,"/")),l=[bi,vi,yi,Ci,Si,Ei];return{middleware:n=>{let o=!1;const d={...e,internalState:{currentSubscriptions:{}},refetchQuery:c,isThisApiSliceAction:s},u=l.map((e=>e(d))),g=Mi(d),f=(e=>{let{reducerPath:t,context:n,api:r,refetchQuery:i,internalState:a}=e;const{removeQueryResult:o}=r.internalActions;function s(e,r){const s=e.getState()[t],l=s.queries,c=a.currentSubscriptions;n.batch((()=>{for(const t of Object.keys(c)){const n=l[t],a=c[t];a&&n&&((Object.values(a).some((e=>!0===e[r]))||Object.values(a).every((e=>void 0===e[r]))&&s.config[r])&&(0===ei(a)?e.dispatch(o({queryCacheKey:t})):"uninitialized"!==n.status&&e.dispatch(i(n,t))))}}))}return(e,t)=>{Br.match(e)&&s(t,"refetchOnFocus"),Kr.match(e)&&s(t,"refetchOnReconnect")}})(d);return e=>l=>{if(!It(l))return e(l);o||(o=!0,n.dispatch(r.internalActions.middlewareRegistered(a)));const c={...n,next:e},d=n.getState(),[h,p]=g(l,c,d);let m;if(m=h?e(l):p,n.getState()[t]&&(f(l,c,d),s(l)||i.hasRehydrationInfo(l)))for(let e of u)e(l,c,d);return m}},actions:o};function c(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n({type:"query",endpointName:e.endpointName,originalArgs:e.originalArgs,subscribe:!1,forceRefetch:!0,queryCacheKey:t,...r})}}function Ri(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Object.assign(e,...n)}var Li=Symbol(),Ti=function(){let{createSelector:e=jn}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:Li,init(t,n,r){let{baseQuery:i,tagTypes:a,reducerPath:o,serializeQueryArgs:s,keepUnusedDataFor:l,refetchOnMountOrArgChange:c,refetchOnFocus:d,refetchOnReconnect:u,invalidationBehavior:g}=n;Mn();const f=e=>e;Object.assign(t,{reducerPath:o,endpoints:{},internalActions:{onOnline:Kr,onOffline:Jr,onFocus:Br,onFocusLost:Qr},util:{}});const{queryThunk:h,mutationThunk:p,patchQueryData:m,updateQueryData:v,upsertQueryData:y,prefetch:C,buildMatchThunkActions:_}=function(e){let{reducerPath:t,baseQuery:n,context:{endpointDefinitions:r},serializeQueryArgs:i,api:a,assertTagType:o}=e;const s=async(e,t)=>{let{signal:i,abort:a,rejectWithValue:o,fulfillWithValue:s,dispatch:c,getState:d,extra:u}=t;const g=r[e.endpointName];try{let t,r=ri;const o={signal:i,abort:a,dispatch:c,getState:d,extra:u,endpoint:e.endpointName,type:e.type,forced:"query"===e.type?l(e,d()):void 0},f="query"===e.type?e[ti]:void 0;if(f?t=f():g.query?(t=await n(g.query(e.originalArgs),o,g.extraOptions),g.transformResponse&&(r=g.transformResponse)):t=await g.queryFn(e.originalArgs,o,g.extraOptions,(e=>n(e,o,g.extraOptions))),t.error)throw new Wr(t.error,t.meta);return s(await r(t.data,t.meta,e.originalArgs),{fulfilledTimeStamp:Date.now(),baseQueryMeta:t.meta,[Jn]:!0})}catch(f){let t=f;if(t instanceof Wr){let n=ri;g.query&&g.transformErrorResponse&&(n=g.transformErrorResponse);try{return o(await n(t.value,t.meta,e.originalArgs),{baseQueryMeta:t.meta,[Jn]:!0})}catch(h){t=h}}throw console.error(t),t}};function l(e,n){var r,i,a;const o=null===(r=n[t])||void 0===r||null===(r=r.queries)||void 0===r?void 0:r[e.queryCacheKey],s=null===(i=n[t])||void 0===i?void 0:i.config.refetchOnMountOrArgChange,l=null===o||void 0===o?void 0:o.fulfilledTimeStamp,c=null!==(a=e.forceRefetch)&&void 0!==a?a:e.subscribe&&s;return!!c&&(!0===c||(Number(new Date)-Number(l))/1e3>=c)}const c=mr("".concat(t,"/executeQuery"),s,{getPendingMeta:()=>({startedTimeStamp:Date.now(),[Jn]:!0}),condition(e,n){var i,a;let{getState:o}=n;const s=o(),c=null===(i=s[t])||void 0===i||null===(i=i.queries)||void 0===i?void 0:i[e.queryCacheKey],d=null===c||void 0===c?void 0:c.fulfilledTimeStamp,u=e.originalArgs,g=null===c||void 0===c?void 0:c.originalArgs,f=r[e.endpointName];return!!ni(e)||"pending"!==(null===c||void 0===c?void 0:c.status)&&(!!l(e,s)||!(!$r(f)||null===f||void 0===f||null===(a=f.forceRefetch)||void 0===a||!a.call(f,{currentArg:u,previousArg:g,endpointState:c,state:s}))||!d)},dispatchConditionRejection:!0}),d=mr("".concat(t,"/executeMutation"),s,{getPendingMeta:()=>({startedTimeStamp:Date.now(),[Jn]:!0})});function u(e){return t=>{var n;return(null===t||void 0===t||null===(n=t.meta)||void 0===n||null===(n=n.arg)||void 0===n?void 0:n.endpointName)===e}}return{queryThunk:c,mutationThunk:d,prefetch:(e,t,n)=>(r,i)=>{const o=(e=>"force"in e)(n)&&n.force,s=(e=>"ifOlderThan"in e)(n)&&n.ifOlderThan,l=function(){let n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return a.endpoints[e].initiate(t,{forceRefetch:n})},c=a.endpoints[e].select(t)(i());if(o)r(l());else if(s){const e=null===c||void 0===c?void 0:c.fulfilledTimeStamp;if(!e)return void r(l());(Number(new Date)-Number(new Date(e)))/1e3>=s&&r(l())}else r(l(!1))},updateQueryData:function(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(i,o)=>{const s=a.endpoints[e].select(t)(o());let l,c={patches:[],inversePatches:[],undo:()=>i(a.util.patchQueryData(e,t,c.inversePatches,r))};if("uninitialized"===s.status)return c;if("data"in s)if(Vt(s.data)){const[e,t,r]=Ln(s.data,n);c.patches.push(...t),c.inversePatches.push(...r),l=e}else l=n(s.data),c.patches.push({op:"replace",path:[],value:l}),c.inversePatches.push({op:"replace",path:[],value:s.data});return i(a.util.patchQueryData(e,t,c.patches,r)),c}},upsertQueryData:(e,t,n)=>r=>r(a.endpoints[e].initiate(t,{subscribe:!1,forceRefetch:!0,[ti]:()=>({data:n})})),patchQueryData:(e,t,n,s)=>(l,c)=>{const d=r[e],u=i({queryArgs:t,endpointDefinition:d,endpointName:e});if(l(a.internalActions.queryResultPatched({queryCacheKey:u,patches:n})),!s)return;const g=a.endpoints[e].select(t)(c()),f=Yr(d.providesTags,g.data,void 0,t,{},o);l(a.internalActions.updateProvidedBy({queryCacheKey:u,providedTags:f}))},buildMatchThunkActions:function(e,t){return{matchPending:ir(sr(e),u(t)),matchFulfilled:ir(dr(e),u(t)),matchRejected:ir(lr(e),u(t))}}}}({baseQuery:i,reducerPath:o,context:r,api:t,serializeQueryArgs:s,assertTagType:f}),{reducer:S,actions:E}=ci({context:r,queryThunk:h,mutationThunk:p,reducerPath:o,assertTagType:f,config:{refetchOnFocus:d,refetchOnReconnect:u,refetchOnMountOrArgChange:c,keepUnusedDataFor:l,reducerPath:o,invalidationBehavior:g}});Ri(t.util,{patchQueryData:m,updateQueryData:v,upsertQueryData:y,prefetch:C,resetApiState:E.resetApiState}),Ri(t.internalActions,E);const{middleware:b,actions:M}=wi({reducerPath:o,context:r,queryThunk:h,mutationThunk:p,api:t,assertTagType:f});Ri(t.util,M),Ri(t,{reducer:S,middleware:b});const{buildQuerySelector:w,buildMutationSelector:R,selectInvalidatedBy:L,selectCachedArgsForQuery:T}=function(e){let{serializeQueryArgs:t,reducerPath:n,createSelector:r}=e;const i=e=>gi,a=e=>fi;return{buildQuerySelector:function(e,n){return a=>{const l=t({queryArgs:a,endpointDefinition:n,endpointName:e});return r(a===di?i:e=>{var t,n;return null!==(t=null===(n=s(e))||void 0===n||null===(n=n.queries)||void 0===n?void 0:n[l])&&void 0!==t?t:gi},o)}},buildMutationSelector:function(){return e=>{let t;var n;return t="object"===typeof e?null!==(n=oi(e))&&void 0!==n?n:di:e,r(t===di?a:e=>{var n,r;return null!==(n=null===(r=s(e))||void 0===r||null===(r=r.mutations)||void 0===r?void 0:r[t])&&void 0!==n?n:fi},o)}},selectInvalidatedBy:function(e,t){const r=e[n],i=new Set;for(const n of t.map(Zr)){var a;const e=r.provided[n.type];if(!e)continue;let t=null!==(a=void 0!==n.id?e[n.id]:jr(Object.values(e)))&&void 0!==a?a:[];for(const n of t)i.add(n)}return jr(Array.from(i.values()).map((e=>{const t=r.queries[e];return t?[{queryCacheKey:e,endpointName:t.endpointName,originalArgs:t.originalArgs}]:[]})))},selectCachedArgsForQuery:function(e,t){return Object.values(e[n].queries).filter((e=>(null===e||void 0===e?void 0:e.endpointName)===t&&"uninitialized"!==e.status)).map((e=>e.originalArgs))}};function o(e){return{...e,...(t=e.status,{status:t,isUninitialized:"uninitialized"===t,isLoading:"pending"===t,isSuccess:"fulfilled"===t,isError:"rejected"===t})};var t}function s(e){return e[n]}}({serializeQueryArgs:s,reducerPath:o,createSelector:e});Ri(t.util,{selectInvalidatedBy:L,selectCachedArgsForQuery:T});const{buildInitiateQuery:I,buildInitiateMutation:P,getRunningMutationThunk:O,getRunningMutationsThunk:A,getRunningQueriesThunk:N,getRunningQueryThunk:k}=function(e){let{serializeQueryArgs:t,queryThunk:n,mutationThunk:r,api:i,context:a}=e;const o=new Map,s=new Map,{unsubscribeQueryResult:l,removeMutationResult:c,updateSubscriptionOptions:d}=i.internalActions;return{buildInitiateQuery:function(e,r){const a=function(s){let{subscribe:c=!0,forceRefetch:g,subscriptionOptions:f,[ti]:h}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(p,m)=>{var v;const y=t({queryArgs:s,endpointDefinition:r,endpointName:e}),C=n({type:"query",subscribe:c,forceRefetch:g,subscriptionOptions:f,endpointName:e,originalArgs:s,queryCacheKey:y,[ti]:h}),_=i.endpoints[e].select(s),S=p(C),E=_(m());u(p);const{requestId:b,abort:M}=S,w=E.requestId!==b,R=null===(v=o.get(p))||void 0===v?void 0:v[y],L=()=>_(m()),T=Object.assign(h?S.then(L):w&&!R?Promise.resolve(E):Promise.all([R,S]).then(L),{arg:s,requestId:b,subscriptionOptions:f,queryCacheKey:y,abort:M,async unwrap(){const e=await T;if(e.isError)throw e.error;return e.data},refetch:()=>p(a(s,{subscribe:!1,forceRefetch:!0})),unsubscribe(){c&&p(l({queryCacheKey:y,requestId:b}))},updateSubscriptionOptions(t){T.subscriptionOptions=t,p(d({endpointName:e,requestId:b,queryCacheKey:y,options:t}))}});if(!R&&!w&&!h){const e=o.get(p)||{};e[y]=T,o.set(p,e),T.then((()=>{delete e[y],ei(e)||o.delete(p)}))}return T}};return a},buildInitiateMutation:function(e){return function(t){let{track:n=!0,fixedCacheKey:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(a,o)=>{const l=r({type:"mutation",endpointName:e,originalArgs:t,track:n,fixedCacheKey:i}),d=a(l);u(a);const{requestId:g,abort:f,unwrap:h}=d,p=(m=e=>({error:e}),d.unwrap().then((e=>({data:e}))).catch(m));var m;const v=Object.assign(p,{arg:d.arg,requestId:g,abort:f,unwrap:h,reset:()=>{a(c({requestId:g,fixedCacheKey:i}))}}),y=s.get(a)||{};return s.set(a,y),y[g]=v,v.then((()=>{delete y[g],ei(y)||s.delete(a)})),i&&(y[i]=v,v.then((()=>{y[i]===v&&(delete y[i],ei(y)||s.delete(a))}))),v}}},getRunningQueryThunk:function(e,n){return r=>{var i;const s=a.endpointDefinitions[e],l=t({queryArgs:n,endpointDefinition:s,endpointName:e});return null===(i=o.get(r))||void 0===i?void 0:i[l]}},getRunningMutationThunk:function(e,t){return e=>{var n;return null===(n=s.get(e))||void 0===n?void 0:n[t]}},getRunningQueriesThunk:function(){return e=>Object.values(o.get(e)||{}).filter(Xr)},getRunningMutationsThunk:function(){return e=>Object.values(s.get(e)||{}).filter(Xr)}};function u(e){}}({queryThunk:h,mutationThunk:p,api:t,serializeQueryArgs:s,context:r});return Ri(t.util,{getRunningMutationThunk:O,getRunningMutationsThunk:A,getRunningQueryThunk:k,getRunningQueriesThunk:N}),{name:Li,injectEndpoint(e,n){var r,i;const a=t;null!==(i=(r=a.endpoints)[e])&&void 0!==i||(r[e]={}),$r(n)?Ri(a.endpoints[e],{name:e,select:w(e,n),initiate:I(e,n)},_(h,e)):"mutation"===n.type&&Ri(a.endpoints[e],{name:e,select:R(),initiate:P(e)},_(p,e))}}}}},Ii=(Ti(),n(995)),Pi=e,Oi=Symbol.for("react-redux-context"),Ai="undefined"!==typeof globalThis?globalThis:{};function Ni(){var e;if(!Pi.createContext)return{};const t=null!==(e=Ai[Oi])&&void 0!==e?e:Ai[Oi]=new Map;let n=t.get(Pi.createContext);return n||(n=Pi.createContext(null),t.set(Pi.createContext,n)),n}var ki=Ni(),Di=()=>{throw new Error("uSES not initialized!")};function xi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ki;return function(){return Pi.useContext(e)}}var Fi=xi(),ji=Di,Vi=(e,t)=>e===t;function Ui(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ki;const t=e===ki?Fi:xi(e),n=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{equalityFn:r=Vi,devModeChecks:i={}}="function"===typeof n?{equalityFn:n}:n;const{store:a,subscription:o,getServerState:s,stabilityCheck:l,identityFunctionCheck:c}=t(),d=(Pi.useRef(!0),Pi.useCallback({[e.name]:t=>e(t)}[e.name],[e,l,i.stabilityCheck])),u=ji(o.addNestedSub,a.getState,s||a.getState,d,r);return Pi.useDebugValue(u),u};return Object.assign(n,{withTypes:()=>n}),n}var Gi=Ui();Symbol.for("react.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.server_context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.suspense_list"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.for("react.offscreen"),Symbol.for("react.client.reference");function zi(e){e()}var Hi={notify(){},get:()=>[]};function qi(e,t){let n,r=Hi,i=0,a=!1;function o(){c.onStateChange&&c.onStateChange()}function s(){i++,n||(n=t?t.addNestedSub(o):e.subscribe(o),r=function(){let e=null,t=null;return{clear(){e=null,t=null},notify(){zi((()=>{let t=e;for(;t;)t.callback(),t=t.next}))},get(){const t=[];let n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(n){let r=!0;const i=t={callback:n,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){r&&null!==e&&(r=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}())}function l(){i--,n&&0===i&&(n(),n=void 0,r.clear(),r=Hi)}const c={addNestedSub:function(e){s();const t=r.subscribe(e);let n=!1;return()=>{n||(n=!0,t(),l())}},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:o,isSubscribed:function(){return a},trySubscribe:function(){a||(a=!0,s())},tryUnsubscribe:function(){a&&(a=!1,l())},getListeners:()=>r};return c}var Wi=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement)?Pi.useLayoutEffect:Pi.useEffect;function Bi(e,t){return e===t?0!==e||0!==t||1/e===1/t:e!==e&&t!==t}function Qi(e,t){if(Bi(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(!Object.prototype.hasOwnProperty.call(t,n[i])||!Bi(e[n[i]],t[n[i]]))return!1;return!0}Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;var Ki=function(e){let{store:t,context:n,children:r,serverState:i,stabilityCheck:a="once",identityFunctionCheck:o="once"}=e;const s=Pi.useMemo((()=>{const e=qi(t);return{store:t,subscription:e,getServerState:i?()=>i:void 0,stabilityCheck:a,identityFunctionCheck:o}}),[t,i,a,o]),l=Pi.useMemo((()=>t.getState()),[t]);Wi((()=>{const{subscription:e}=s;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),l!==t.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}}),[s,l]);const c=n||ki;return Pi.createElement(c.Provider,{value:s},r)};function Ji(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ki;const t=e===ki?Fi:xi(e),n=()=>{const{store:e}=t();return e};return Object.assign(n,{withTypes:()=>n}),n}var $i=Ji();function Yi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ki;const t=e===ki?$i:Ji(e),n=()=>t().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var Zi,Xi=Yi(),ea=zi;function ta(t,n,r,i){const a=(0,e.useMemo)((()=>({queryArgs:t,serialized:"object"==typeof t?n({queryArgs:t,endpointDefinition:r,endpointName:i}):t})),[t,n,r,i]),o=(0,e.useRef)(a);return(0,e.useEffect)((()=>{o.current.serialized!==a.serialized&&(o.current=a)}),[a]),o.current.serialized===a.serialized?o.current.queryArgs:t}Zi=Ii.useSyncExternalStoreWithSelector,ji=Zi,(e=>{e})(e.useSyncExternalStore);var na=Symbol();function ra(t){const n=(0,e.useRef)(t);return(0,e.useEffect)((()=>{Qi(n.current,t)||(n.current=t)}),[t]),Qi(n.current,t)?n.current:t}var ia=WeakMap?new WeakMap:void 0,aa=e=>{let{endpointName:t,queryArgs:n}=e,r="";const i=null===ia||void 0===ia?void 0:ia.get(n);if("string"===typeof i)r=i;else{const e=JSON.stringify(n,((e,t)=>wt(t)?Object.keys(t).sort().reduce(((e,n)=>(e[n]=t[n],e)),{}):t));wt(n)&&(null===ia||void 0===ia||ia.set(n,e)),r=e}return"".concat(t,"(").concat(r,")")},oa="undefined"!==typeof window&&window.document&&window.document.createElement?e.useLayoutEffect:e.useEffect,sa=e=>e.isUninitialized?{...e,isUninitialized:!1,isFetching:!0,isLoading:void 0===e.data,status:kr.pending}:e;function la(e){return e.replace(e[0],e[0].toUpperCase())}function ca(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Object.assign(e,...n)}var da=Symbol();var ua=mi(Ti(),function(){let{batch:t=ea,hooks:n={useDispatch:Xi,useSelector:Gi,useStore:$i},createSelector:r=jn,unstable__sideEffectsInRender:i=!1,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:da,init(a,o,s){let{serializeQueryArgs:l}=o;const c=a,{buildQueryHooks:d,buildMutationHook:u,usePrefetch:g}=function(t){let{api:n,moduleOptions:{batch:r,hooks:{useDispatch:i,useSelector:a,useStore:o},unstable__sideEffectsInRender:s,createSelector:l},serializeQueryArgs:c,context:d}=t;const u=s?e=>e():e.useEffect;return{buildQueryHooks:function(t){const s=function(r){let{refetchOnReconnect:a,refetchOnFocus:o,refetchOnMountOrArgChange:s,skip:l=!1,pollingInterval:c=0,skipPollingIfUnfocused:g=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{initiate:f}=n.endpoints[t],h=i(),p=(0,e.useRef)();if(!p.current){const e=h(n.internalActions.internal_getRTKQSubscriptions());p.current=e}const m=ta(l?di:r,aa,d.endpointDefinitions[t],t),v=ra({refetchOnReconnect:a,refetchOnFocus:o,pollingInterval:c,skipPollingIfUnfocused:g}),y=(0,e.useRef)(!1),C=(0,e.useRef)();let{queryCacheKey:_,requestId:S}=C.current||{},E=!1;_&&S&&(E=p.current.isRequestSubscribed(_,S));const b=!E&&y.current;return u((()=>{y.current=E})),u((()=>{b&&(C.current=void 0)}),[b]),u((()=>{var e;const t=C.current;if(m===di)return null===t||void 0===t||t.unsubscribe(),void(C.current=void 0);const n=null===(e=C.current)||void 0===e?void 0:e.subscriptionOptions;if(t&&t.arg===m)v!==n&&t.updateSubscriptionOptions(v);else{null===t||void 0===t||t.unsubscribe();const e=h(f(m,{subscriptionOptions:v,forceRefetch:s}));C.current=e}}),[h,f,s,m,v,b]),(0,e.useEffect)((()=>()=>{var e;null===(e=C.current)||void 0===e||e.unsubscribe(),C.current=void 0}),[]),(0,e.useMemo)((()=>({refetch:()=>{var e;if(!C.current)throw new Error(Nr(38));return null===(e=C.current)||void 0===e?void 0:e.refetch()}})),[])},f=function(){let{refetchOnReconnect:a,refetchOnFocus:o,pollingInterval:s=0,skipPollingIfUnfocused:l=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{initiate:c}=n.endpoints[t],d=i(),[g,f]=(0,e.useState)(na),h=(0,e.useRef)(),p=ra({refetchOnReconnect:a,refetchOnFocus:o,pollingInterval:s,skipPollingIfUnfocused:l});u((()=>{var e;const t=null===(e=h.current)||void 0===e?void 0:e.subscriptionOptions;var n;p!==t&&(null===(n=h.current)||void 0===n||n.updateSubscriptionOptions(p))}),[p]);const m=(0,e.useRef)(p);u((()=>{m.current=p}),[p]);const v=(0,e.useCallback)((function(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r((()=>{var r;null===(r=h.current)||void 0===r||r.unsubscribe(),h.current=t=d(c(e,{subscriptionOptions:m.current,forceRefetch:!n})),f(e)})),t}),[d,c]);return(0,e.useEffect)((()=>()=>{var e;null===h||void 0===h||null===(e=h.current)||void 0===e||e.unsubscribe()}),[]),(0,e.useEffect)((()=>{g===na||h.current||v(g,!0)}),[g,v]),(0,e.useMemo)((()=>[v,g]),[v,g])},h=function(r){let{skip:i=!1,selectFromResult:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{select:u}=n.endpoints[t],f=ta(i?di:r,c,d.endpointDefinitions[t],t),h=(0,e.useRef)(),p=(0,e.useMemo)((()=>l([u(f),(e,t)=>t,e=>f],g,{memoizeOptions:{resultEqualityCheck:Qi}})),[u,f]),m=(0,e.useMemo)((()=>s?l([p],s,{devModeChecks:{identityFunctionCheck:"never"}}):p),[p,s]),v=a((e=>m(e,h.current)),Qi),y=o(),C=p(y.getState(),h.current);return oa((()=>{h.current=C}),[C]),v};return{useQueryState:h,useQuerySubscription:s,useLazyQuerySubscription:f,useLazyQuery(t){const[n,r]=f(t),i=h(r,{...t,skip:r===na}),a=(0,e.useMemo)((()=>({lastArg:r})),[r]);return(0,e.useMemo)((()=>[n,i,a]),[n,i,a])},useQuery(t,n){const r=s(t,n),i=h(t,{selectFromResult:t===di||null!==n&&void 0!==n&&n.skip?void 0:sa,...n}),{data:a,status:o,isLoading:l,isSuccess:c,isError:d,error:u}=i;return(0,e.useDebugValue)({data:a,status:o,isLoading:l,isSuccess:c,isError:d,error:u}),(0,e.useMemo)((()=>({...i,...r})),[i,r])}}},buildMutationHook:function(t){return function(){let{selectFromResult:o,fixedCacheKey:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{select:c,initiate:d}=n.endpoints[t],u=i(),[g,f]=(0,e.useState)();(0,e.useEffect)((()=>()=>{null!==g&&void 0!==g&&g.arg.fixedCacheKey||null===g||void 0===g||g.reset()}),[g]);const h=(0,e.useCallback)((function(e){const t=u(d(e,{fixedCacheKey:s}));return f(t),t}),[u,d,s]),{requestId:p}=g||{},m=(0,e.useMemo)((()=>c({fixedCacheKey:s,requestId:null===g||void 0===g?void 0:g.requestId})),[s,g,c]),v=(0,e.useMemo)((()=>o?l([m],o):m),[o,m]),y=a(v,Qi),C=null==s?null===g||void 0===g?void 0:g.arg.originalArgs:void 0,_=(0,e.useCallback)((()=>{r((()=>{g&&f(void 0),s&&u(n.internalActions.removeMutationResult({requestId:p,fixedCacheKey:s}))}))}),[u,s,g,p]),{endpointName:S,data:E,status:b,isLoading:M,isSuccess:w,isError:R,error:L}=y;(0,e.useDebugValue)({endpointName:S,data:E,status:b,isLoading:M,isSuccess:w,isError:R,error:L});const T=(0,e.useMemo)((()=>({...y,originalArgs:C,reset:_})),[y,C,_]);return(0,e.useMemo)((()=>[h,T]),[h,T])}},usePrefetch:function(t,r){const a=i(),o=ra(r);return(0,e.useCallback)(((e,r)=>a(n.util.prefetch(t,e,{...o,...r}))),[t,a,o])}};function g(e,t,n){var r,i;if(null!==(r=t)&&void 0!==r&&r.endpointName&&e.isUninitialized){const{endpointName:e}=t,r=d.endpointDefinitions[e];c({queryArgs:t.originalArgs,endpointDefinition:r,endpointName:e})===c({queryArgs:n,endpointDefinition:r,endpointName:e})&&(t=void 0)}let a=e.isSuccess?e.data:null===(i=t)||void 0===i?void 0:i.data;void 0===a&&(a=e.data);const o=void 0!==a,s=e.isLoading,l=!o&&s,u=e.isSuccess||s&&o;return{...e,data:a,currentData:e.data,isFetching:s,isLoading:l,isSuccess:u}}}({api:a,moduleOptions:{batch:t,hooks:n,unstable__sideEffectsInRender:i,createSelector:r},serializeQueryArgs:l,context:s});return ca(c,{usePrefetch:g}),ca(s,{batch:t}),{injectEndpoint(e,t){if("query"===t.type){const{useQuery:t,useLazyQuery:n,useLazyQuerySubscription:r,useQueryState:i,useQuerySubscription:o}=d(e);ca(c.endpoints[e],{useQuery:t,useLazyQuery:n,useLazyQuerySubscription:r,useQueryState:i,useQuerySubscription:o}),a["use".concat(la(e),"Query")]=t,a["useLazy".concat(la(e),"Query")]=n}else if(function(e){return"mutation"===e.type}(t)){const t=u(e);ca(c.endpoints[e],{useMutation:t}),a["use".concat(la(e),"Mutation")]=t}}}}}}());const ga="https://jsonplaceholder.typicode.com/";const fa=new class{constructor(){this.posts="".concat(ga,"/posts"),this.post=e=>"".concat(ga,"/posts/").concat(e)}},ha=ua({reducerPath:"posts",baseQuery:function(){let{baseUrl:e,prepareHeaders:t=(e=>e),fetchFn:n=Gr,paramsSerializer:r,isJsonContentType:i=Hr,jsonContentType:a="application/json",jsonReplacer:o,timeout:s,responseHandler:l,validateStatus:c,...d}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"undefined"===typeof fetch&&n===Gr&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(g,f)=>{const{signal:h,getState:p,extra:m,endpoint:v,forced:y,type:C}=f;let _,{url:S,headers:E=new Headers(d.headers),params:b,responseHandler:M=(null!==l&&void 0!==l?l:"json"),validateStatus:w=(null!==c&&void 0!==c?c:zr),timeout:R=s,...L}="string"==typeof g?{url:g}:g,T={...d,signal:h,...L};E=new Headers(qr(E)),T.headers=await t(E,{getState:p,extra:m,endpoint:v,forced:y,type:C})||E;const I=e=>"object"===typeof e&&(wt(e)||Array.isArray(e)||"function"===typeof e.toJSON);if(!T.headers.has("content-type")&&I(T.body)&&T.headers.set("content-type",a),I(T.body)&&i(T.headers)&&(T.body=JSON.stringify(T.body,o)),b){const e=~S.indexOf("?")?"&":"?";S+=e+(r?r(b):new URLSearchParams(qr(b)))}S=Fr(e,S);const P=new Request(S,T);_={request:new Request(S,T)};let O,A=!1,N=R&&setTimeout((()=>{A=!0,f.abort()}),R);try{O=await n(P)}catch(F){return{error:{status:A?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(F)},meta:_}}finally{N&&clearTimeout(N)}const k=O.clone();let D;_.response=k;let x="";try{let e;if(await Promise.all([u(O,M).then((e=>D=e),(t=>e=t)),k.text().then((e=>x=e),(()=>{}))]),e)throw e}catch(F){return{error:{status:"PARSING_ERROR",originalStatus:O.status,data:x,error:String(F)},meta:_}}return w(O,D)?{data:D,meta:_}:{error:{status:O.status,data:D},meta:_}};async function u(e,t){if("function"===typeof t)return t(e);if("content-type"===t&&(t=i(e.headers)?"json":"text"),"json"===t){const t=await e.text();return t.length?JSON.parse(t):null}return e.text()}}({baseUrl:fa.posts}),endpoints:e=>({getPosts:e.query({query:()=>"",merge:(e,t)=>[...e,...t]}),getPostById:e.query({query:e=>fa.post(e)})})}),pa=e=>{let{post:t,action:n,postNumber:r,style:i}=e;return(0,a.jsxs)(ht,{gap:8,style:i,children:[(0,a.jsxs)(dt,{gap:10,children:[r?(0,a.jsx)(gt,{children:r}):void 0,(0,a.jsx)(gt,{elipsis:!0,children:t.title}),(0,a.jsx)(gt,{elipsis:!0,children:t.body})]}),n]})},ma=t=>{let{id:n}=t;const r=$e(),i=(0,e.useCallback)((()=>{r("".concat($a.post,"/").concat(n))}),[n,r]);return(0,a.jsx)(ft,{onClick:i,children:"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c"})},va=()=>{const t=$e(),n=(0,e.useCallback)((()=>{t(-1)}),[t]);return(0,a.jsx)(ft,{onClick:n,children:"\u041d\u0430\u0437\u0430\u0434"})},ya=()=>{const{useGetPostByIdQuery:t}=ha,{id:n}=function(){let{matches:t}=e.useContext(Be),n=t[t.length-1];return n?n.params:{}}(),r=n?parseInt(n):NaN,{data:i,isLoading:o}=t(r);return!isNaN(r)?o?(0,a.jsx)(yt,{centered:!0}):i?(0,a.jsx)(pa,{action:(0,a.jsx)(va,{}),post:i}):null:null};let Ca;Ca="undefined"!==typeof window?window:"undefined"!==typeof self?self:n.g;let _a=null,Sa=null;const Ea=Ca.clearTimeout,ba=Ca.setTimeout,Ma=Ca.cancelAnimationFrame||Ca.mozCancelAnimationFrame||Ca.webkitCancelAnimationFrame,wa=Ca.requestAnimationFrame||Ca.mozRequestAnimationFrame||Ca.webkitRequestAnimationFrame;function Ra(e){let t,n,r,i,a,o,s;const l="undefined"!==typeof document&&document.attachEvent;if(!l){o=function(e){const t=e.__resizeTriggers__,n=t.firstElementChild,r=t.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight},a=function(e){return e.offsetWidth!==e.__resizeLast__.width||e.offsetHeight!==e.__resizeLast__.height},s=function(e){if(e.target.className&&"function"===typeof e.target.className.indexOf&&e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)return;const t=this;o(this),this.__resizeRAF__&&_a(this.__resizeRAF__),this.__resizeRAF__=Sa((function(){a(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(n){n.call(t,e)})))}))};let e=!1,l="";r="animationstart";const c="Webkit Moz O ms".split(" ");let d="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),u="";{const t=document.createElement("fakeelement");if(void 0!==t.style.animationName&&(e=!0),!1===e)for(let n=0;n<c.length;n++)if(void 0!==t.style[c[n]+"AnimationName"]){u=c[n],l="-"+u.toLowerCase()+"-",r=d[n],e=!0;break}}n="resizeanim",t="@"+l+"keyframes "+n+" { from { opacity: 0; } to { opacity: 0; } } ",i=l+"animation: 1ms "+n+"; "}return{addResizeListener:function(a,c){if(l)a.attachEvent("onresize",c);else{if(!a.__resizeTriggers__){const l=a.ownerDocument,c=Ca.getComputedStyle(a);c&&"static"===c.position&&(a.style.position="relative"),function(n){if(!n.getElementById("detectElementResize")){const r=(t||"")+".resize-triggers { "+(i||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',a=n.head||n.getElementsByTagName("head")[0],o=n.createElement("style");o.id="detectElementResize",o.type="text/css",null!=e&&o.setAttribute("nonce",e),o.styleSheet?o.styleSheet.cssText=r:o.appendChild(n.createTextNode(r)),a.appendChild(o)}}(l),a.__resizeLast__={},a.__resizeListeners__=[],(a.__resizeTriggers__=l.createElement("div")).className="resize-triggers";const d=l.createElement("div");d.className="expand-trigger",d.appendChild(l.createElement("div"));const u=l.createElement("div");u.className="contract-trigger",a.__resizeTriggers__.appendChild(d),a.__resizeTriggers__.appendChild(u),a.appendChild(a.__resizeTriggers__),o(a),a.addEventListener("scroll",s,!0),r&&(a.__resizeTriggers__.__animationListener__=function(e){e.animationName===n&&o(a)},a.__resizeTriggers__.addEventListener(r,a.__resizeTriggers__.__animationListener__))}a.__resizeListeners__.push(c)}},removeResizeListener:function(e,t){if(l)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",s,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(r,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(n){}}}}}null==Ma||null==wa?(_a=Ea,Sa=function(e){return ba(e,20)}):(_a=function(e){let[t,n]=e;Ma(t),Ea(n)},Sa=function(e){const t=wa((function(){Ea(n),e()})),n=ba((function(){Ma(t),e()}),20);return[t,n]});class La extends e.Component{constructor(){super(...arguments),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:e,disableWidth:t,onResize:n}=this.props;if(this._parentNode){var r,i,a,o;const s=window.getComputedStyle(this._parentNode)||{},l=parseFloat(null!==(r=s.paddingLeft)&&void 0!==r?r:"0"),c=parseFloat(null!==(i=s.paddingRight)&&void 0!==i?i:"0"),d=parseFloat(null!==(a=s.paddingTop)&&void 0!==a?a:"0"),u=parseFloat(null!==(o=s.paddingBottom)&&void 0!==o?o:"0"),g=this._parentNode.getBoundingClientRect(),f=g.height-d-u,h=g.width-l-c,p=this._parentNode.offsetHeight-d-u,m=this._parentNode.offsetWidth-l-c;(e||this.state.height===p&&this.state.scaledHeight===f)&&(t||this.state.width===m&&this.state.scaledWidth===h)||(this.setState({height:p,width:m,scaledHeight:f,scaledWidth:h}),"function"===typeof n&&n({height:p,scaledHeight:f,scaledWidth:h,width:m}))}},this._setRef=e=>{this._autoSizer=e}}componentDidMount(){const{nonce:e}=this.props;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,null!=this._parentNode&&("undefined"!==typeof ResizeObserver?(this._resizeObserver=new ResizeObserver((()=>{this._timeoutId=setTimeout(this._onResize,0)})),this._resizeObserver.observe(this._parentNode)):(this._detectElementResize=Ra(e),this._detectElementResize.addResizeListener(this._parentNode,this._onResize)),this._onResize()))}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),null!==this._timeoutId&&clearTimeout(this._timeoutId),this._resizeObserver&&(this._resizeObserver.observe(this._parentNode),this._resizeObserver.disconnect()))}render(){const{children:t,defaultHeight:n,defaultWidth:r,disableHeight:i=!1,disableWidth:a=!1,nonce:o,onResize:s,style:l={},tagName:c="div",...d}=this.props,{height:u,scaledHeight:g,scaledWidth:f,width:h}=this.state,p={overflow:"visible"},m={};let v=!1;return i||(0===u&&(v=!0),p.height=0,m.height=u,m.scaledHeight=g),a||(0===h&&(v=!0),p.width=0,m.width=h,m.scaledWidth=f),(0,e.createElement)(c,{ref:this._setRef,style:{...p,...l},...d},!v&&t(m))}}function Ta(){return Ta=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ta.apply(this,arguments)}function Ia(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pa(e,t){return Pa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pa(e,t)}function Oa(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Pa(e,t)}var Aa=Number.isNaN||function(e){return"number"===typeof e&&e!==e};function Na(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(r=e[n],i=t[n],!(r===i||Aa(r)&&Aa(i)))return!1;var r,i;return!0}const ka=function(e,t){var n;void 0===t&&(t=Na);var r,i=[],a=!1;return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return a&&n===this&&t(o,i)||(r=e.apply(this,o),a=!0,n=this,i=o),r}};var Da="object"===typeof performance&&"function"===typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function xa(e){cancelAnimationFrame(e.id)}function Fa(e,t){var n=Da();var r={id:requestAnimationFrame((function i(){Da()-n>=t?e.call(null):r.id=requestAnimationFrame(i)}))};return r}var ja=-1;function Va(e){if(void 0===e&&(e=!1),-1===ja||e){var t=document.createElement("div"),n=t.style;n.width="50px",n.height="50px",n.overflow="scroll",document.body.appendChild(t),ja=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return ja}var Ua=null;function Ga(e){if(void 0===e&&(e=!1),null===Ua||e){var t=document.createElement("div"),n=t.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";var r=document.createElement("div"),i=r.style;return i.width="100px",i.height="100px",t.appendChild(r),document.body.appendChild(t),t.scrollLeft>0?Ua="positive-descending":(t.scrollLeft=1,Ua=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),Ua}return Ua}var za=function(e,t){return e};function Ha(t){var n,r=t.getItemOffset,i=t.getEstimatedTotalSize,a=t.getItemSize,o=t.getOffsetForIndexAndAlignment,s=t.getStartIndexForOffset,l=t.getStopIndexForStartIndex,c=t.initInstanceProps,d=t.shouldResetStyleCacheOnItemSizeChange,u=t.validateProps;return n=function(t){function n(e){var n;return(n=t.call(this,e)||this)._instanceProps=c(n.props,Ia(n)),n._outerRef=void 0,n._resetIsScrollingTimeoutId=null,n.state={instance:Ia(n),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"===typeof n.props.initialScrollOffset?n.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},n._callOnItemsRendered=void 0,n._callOnItemsRendered=ka((function(e,t,r,i){return n.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:r,visibleStopIndex:i})})),n._callOnScroll=void 0,n._callOnScroll=ka((function(e,t,r){return n.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:r})})),n._getItemStyle=void 0,n._getItemStyle=function(e){var t,i=n.props,o=i.direction,s=i.itemSize,l=i.layout,c=n._getItemStyleCache(d&&s,d&&l,d&&o);if(c.hasOwnProperty(e))t=c[e];else{var u=r(n.props,e,n._instanceProps),g=a(n.props,e,n._instanceProps),f="horizontal"===o||"horizontal"===l,h="rtl"===o,p=f?u:0;c[e]=t={position:"absolute",left:h?void 0:p,right:h?p:void 0,top:f?0:u,height:f?"100%":g,width:f?g:"100%"}}return t},n._getItemStyleCache=void 0,n._getItemStyleCache=ka((function(e,t,n){return{}})),n._onScrollHorizontal=function(e){var t=e.currentTarget,r=t.clientWidth,i=t.scrollLeft,a=t.scrollWidth;n.setState((function(e){if(e.scrollOffset===i)return null;var t=n.props.direction,o=i;if("rtl"===t)switch(Ga()){case"negative":o=-i;break;case"positive-descending":o=a-r-i}return o=Math.max(0,Math.min(o,a-r)),{isScrolling:!0,scrollDirection:e.scrollOffset<o?"forward":"backward",scrollOffset:o,scrollUpdateWasRequested:!1}}),n._resetIsScrollingDebounced)},n._onScrollVertical=function(e){var t=e.currentTarget,r=t.clientHeight,i=t.scrollHeight,a=t.scrollTop;n.setState((function(e){if(e.scrollOffset===a)return null;var t=Math.max(0,Math.min(a,i-r));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}}),n._resetIsScrollingDebounced)},n._outerRefSetter=function(e){var t=n.props.outerRef;n._outerRef=e,"function"===typeof t?t(e):null!=t&&"object"===typeof t&&t.hasOwnProperty("current")&&(t.current=e)},n._resetIsScrollingDebounced=function(){null!==n._resetIsScrollingTimeoutId&&xa(n._resetIsScrollingTimeoutId),n._resetIsScrollingTimeoutId=Fa(n._resetIsScrolling,150)},n._resetIsScrolling=function(){n._resetIsScrollingTimeoutId=null,n.setState({isScrolling:!1},(function(){n._getItemStyleCache(-1,null)}))},n}Oa(n,t),n.getDerivedStateFromProps=function(e,t){return qa(e,t),u(e),null};var g=n.prototype;return g.scrollTo=function(e){e=Math.max(0,e),this.setState((function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}}),this._resetIsScrollingDebounced)},g.scrollToItem=function(e,t){void 0===t&&(t="auto");var n=this.props,r=n.itemCount,i=n.layout,a=this.state.scrollOffset;e=Math.max(0,Math.min(e,r-1));var s=0;if(this._outerRef){var l=this._outerRef;s="vertical"===i?l.scrollWidth>l.clientWidth?Va():0:l.scrollHeight>l.clientHeight?Va():0}this.scrollTo(o(this.props,e,t,a,this._instanceProps,s))},g.componentDidMount=function(){var e=this.props,t=e.direction,n=e.initialScrollOffset,r=e.layout;if("number"===typeof n&&null!=this._outerRef){var i=this._outerRef;"horizontal"===t||"horizontal"===r?i.scrollLeft=n:i.scrollTop=n}this._callPropsCallbacks()},g.componentDidUpdate=function(){var e=this.props,t=e.direction,n=e.layout,r=this.state,i=r.scrollOffset;if(r.scrollUpdateWasRequested&&null!=this._outerRef){var a=this._outerRef;if("horizontal"===t||"horizontal"===n)if("rtl"===t)switch(Ga()){case"negative":a.scrollLeft=-i;break;case"positive-ascending":a.scrollLeft=i;break;default:var o=a.clientWidth,s=a.scrollWidth;a.scrollLeft=s-o-i}else a.scrollLeft=i;else a.scrollTop=i}this._callPropsCallbacks()},g.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&xa(this._resetIsScrollingTimeoutId)},g.render=function(){var t=this.props,n=t.children,r=t.className,a=t.direction,o=t.height,s=t.innerRef,l=t.innerElementType,c=t.innerTagName,d=t.itemCount,u=t.itemData,g=t.itemKey,f=void 0===g?za:g,h=t.layout,p=t.outerElementType,m=t.outerTagName,v=t.style,y=t.useIsScrolling,C=t.width,_=this.state.isScrolling,S="horizontal"===a||"horizontal"===h,E=S?this._onScrollHorizontal:this._onScrollVertical,b=this._getRangeToRender(),M=b[0],w=b[1],R=[];if(d>0)for(var L=M;L<=w;L++)R.push((0,e.createElement)(n,{data:u,key:f(L,u),index:L,isScrolling:y?_:void 0,style:this._getItemStyle(L)}));var T=i(this.props,this._instanceProps);return(0,e.createElement)(p||m||"div",{className:r,onScroll:E,ref:this._outerRefSetter,style:Ta({position:"relative",height:o,width:C,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:a},v)},(0,e.createElement)(l||c||"div",{children:R,ref:s,style:{height:S?"100%":T,pointerEvents:_?"none":void 0,width:S?T:"100%"}}))},g._callPropsCallbacks=function(){if("function"===typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],n=e[1],r=e[2],i=e[3];this._callOnItemsRendered(t,n,r,i)}if("function"===typeof this.props.onScroll){var a=this.state,o=a.scrollDirection,s=a.scrollOffset,l=a.scrollUpdateWasRequested;this._callOnScroll(o,s,l)}},g._getRangeToRender=function(){var e=this.props,t=e.itemCount,n=e.overscanCount,r=this.state,i=r.isScrolling,a=r.scrollDirection,o=r.scrollOffset;if(0===t)return[0,0,0,0];var c=s(this.props,o,this._instanceProps),d=l(this.props,c,o,this._instanceProps),u=i&&"backward"!==a?1:Math.max(1,n),g=i&&"forward"!==a?1:Math.max(1,n);return[Math.max(0,c-u),Math.max(0,Math.min(t-1,d+g)),c,d]},n}(e.PureComponent),n.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},n}var qa=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},Wa=Ha({getItemOffset:function(e,t){return t*e.itemSize},getItemSize:function(e,t){return e.itemSize},getEstimatedTotalSize:function(e){var t=e.itemCount;return e.itemSize*t},getOffsetForIndexAndAlignment:function(e,t,n,r,i,a){var o=e.direction,s=e.height,l=e.itemCount,c=e.itemSize,d=e.layout,u=e.width,g="horizontal"===o||"horizontal"===d?u:s,f=Math.max(0,l*c-g),h=Math.min(f,t*c),p=Math.max(0,t*c-g+c+a);switch("smart"===n&&(n=r>=p-g&&r<=h+g?"auto":"center"),n){case"start":return h;case"end":return p;case"center":var m=Math.round(p+(h-p)/2);return m<Math.ceil(g/2)?0:m>f+Math.floor(g/2)?f:m;default:return r>=p&&r<=h?r:r<p?p:h}},getStartIndexForOffset:function(e,t){var n=e.itemCount,r=e.itemSize;return Math.max(0,Math.min(n-1,Math.floor(t/r)))},getStopIndexForStartIndex:function(e,t,n){var r=e.direction,i=e.height,a=e.itemCount,o=e.itemSize,s=e.layout,l=e.width,c=t*o,d="horizontal"===r||"horizontal"===s?l:i,u=Math.ceil((d+n-c)/o);return Math.max(0,Math.min(a-1,t+u-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});const Ba=()=>{const{useLazyGetPostsQuery:t}=ha,[n,r]=t({}),{data:i,isLoading:o}=r,s=(0,e.useCallback)((()=>n({})),[n]);if((0,e.useEffect)((()=>{s()}),[]),(null===i||void 0===i||!i.length)&&o)return(0,a.jsx)(yt,{centered:!0});return i?(0,a.jsx)(La,{style:{height:"100%",minHeight:0},children:e=>{let{height:t,width:n}=e;return(0,a.jsx)(Wa,{height:t,width:n,itemCount:i.length,itemSize:70,children:e=>{let{index:t,style:n}=e;return((e,t)=>{var n;const r=i?i[e]:void 0;return r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(pa,{style:{...t,height:50,width:"calc(100% - 10px)"},action:(0,a.jsx)(ma,{id:r.id}),post:r,postNumber:e+1},r.id),e===(null!==(n=null===i||void 0===i?void 0:i.length)&&void 0!==n?n:0)-1&&(0,a.jsx)("div",{style:{...t,top:(null===t||void 0===t?void 0:t.top)+50},children:(0,a.jsx)(_t,{onFetchMore:s})})]}):null})(t,n)}})}}):null},Qa=()=>(0,a.jsx)(mt,{children:(0,a.jsx)(Ba,{})}),Ka=()=>(0,a.jsxs)(mt,{children:[(0,a.jsx)(vt,{children:"\u041f\u043e\u0441\u0442:"}),(0,a.jsx)(ya,{})]}),Ja=()=>(0,a.jsxs)(mt,{children:[(0,a.jsx)(vt,{children:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}),(0,a.jsx)(vt,{level:2,children:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0432\u0432\u043e\u0434\u0438\u043c\u043e\u0433\u043e \u0430\u0434\u0440\u0435\u0441\u0430"})]});let $a=function(e){return e.post="/post",e}({});!function(e,t){return le({basename:null==t?void 0:t.basename,future:nt({},null==t?void 0:t.future,{v7_prependBasename:!0}),history:(n={window:null==t?void 0:t.window},void 0===n&&(n={}),S((function(e,t){let{pathname:n,search:r,hash:i}=e.location;return y("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:C(t)}),null,n)),hydrationData:(null==t?void 0:t.hydrationData)||rt(),routes:e,mapRouteProperties:tt,window:null==t?void 0:t.window}).initialize();var n}([{path:"/",element:(0,a.jsx)(Qa,{}),errorElement:(0,a.jsx)(Ja,{})},{path:"".concat($a.post,"/:id"),element:(0,a.jsx)(Ka,{})}]);const Ya=function(e){const t=function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:i=!0}=null!==e&&void 0!==e?e:{};let a=new Bn;return t&&("boolean"===typeof t?a.push(Gn):a.push(zn(t.extraArgument))),a},{reducer:n,middleware:r,devTools:i=!0,preloadedState:a,enhancers:o}=e||{};let s,l;if("function"===typeof n)s=n;else{if(!wt(n))throw new Error(Nr(1));s=Lt(n)}l="function"===typeof r?r(t):t();let c=Tt;i&&(c=Hn({trace:!1,..."object"===typeof i&&i}));const d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>(n,r)=>{const i=e(n,r);let a=()=>{throw new Error(St(15))};const o={getState:i.getState,dispatch:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a(e,...n)}},s=t.map((e=>e(o)));return a=Tt(...s)(i.dispatch),{...i,dispatch:a}}}(...l),u=Xn(d);let g="function"===typeof o?o(u):u();return Rt(s,a,c(...g))}({reducer:{[ha.reducerPath]:ha.reducer},middleware:e=>e().concat(ha.middleware)});r.createRoot(document.getElementById("root")).render((0,a.jsx)(e.StrictMode,{children:(0,a.jsx)(Ki,{store:Ya,children:(0,a.jsx)(c,{})})}))})()})();
//# sourceMappingURL=main.a2a8ecf5.js.map